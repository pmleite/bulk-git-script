#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f bulk-git.sh 
#endif

static  char data [] = 
#define      inlo_z	3
#define      inlo	((&data[0]))
	"\252\310\221"
#define      shll_z	10
#define      shll	((&data[4]))
	"\154\002\137\333\324\066\213\104\277\226\232"
#define      tst1_z	22
#define      tst1	((&data[15]))
	"\205\045\224\303\326\040\216\373\043\344\147\100\140\144\313\004"
	"\106\362\217\226\111\012\303\055\046\216\061"
#define      chk1_z	22
#define      chk1	((&data[45]))
	"\016\122\251\273\316\032\224\264\162\020\214\044\312\145\237\053"
	"\051\117\171\162\143\007\306\065\272\241\037\037\314\131\067"
#define      xecc_z	15
#define      xecc	((&data[73]))
	"\317\301\355\237\362\211\273\257\377\117\334\334\250\127\017\162"
	"\253\053"
#define      msg2_z	19
#define      msg2	((&data[94]))
	"\224\122\024\312\077\133\103\032\157\153\344\360\126\110\141\260"
	"\022\271\051\166\175\306\207\004\231"
#define      chk2_z	19
#define      chk2	((&data[115]))
	"\373\162\203\130\043\011\256\342\046\005\060\103\051\111\031\224"
	"\067\241\240"
#define      date_z	1
#define      date	((&data[134]))
	"\112"
#define      pswd_z	256
#define      pswd	((&data[187]))
	"\253\211\142\313\125\274\003\257\025\271\177\300\345\021\246\166"
	"\246\370\212\161\375\044\151\050\114\222\347\076\224\264\201\100"
	"\076\344\013\223\240\016\103\265\310\303\166\256\324\035\044\173"
	"\025\257\354\023\037\107\007\366\310\237\014\374\300\030\165\372"
	"\337\200\003\350\253\040\073\033\361\274\062\305\303\067\010\072"
	"\264\276\353\324\006\362\312\316\222\327\313\123\357\100\115\317"
	"\300\121\270\154\162\363\207\144\257\271\051\163\361\061\255\246"
	"\360\231\172\366\213\105\304\036\034\220\161\013\320\277\333\221"
	"\020\223\375\203\207\205\347\067\077\020\252\060\102\130\326\062"
	"\361\121\050\175\226\355\233\262\176\014\276\117\314\232\340\334"
	"\055\336\137\265\144\107\354\243\127\227\323\231\357\252\314\341"
	"\373\365\136\222\342\371\104\141\006\003\260\322\235\221\257\313"
	"\157\017\200\324\126\155\167\256\005\112\107\365\365\023\326\360"
	"\011\064\202\353\056\307\115\065\313\375\007\151\216\266\064\376"
	"\306\265\322\034\043\111\312\051\224\022\036\211\046\364\172\057"
	"\051\374\033\130\304\150\215\220\145\224\371\364\113\056\362\022"
	"\343\304\056\007\015\371\060\241\014\116\052\063\103\244\142\155"
	"\241\176\305\146\346\122\366\114\347\357\100\063\036\062\105\001"
	"\367\164\011\004\155\072\246\172\211\321\255\314\166\020\072\030"
	"\216\377\176\165\323\125\073\040\350\042\136\174\327\340\275\025"
	"\304\310\250\145\327"
#define      tst2_z	19
#define      tst2	((&data[460]))
	"\006\264\012\140\106\310\100\321\242\077\377\363\320\011\254\057"
	"\243\330\265\257\222\116"
#define      rlax_z	1
#define      rlax	((&data[482]))
	"\267"
#define      msg1_z	65
#define      msg1	((&data[496]))
	"\353\330\365\101\023\026\051\066\164\246\015\124\143\265\055\115"
	"\133\247\031\235\061\305\145\174\060\160\326\125\157\221\005\357"
	"\013\341\373\355\050\357\235\124\201\057\260\074\357\147\061\120"
	"\215\340\066\007\223\034\045\147\123\134\045\105\072\224\110\207"
	"\216\302\306\141\274\316\072\270\242\014\343\133\305\064\042\030"
#define      lsto_z	1
#define      lsto	((&data[563]))
	"\252"
#define      opts_z	1
#define      opts	((&data[564]))
	"\102"
#define      text_z	4931
#define      text	((&data[1059]))
	"\363\352\332\146\351\237\210\325\170\176\026\213\224\100\302\011"
	"\346\317\135\112\362\166\167\275\365\173\165\216\037\333\271\023"
	"\306\224\171\257\063\002\205\253\200\233\067\025\333\371\037\302"
	"\311\175\014\273\364\203\171\351\377\356\167\037\311\061\062\217"
	"\305\253\077\370\255\304\244\056\140\334\104\074\326\143\376\237"
	"\340\013\133\324\217\324\275\216\302\065\255\213\146\340\033\053"
	"\213\133\044\071\040\311\147\200\245\253\274\174\017\273\033\357"
	"\307\166\304\126\112\202\345\014\267\223\230\036\163\264\111\377"
	"\017\156\070\057\067\237\257\335\113\154\131\132\050\165\112\357"
	"\354\016\106\067\221\053\103\110\277\334\147\063\220\261\062\240"
	"\037\152\317\127\012\177\065\125\354\216\260\024\004\372\004\360"
	"\011\112\047\232\165\153\343\065\110\112\150\331\374\232\171\033"
	"\005\111\162\017\311\250\145\266\067\025\313\073\020\317\054\032"
	"\031\124\265\216\300\231\304\010\344\054\342\340\307\133\373\314"
	"\245\156\333\157\026\101\045\115\127\360\211\150\277\265\202\330"
	"\012\067\147\312\321\053\322\265\130\264\225\037\020\221\353\266"
	"\000\307\045\027\010\112\145\140\072\356\310\372\244\112\322\256"
	"\202\072\170\123\146\113\011\276\000\237\336\020\060\311\306\060"
	"\221\354\110\232\066\255\372\161\233\302\154\100\014\077\356\217"
	"\171\146\343\337\262\354\236\262\213\174\303\274\106\212\355\327"
	"\166\065\161\255\342\153\036\176\055\212\276\072\312\254\312\103"
	"\023\255\043\306\232\301\170\046\076\074\342\204\306\320\134\074"
	"\005\315\352\350\071\010\146\146\223\045\241\135\322\153\241\346"
	"\031\304\254\263\206\045\331\305\141\274\112\047\214\246\144\222"
	"\163\116\172\254\127\341\023\353\006\264\111\330\040\353\276\071"
	"\257\153\355\066\220\307\374\361\203\106\031\020\354\176\242\140"
	"\315\034\014\044\375\040\020\004\325\132\334\365\105\233\057\365"
	"\006\034\053\226\343\050\210\147\156\242\167\133\040\032\273\355"
	"\066\310\022\064\350\043\070\275\175\025\263\302\260\342\267\266"
	"\377\343\115\342\013\326\112\172\170\302\325\230\334\220\206\023"
	"\130\230\110\101\274\200\376\071\226\261\373\106\224\262\310\154"
	"\151\134\046\210\161\027\346\074\157\154\177\111\137\177\210\372"
	"\150\030\130\116\121\305\031\324\226\267\137\270\201\365\200\051"
	"\353\004\252\127\217\164\065\112\165\331\006\276\116\300\306\343"
	"\253\103\070\202\207\350\367\363\034\176\074\235\010\037\304\332"
	"\023\236\237\035\020\303\041\213\050\206\067\154\205\107\055\163"
	"\254\177\112\114\341\032\156\100\107\145\300\132\057\003\060\215"
	"\124\264\024\032\313\255\042\302\216\124\062\337\201\131\273\152"
	"\102\163\224\014\147\161\261\023\112\044\244\047\106\201\056\264"
	"\337\345\130\024\136\243\131\106\221\241\023\332\074\217\204\131"
	"\325\275\336\142\074\020\245\331\317\220\151\350\017\104\224\337"
	"\351\205\155\004\377\345\213\202\312\066\166\301\332\300\274\172"
	"\175\150\127\025\210\140\103\035\002\366\071\004\311\177\122\214"
	"\057\156\264\172\312\123\053\055\361\162\001\340\236\240\212\351"
	"\322\251\356\052\027\040\215\150\325\324\101\106\311\073\064\173"
	"\051\233\071\076\071\305\266\261\355\245\315\311\322\363\360\375"
	"\306\004\260\364\266\356\261\020\011\053\033\154\223\365\201\112"
	"\231\237\172\167\207\117\031\016\044\357\233\027\313\055\021\022"
	"\135\310\342\016\073\230\332\146\166\053\276\357\275\124\117\246"
	"\330\356\254\017\114\022\131\275\214\074\271\224\162\213\362\177"
	"\133\354\136\113\301\360\217\174\044\010\073\105\130\100\257\045"
	"\221\067\002\305\357\230\036\126\226\002\256\045\135\115\065\152"
	"\032\307\262\111\333\030\324\336\114\133\300\264\312\025\067\333"
	"\261\330\131\112\357\254\220\332\237\067\173\162\110\001\357\375"
	"\377\006\250\267\034\265\303\142\073\366\232\245\252\376\155\200"
	"\045\212\071\250\346\137\267\346\363\364\130\135\330\175\110\336"
	"\032\125\125\270\256\022\014\367\037\122\076\327\217\020\216\014"
	"\205\333\340\123\003\155\072\142\207\036\011\174\116\250\255\134"
	"\151\262\170\161\244\347\170\205\305\130\060\253\075\211\156\253"
	"\051\222\212\237\220\043\114\132\155\013\127\134\305\325\371\377"
	"\014\330\026\041\350\367\115\240\241\023\351\155\350\067\047\324"
	"\016\116\005\226\144\050\064\146\252\364\171\366\023\141\145\251"
	"\243\377\342\061\243\012\344\331\064\271\016\075\245\172\123\206"
	"\174\161\214\102\151\044\026\275\345\211\147\127\350\201\257\356"
	"\037\263\203\333\322\020\171\317\350\316\025\043\000\107\374\275"
	"\064\244\245\020\000\227\060\177\067\012\127\321\050\147\217\047"
	"\057\344\262\166\220\035\315\301\357\237\053\366\014\005\353\060"
	"\134\124\272\041\173\153\204\041\353\244\010\073\003\036\357\123"
	"\143\033\160\211\247\271\004\073\326\347\265\265\206\014\164\114"
	"\130\256\335\263\345\205\042\110\332\323\120\101\064\225\054\127"
	"\201\320\226\326\225\153\141\011\053\075\246\121\032\246\062\127"
	"\051\150\324\165\006\122\055\173\006\237\347\114\267\255\261\116"
	"\316\175\120\127\221\057\373\230\201\341\066\342\007\131\313\333"
	"\042\355\153\076\265\170\000\062\147\067\114\126\056\205\271\012"
	"\111\265\233\331\204\010\324\064\167\225\231\314\114\301\056\243"
	"\026\123\335\325\240\246\054\337\220\367\201\037\212\164\262\264"
	"\073\115\315\114\370\343\113\162\330\215\345\257\127\311\277\104"
	"\030\054\250\020\345\163\264\127\322\213\122\125\256\050\266\305"
	"\366\347\011\164\124\223\265\256\310\162\033\002\133\175\066\366"
	"\333\160\074\130\343\354\341\241\152\302\061\214\356\026\055\265"
	"\353\123\072\176\215\144\261\332\301\212\374\162\115\323\101\216"
	"\274\031\266\046\043\350\260\064\233\054\234\274\163\274\110\160"
	"\203\341\132\232\314\214\056\133\306\146\170\345\006\237\246\126"
	"\336\132\360\322\235\215\067\230\301\256\334\223\340\303\021\336"
	"\070\247\144\355\153\002\037\000\226\021\126\017\006\057\036\056"
	"\126\304\171\362\056\101\025\032\241\061\002\134\326\045\010\272"
	"\236\340\220\241\214\077\211\370\042\303\301\261\254\261\076\334"
	"\075\150\316\362\356\257\056\124\175\332\114\150\106\176\202\026"
	"\165\132\034\312\326\032\143\317\145\366\126\141\023\270\034\353"
	"\043\207\121\326\077\067\134\076\211\304\134\013\117\347\246\237"
	"\213\173\023\242\024\025\213\253\263\354\307\103\001\353\142\151"
	"\061\221\117\375\331\110\265\203\013\074\370\172\324\355\310\357"
	"\351\112\305\104\266\207\324\042\141\254\347\322\316\164\314\372"
	"\232\315\073\316\100\350\071\213\140\343\003\066\241\071\151\145"
	"\373\003\276\150\052\124\152\301\070\316\011\234\134\152\040\272"
	"\175\255\127\245\122\313\035\213\256\343\225\334\065\242\065\375"
	"\155\256\111\117\024\045\124\113\015\026\132\164\057\276\316\205"
	"\362\373\171\271\104\151\004\112\244\157\137\306\106\114\367\205"
	"\003\130\353\121\343\136\330\231\053\167\132\113\073\106\067\142"
	"\255\232\201\027\070\063\367\132\046\272\305\231\143\036\003\263"
	"\332\310\162\011\240\347\234\367\230\026\276\246\261\147\131\346"
	"\177\217\345\033\133\076\317\005\045\327\130\261\202\362\351\150"
	"\167\167\322\050\333\371\212\263\175\263\023\352\154\145\232\035"
	"\314\165\105\155\116\026\255\237\342\100\211\255\037\327\007\264"
	"\110\042\034\233\333\165\322\032\005\143\254\074\224\316\342\066"
	"\052\016\240\121\144\225\374\362\210\123\273\260\207\143\332\075"
	"\046\126\257\315\261\353\312\055\072\372\237\361\047\370\007\154"
	"\246\347\300\233\246\357\070\146\342\243\013\337\177\335\232\272"
	"\125\022\376\333\300\204\117\252\211\370\233\110\024\114\254\140"
	"\030\211\366\010\153\050\333\020\200\123\345\336\345\024\373\267"
	"\236\206\330\314\012\234\024\216\202\045\171\224\303\065\333\207"
	"\121\037\166\237\372\364\365\127\252\264\161\040\136\261\147\360"
	"\346\056\341\126\127\176\330\371\153\341\077\140\300\057\327\362"
	"\322\372\235\265\006\023\226\112\040\047\324\312\216\217\235\105"
	"\377\344\207\164\135\103\045\211\312\170\142\333\234\161\214\213"
	"\175\136\242\203\131\215\251\040\163\202\067\225\167\062\326\276"
	"\254\301\257\110\364\272\263\130\307\231\147\105\112\261\263\071"
	"\126\240\136\225\310\371\353\304\140\057\263\230\045\201\054\073"
	"\024\175\330\376\035\011\123\176\130\072\174\152\332\345\052\010"
	"\353\346\164\115\102\120\112\337\113\277\172\265\344\356\301\262"
	"\156\300\142\144\133\000\115\332\102\152\034\363\351\047\336\010"
	"\053\227\111\126\203\376\371\273\201\321\254\332\335\216\155\257"
	"\164\124\150\371\155\126\307\215\221\336\001\324\066\222\223\171"
	"\361\373\144\145\100\046\300\261\342\256\363\002\115\162\057\135"
	"\201\335\352\215\244\050\057\243\235\072\371\250\165\262\365\227"
	"\253\041\346\046\205\071\150\106\007\210\156\262\301\027\007\100"
	"\177\065\342\216\321\241\142\250\353\144\134\027\274\122\076\071"
	"\372\022\210\050\257\161\153\044\366\257\267\005\214\073\124\074"
	"\166\360\177\261\360\000\177\177\146\362\132\065\017\053\136\350"
	"\327\325\342\335\126\306\342\333\005\246\230\013\131\045\211\046"
	"\021\330\212\216\252\074\043\165\225\361\155\203\047\100\070\215"
	"\347\304\354\247\351\017\066\073\364\302\032\142\064\325\225\222"
	"\340\140\124\327\146\003\253\257\200\302\000\115\052\077\103\133"
	"\214\216\211\314\001\354\255\177\065\113\331\134\350\053\004\246"
	"\261\063\167\127\216\144\215\335\155\354\261\203\301\355\317\332"
	"\240\342\153\265\076\166\033\276\116\005\174\252\342\215\122\065"
	"\132\147\223\107\275\231\336\213\257\137\130\062\270\141\313\116"
	"\144\327\120\055\207\357\174\255\137\164\371\306\263\134\254\100"
	"\256\267\012\142\077\101\270\120\315\140\330\326\353\125\316\225"
	"\136\236\205\010\046\300\362\103\222\104\257\322\153\247\137\222"
	"\055\075\022\077\371\005\325\014\356\172\150\377\027\123\230\075"
	"\313\154\206\123\223\116\142\326\243\234\331\270\226\244\240\316"
	"\341\353\062\115\332\156\100\045\044\103\101\153\232\144\230\225"
	"\073\112\000\263\156\156\206\002\114\127\257\067\325\014\372\353"
	"\351\250\123\321\072\164\006\342\075\225\332\075\000\076\241\111"
	"\215\113\073\340\237\323\200\325\140\171\116\251\317\341\110\175"
	"\242\154\322\161\146\172\247\053\221\263\206\355\151\137\367\146"
	"\217\053\171\110\143\121\065\206\123\220\377\311\032\322\275\263"
	"\075\072\330\077\131\050\257\374\117\221\225\063\110\354\037\362"
	"\002\037\343\376\233\135\150\345\373\246\060\067\104\351\332\200"
	"\323\242\211\061\262\175\106\002\323\324\271\001\256\055\142\005"
	"\131\230\133\342\324\037\332\144\072\275\163\057\066\112\067\005"
	"\166\370\342\127\376\242\211\076\022\176\210\360\124\067\314\121"
	"\277\117\300\202\032\320\231\123\137\102\141\156\234\073\163\167"
	"\133\064\153\170\374\301\052\106\276\257\147\027\124\154\255\327"
	"\276\302\237\352\021\126\155\204\113\262\154\340\376\226\356\371"
	"\155\203\056\316\220\001\325\260\337\267\044\326\223\313\334\024"
	"\305\365\007\211\023\335\105\331\036\261\035\276\251\355\044\325"
	"\103\350\023\235\012\276\323\367\154\264\375\206\376\346\021\015"
	"\042\213\217\220\001\060\016\065\136\056\362\024\006\305\251\144"
	"\356\101\130\214\071\104\343\331\111\156\140\354\224\035\326\216"
	"\067\070\127\222\134\160\276\354\106\065\003\254\102\230\343\201"
	"\200\024\060\123\247\372\021\273\007\134\167\112\207\104\320\071"
	"\146\141\104\027\230\252\322\231\375\250\030\121\172\002\235\055"
	"\337\300\221\047\065\127\032\100\153\036\376\025\250\215\171\354"
	"\332\167\272\364\230\071\142\373\103\236\151\141\067\315\042\346"
	"\370\100\354\134\345\170\154\323\016\012\361\124\351\050\265\262"
	"\345\371\365\334\320\117\343\063\151\221\347\366\047\102\263\337"
	"\374\315\203\355\340\321\365\020\004\131\035\033\360\072\020\350"
	"\335\074\126\167\051\045\140\302\332\332\232\327\223\274\242\236"
	"\314\035\302\075\275\120\042\132\144\173\204\271\332\011\335\316"
	"\137\224\063\225\267\234\255\272\063\253\216\163\063\127\374\053"
	"\160\337\102\244\061\014\133\152\220\242\356\274\342\335\372\214"
	"\325\114\105\273\047\101\003\003\300\170\234\262\154\033\260\014"
	"\041\220\060\250\012\213\242\202\262\056\051\253\102\336\135\134"
	"\037\267\156\344\355\245\000\056\117\356\122\246\004\352\252\131"
	"\124\020\103\055\156\121\135\345\311\257\214\053\267\142\033\200"
	"\224\272\234\173\275\242\100\154\112\314\062\262\013\251\146\014"
	"\004\053\306\102\106\152\062\304\120\032\110\177\333\056\056\117"
	"\205\325\133\037\314\073\241\125\164\203\063\343\151\345\122\230"
	"\132\024\117\146\367\221\136\051\126\316\134\020\245\354\333\100"
	"\264\325\327\050\321\251\234\261\034\232\076\235\031\272\116\242"
	"\323\201\154\056\112\013\024\136\136\356\067\163\305\131\056\263"
	"\033\352\351\126\254\322\201\021\074\351\251\350\341\047\064\006"
	"\255\312\032\253\127\043\336\071\121\031\367\311\122\046\043\142"
	"\257\271\042\330\257\321\303\311\055\353\116\375\077\217\074\360"
	"\255\240\245\236\073\076\354\112\146\305\343\054\312\144\171\330"
	"\304\252\226\253\303\110\243\105\273\007\060\312\106\124\341\200"
	"\250\204\076\170\040\174\151\113\331\253\141\111\146\116\067\135"
	"\313\131\157\173\222\366\056\215\206\341\041\036\201\355\126\354"
	"\372\332\334\300\242\201\242\023\100\162\034\061\225\211\126\001"
	"\154\322\100\020\121\151\357\072\217\112\001\326\303\237\023\050"
	"\360\071\310\170\054\053\206\200\240\216\350\246\154\102\243\302"
	"\261\263\330\225\226\105\250\200\203\326\015\077\234\170\061\132"
	"\144\061\306\174\131\366\072\362\371\057\145\300\145\004\230\053"
	"\067\374\366\260\311\274\203\372\062\051\023\253\246\201\361\335"
	"\203\133\104\147\245\114\201\107\221\032\052\253\332\055\213\033"
	"\324\122\144\342\351\221\100\120\237\040\300\006\204\274\272\311"
	"\146\306\075\261\051\311\232\340\167\136\277\170\012\065\253\257"
	"\242\303\167\240\342\224\302\107\122\374\350\321\223\160\261\336"
	"\105\331\120\213\140\237\006\013\373\311\357\254\337\330\357\327"
	"\200\107\314\212\353\350\250\302\253\247\321\100\272\164\151\312"
	"\163\351\004\327\201\123\016\365\314\067\235\170\246\040\211\074"
	"\206\073\057\031\254\302\212\215\071\031\064\026\234\336\311\254"
	"\164\312\320\331\103\033\062\245\015\002\015\324\264\357\160\017"
	"\241\253\205\116\014\022\276\236\045\221\037\002\126\207\155\230"
	"\123\237\007\273\354\075\263\274\031\353\133\015\262\153\334\343"
	"\347\031\126\235\053\346\252\250\201\122\312\335\121\342\240\014"
	"\061\060\231\012\327\150\333\143\123\267\014\232\173\373\002\047"
	"\307\327\146\323\244\175\060\306\020\137\026\367\331\013\071\012"
	"\022\135\246\360\261\146\334\263\121\011\327\254\143\256\130\241"
	"\300\215\132\157\345\173\107\233\002\260\002\304\231\274\002\013"
	"\036\110\121\132\037\241\240\206\357\133\222\011\021\123\124\037"
	"\143\366\062\315\174\325\164\345\057\146\347\046\364\240\133\125"
	"\004\077\124\254\136\261\205\316\151\336\126\142\231\213\333\076"
	"\324\217\257\042\024\203\006\011\121\366\254\353\076\215\245\142"
	"\216\253\267\040\250\370\062\344\344\347\021\152\324\352\307\011"
	"\111\342\302\141\250\252\144\266\237\110\103\344\126\357\121\006"
	"\001\004\230\321\251\275\355\172\051\230\203\325\333\222\004\367"
	"\231\005\170\221\163\372\215\136\050\135\072\034\122\323\047\223"
	"\132\050\355\045\056\070\172\006\350\376\133\034\143\361\276\121"
	"\342\332\000\362\037\074\321\030\021\343\130\277\065\266\100\013"
	"\364\264\266\041\373\157\052\042\124\325\233\270\043\151\011\331"
	"\232\323\015\133\074\266\045\073\176\101\007\055\314\130\040\156"
	"\335\211\146\112\052\220\352\106\117\130\157\044\316\344\061\235"
	"\147\014\111\022\127\310\025\137\165\131\230\046\167\365\005\255"
	"\162\265\254\237\034\123\274\156\242\166\315\023\273\235\265\131"
	"\331\005\336\275\204\350\176\136\143\074\031\316\202\353\116\326"
	"\355\217\163\132\174\351\362\073\320\072\013\042\140\311\203\263"
	"\212\344\377\352\205\232\167\251\135\161\023\326\116\355\312\356"
	"\341\223\042\005\103\104\106\164\371\310\216\120\060\301\205\024"
	"\235\076\054\003\364\005\044\066\132\226\161\117\366\105\200\257"
	"\060\267\034\324\017\030\131\364\215\016\370\144\244\057\215\302"
	"\102\045\031\204\054\234\027\102\215\177\332\353\057\135\065\023"
	"\113\255\203\147\106\222\025\126\254\320\012\154\357\256\177\122"
	"\144\025\217\355\041\160\073\206\007\062\322\267\037\032\176\221"
	"\357\335\161\350\300\161\345\322\223\114\114\105\027\141\257\236"
	"\011\044\150\151\121\071\302\377\323\321\224\025\054\333\046\247"
	"\274\370\042\203\317\252\236\053\144\035\352\112\177\002\201\006"
	"\347\242\031\227\325\005\305\230\170\223\025\003\276\120\170\243"
	"\370\040\044\276\373\316\304\045\344\075\120\320\275\004\171\165"
	"\343\133\050\016\211\157\202\020\262\175\357\150\216\147\053\115"
	"\150\277\322\054\177\235\023\265\301\320\215\157\070\050\166\006"
	"\312\312\101\145\160\377\360\205\061\351\375\163\023\112\106\002"
	"\133\044\265\076\174\114\051\070\232\210\211\253\314\321\012\314"
	"\165\041\113\100\263\364\074\066\354\070\206\277\051\057\106\363"
	"\123\310\157\273\146\302\367\166\200\130\042\177\315\026\117\035"
	"\116\355\147\126\140\235\240\127\113\041\376\253\020\206\070\165"
	"\330\156\257\252\106\134\355\351\031\234\035\153\127\210\030\357"
	"\037\162\213\203\213\305\347\135\345\071\315\244\256\310\257\122"
	"\075\041\334\232\351\133\054\136\076\155\252\312\225\324\277\204"
	"\142\266\172\240\022\076\070\136\074\334\013\106\205\353\347\325"
	"\352\036\043\113\005\374\112\376\136\323\251\025\122\115\273\136"
	"\104\343\067\011\240\175\172\325\327\124\031\332\144\257\353\266"
	"\173\216\265\346\203\076\363\075\243\216\216\350\071\237\250\160"
	"\134\037\364\001\035\256\346\327\023\376\013\135\101\330\104\135"
	"\262\233\074\200\332\337\252\071\105\060\220\056\327\271\236\335"
	"\060\274\041\320\311\240\267\144\171\207\355\057\230\041\040\377"
	"\120\335\036\332\034\336\165\152\110\154\304\174\063\272\062\172"
	"\353\173\327\217\121\361\110\155\166\164\165\126\105\106\332\111"
	"\021\311\074\107\156\300\312\265\261\317\022\275\322\236\301\066"
	"\161\367\233\111\214\333\256\062\161\314\045\132\365\152\376\206"
	"\350\316\274\027\134\203\165\261\144\045\167\341\023\060\264\135"
	"\245\201\310\125\267\311\144\365\243\126\220\361\052\023\071\240"
	"\215\264\343\000\052\027\277\125\341\022\067\251\302\032\313\114"
	"\140\010\043\036\225\353\037\312\212\352\327\245\031\364\115\167"
	"\253\005\370\272\254\260\252\144\236\336\206\122\320\171\137\050"
	"\045\007\157\325\043\065\121\226\037\046\032\211\022\235\157\244"
	"\345\035\324\105\005\045\161\206\322\172\125\317\130\117\154\137"
	"\215\172\031\007\347\012\354\155\006\327\101\275\301\370\152\040"
	"\144\163\255\244\022\277\354\153\212\230\345\057\025\143\000\065"
	"\070\002\240\266\015\256\234\221\142\070\063\106\177\216\031\164"
	"\271\117\374\201\177\014\301\302\240\152\261\030\061\261\364\056"
	"\003\016\270\277\273\031\155\056\104\072\130\241\251\137\227\175"
	"\264\206\376\106\051\174\114\171\345\164\174\316\246\375\332\065"
	"\251\375\234\107\170\071\241\335\134\131\343\137\330\162\371\102"
	"\254\117\343\370\071\133\030\065\274\313\320\171\127\237\007\304"
	"\321\261\107\132\107\111\105\132\256\123\175\176\117\060\003\367"
	"\213\117\164\026\317\065\135\141\024\316\141\256\367\364\303\062"
	"\316\263\313\371\076\061\333\121\326\324\127\045\136\302\012\326"
	"\313\254\252\343\267\323\203\202\312\377\307\157\112\107\373\244"
	"\040\324\021\173\246\020\167\230\333\161\273\147\246\041\167\016"
	"\356\354\240\226\117\315\120\024\015\264\224\054\374\236\216\122"
	"\303\000\043\305\010\274\360\104\021\213\232\375\234\331\034\315"
	"\052\125\105\133\103\153\250\101\356\054\002\101\062\204\047\141"
	"\275\133\370\151\350\243\134\327\250\023\345\323\145\071\175\076"
	"\327\367\070\366\201\314\324\252\226\150\317\027\262\002\144\124"
	"\014\250\302\251\142\013\075\261\272\125\266\052\340\063\361\220"
	"\164\300\124\023\241\012\236\214\242\304\260\212\341\345\273\335"
	"\117\236\332\121\332\065\360\012\233\210\014\237\002\174\106\307"
	"\341\345\367\302\352\116\263\027\177\303\123\064\357\361\310\306"
	"\302\224\134\010\005\372\266\033\101\045\247\275\065\003\112\151"
	"\364\264\112\337\224\013\072\012\156\370\203\335\330\321\224\257"
	"\041\337\275\134\225\055\274\172\341\333\163\032\121\064\340\125"
	"\276\040\142\254\167\311\301\003\157\262\255\024\000\313\153\123"
	"\312\202\000\076\210\315\174\232\072\106\063\337\267\043\175\051"
	"\121\053\005\222\352\213\025\054\232\231\020\111\221\062\135\146"
	"\103\357\136\173\164\051\202\174\351\324\074\164\342\171\162\171"
	"\335\215\370\037\271\242\167\117\110\227\007\001\361\172\115\034"
	"\150\003\135\366\104\070\331\026\117\323\105\157\230\071\262\216"
	"\275\373\216\166\322\333\327\052\015\332\334\076\115\071\144\122"
	"\041\022\003\302\124\333\116\376\240\270\321\107\243\261\134\260"
	"\352\376\221\061\037\217\126\262\063\211\173\070\370\106\367\100"
	"\107\077\366\037\375\261\244\015\235\016\340\240\056\040\237\254"
	"\242\231\351\060\164\024\355\303\335\126\375\364\016\031\347\132"
	"\333\047\011\016\161\026\007\354\065\204\170\275\240\132\016\330"
	"\040\033\256\122\102\232\306\076\020\237\147\256\243\065\006\062"
	"\206\077\353\176\041\230\025\262\335\111\337\342\105\264\024\370"
	"\271\223\012\066\210\157\217\157\347\307\151\072\311\264\050\113"
	"\140\003\010\023\312\230\173\242\146\314\006\354\236\350\071\170"
	"\072\317\335\216\044\155\345\223\237\240\063\076\133\074\231\217"
	"\266\356\243\157\021\135\362\053\034\203\011\060\147\303\272\315"
	"\301\344\347\240\164\204\202\321\125\110\057\303\037\202\026\253"
	"\177\223\271\154\201\173\274\143\207\273\157\346\214\273\135\343"
	"\163\225\211\263\313\265\131\204\375\153\335\027\377\340\336\036"
	"\356\125\072\214\261\277\155\266\216\320\132\253\151\061\007\130"
	"\137\101\062\174\101\077\242\074\241\221\107\276\155\040\114\116"
	"\274\361\151\060\174\323\162\167\140\167\001\324\070\360\047\064"
	"\236\066\114\215\047\151\317\206\027\336\236\154\045\256\255\371"
	"\125\252\132\302\166\074\047\346\370\276\261\340\064\337\232\220"
	"\146\144\363\201\260\271\276\213\326\251\152\214\331\035\357\234"
	"\177\121\260\347\116\262\270\242\302\172\230\064\175\356\012\071"
	"\137\062\067\116\030\340\220\321\255\146\241\053\216\141\021\101"
	"\002\233\316\240\141\115\136\340\060\162\171\313\330\370\336\271"
	"\043\165\350\147\176\177\324\301\064\337\006\037\160\307\073\071"
	"\273\310\204\063\254\250\224\022\163\207\065\137\113\045\077\110"
	"\205\006\045\034\241\143\357\276\052\027\027\016\334\364\321\350"
	"\351\143\062\045\233\065\306\133\012\042\231\377\001\205\077\365"
	"\271\304\307\245\354\205\342\237\172\276\013\110\036\322\054\100"
	"\361\062\252\130\254\320\052\161\041\376\103\267\343\030\362\124"
	"\163\247\314\110\376\213\006\146\124\154\242\146\006\301\016\074"
	"\343\002\375\273\106\152\064\047\117\013\016\232\254\350\232\325"
	"\306\066\101\265\220\205\150\146\353\362\331\335\252\313\205\062"
	"\036\241\261\167\260\327\164\236\314\366\027\334\267\276\122\054"
	"\017\257\015\272\361\352\016\057\266\265\312\250\320\065\264\230"
	"\243\045\105\365\005\017\152\310\333\021\362\153\162\206\015\132"
	"\070\250\335\215\033\310\334\331\331\157\301\147\107\345\243\346"
	"\341\300\025\060\132\106\336\167\020\265\163\212\361\031\305\301"
	"\354\352\371\016\037\165\353\033\253\167\061\256\142\036\034\001"
	"\233\375\223\225\113\166\240\041\300\032\231\203\360\062\137\200"
	"\270\163\331\121\273\032\015\074\031\106\322\313\101\031\137\364"
	"\026\363\211\141\151\052\203\052\105\034\255\065\116\015\266\007"
	"\200\217\130\074\251\146\171\303\254\114\216\356\145\356\342\174"
	"\341\154\336\112\226\141\164\333\176\041\021\314\057\307\323\257"
	"\126\054\354\000\222\145\304\077\262\122\056\027\100\020\224\041"
	"\175\162\154\023\324\340\357\122\002\000\037\061\310\363\341\037"
	"\040\316\037\263\064\343\362\346\066\040\375\166\061\222\230\256"
	"\005\004\302\332\345\261\054\350\262\114\031\172\100\373\232\140"
	"\312\271\023\376\235\006\344\323\047\342\112\130\164\343\006\172"
	"\350\311\124\315\172\200\266\055\315\320\250\016\313\102\156\225"
	"\374\202\224\231\210\170\155\257\133\270\010\317\234\017\111\204"
	"\330\235\122\123\036\010\200\354\330\050\372\244\153\151\072\147"
	"\353"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
