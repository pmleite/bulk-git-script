#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f bulk-git.sh 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[9]))
	"\111\106\374\333\066\162\232\015\100\041\322\006\053\076\121\205"
	"\006\247\355\176\326\042\163\001\101\254\362\115\236\101\310\156"
	"\252\231\215\214\127\171\317\367\117\111\364\003\043\044\225\107"
	"\131\050\322\220\306\205\340\001\072\225\004\217\243\006\210\223"
	"\047\244\022\164\104\365\332\147\075\246\155\151\156\211\046\215"
	"\312"
#define      chk2_z	19
#define      chk2	((&data[83]))
	"\264\061\353\062\102\245\127\071\376\336\312\006\056\304\056\045"
	"\051\261\016\174\364\043\331"
#define      text_z	5220
#define      text	((&data[225]))
	"\300\133\333\117\310\044\225\305\000\313\070\232\330\170\010\102"
	"\346\222\151\164\134\134\365\303\021\047\346\352\370\376\250\271"
	"\132\203\010\042\250\235\350\250\151\040\102\102\230\113\204\177"
	"\335\355\363\071\112\351\374\133\020\343\105\011\341\356\303\073"
	"\162\314\136\032\151\107\302\323\147\005\025\000\120\232\177\055"
	"\210\163\147\322\135\144\055\156\107\162\167\051\141\072\145\323"
	"\006\303\355\160\013\260\104\162\266\132\163\007\364\362\065\174"
	"\146\234\116\303\000\174\061\110\357\220\256\122\354\001\002\053"
	"\177\333\216\107\351\117\203\252\360\261\077\111\271\072\054\120"
	"\063\300\300\116\075\223\265\353\056\235\371\342\152\324\137\331"
	"\334\133\000\072\367\217\156\223\101\251\345\041\330\264\341\044"
	"\220\033\070\047\025\071\311\317\050\162\215\043\362\205\247\303"
	"\230\163\073\222\277\354\322\262\221\246\100\160\311\035\241\233"
	"\311\333\344\115\173\062\222\236\206\271\142\274\201\316\327\267"
	"\337\047\374\277\063\327\364\375\010\257\120\117\362\345\067\330"
	"\370\365\023\156\137\377\077\321\055\217\304\012\235\232\100\115"
	"\115\331\100\360\044\074\375\262\237\102\137\354\353\161\331\316"
	"\273\177\222\070\265\241\137\224\057\074\132\052\033\313\255\222"
	"\177\223\042\353\307\154\350\316\027\302\212\022\014\165\240\063"
	"\256\320\343\231\171\216\335\135\231\017\040\221\171\167\357\221"
	"\302\237\324\015\237\153\076\334\211\016\266\104\135\111\206\214"
	"\042\057\241\114\142\001\012\055\302\372\337\234\041\035\370\251"
	"\356\046\267\002\315\335\006\036\261\003\337\222\326\007\043\311"
	"\210\333\331\224\227\214\062\373\111\341\022\144\160\253\127\251"
	"\206\003\022\362\264\156\315\030\230\221\345\046\234\364\312\304"
	"\362\302\041\073\075\130\122\005\026\226\237\110\073\361\004\355"
	"\067\325\134\367\176\114\223\037\254\226\036\016\357\117\174\173"
	"\022\106\210\212\146\010\167\113\215\067\345\352\375\052\371\242"
	"\054\174\346\143\210\134\177\362\017\075\366\257\355\236\371\272"
	"\144\142\336\367\372\276\232\005\300\271\135\161\206\151\203\100"
	"\126\351\353\354\243\016\145\207\237\312\147\350\373\004\231\073"
	"\375\012\062\071\324\105\023\237\316\174\160\365\216\014\104\337"
	"\013\217\010\021\176\022\111\140\377\370\043\333\143\035\167\164"
	"\322\212\215\277\160\317\027\056\201\150\241\314\371\076\170\136"
	"\160\024\053\241\200\203\211\227\056\125\175\346\247\066\357\266"
	"\167\047\262\115\061\265\351\245\016\167\051\061\326\371\116\336"
	"\143\165\115\277\211\012\357\132\136\136\024\272\364\133\014\163"
	"\046\322\225\272\140\261\317\317\171\267\022\161\350\056\101\326"
	"\361\161\143\103\156\100\030\127\375\147\020\116\046\040\203\007"
	"\176\151\020\051\010\031\163\052\235\200\062\151\147\254\121\101"
	"\016\170\115\021\352\306\147\027\060\354\135\054\342\002\307\236"
	"\107\162\054\333\021\232\105\327\363\345\340\007\025\301\157\246"
	"\307\052\331\153\313\341\211\047\221\102\022\044\372\106\275\150"
	"\256\354\371\024\150\264\106\257\171\073\376\352\225\133\020\004"
	"\004\253\056\204\231\077\265\044\066\236\065\365\200\332\127\235"
	"\174\330\315\315\357\024\336\122\201\113\215\204\367\265\257\037"
	"\332\366\202\135\273\023\337\337\134\152\065\367\037\222\375\133"
	"\173\160\012\242\234\064\361\173\005\334\340\067\043\130\133\236"
	"\064\305\052\351\361\254\305\172\341\057\042\140\217\156\246\233"
	"\246\231\151\325\276\257\115\030\345\344\055\021\332\204\071\143"
	"\050\257\151\034\140\224\305\217\343\055\344\253\277\233\040\307"
	"\000\071\361\062\334\330\126\342\160\231\245\010\352\165\247\154"
	"\076\237\106\303\162\002\323\157\201\012\222\131\167\106\162\351"
	"\223\236\373\251\112\321\006\022\020\161\121\310\335\341\211\352"
	"\077\026\102\142\252\311\324\207\050\276\016\375\014\162\035\202"
	"\200\346\323\045\035\031\275\223\115\156\241\323\174\061\312\000"
	"\223\332\234\335\375\115\377\230\206\103\261\007\247\016\013\332"
	"\111\355\321\225\315\063\172\104\051\316\104\357\374\350\177\320"
	"\210\072\050\075\003\014\005\050\100\255\173\253\002\331\067\357"
	"\114\001\204\320\323\221\060\231\136\314\331\044\126\374\215\146"
	"\217\216\207\013\047\344\304\104\300\226\124\153\277\012\031\010"
	"\332\262\040\316\133\303\313\275\222\176\004\056\116\255\271\355"
	"\321\234\261\315\302\217\254\263\262\220\360\364\343\170\151\160"
	"\166\145\275\317\300\175\255\017\101\335\257\231\253\141\054\166"
	"\370\061\066\031\255\343\016\125\161\325\220\370\275\152\013\342"
	"\231\032\240\113\216\255\125\054\062\155\042\333\277\202\137\034"
	"\072\354\350\063\363\237\066\305\300\324\022\140\362\177\130\227"
	"\072\231\154\211\252\051\350\121\020\223\356\137\113\065\004\171"
	"\172\325\264\060\304\177\367\053\101\021\022\245\274\071\030\243"
	"\073\021\220\062\227\260\010\120\063\067\363\241\271\010\177\267"
	"\132\302\213\045\152\263\102\075\254\303\020\377\362\367\075\214"
	"\041\211\123\130\267\122\300\041\217\133\043\077\222\031\242\176"
	"\152\241\263\032\040\055\273\304\277\176\106\201\231\033\030\046"
	"\217\272\134\042\147\351\223\307\250\271\217\364\146\235\216\337"
	"\074\367\247\322\067\355\174\042\332\233\014\227\352\062\350\072"
	"\322\201\001\114\066\060\135\162\215\040\212\100\100\333\303\263"
	"\213\377\350\023\217\220\252\271\113\364\366\060\143\332\255\116"
	"\321\176\151\151\153\145\131\016\010\366\206\047\031\173\222\354"
	"\126\242\116\244\364\012\041\314\003\153\104\255\156\272\271\324"
	"\164\214\064\047\214\216\112\001\360\044\045\270\050\041\150\002"
	"\004\363\216\211\052\044\141\232\317\274\336\011\354\206\301\130"
	"\073\121\010\172\170\147\263\355\117\275\261\172\045\155\046\120"
	"\113\006\155\223\103\032\217\105\142\116\344\226\237\112\121\024"
	"\015\236\226\115\342\026\076\374\300\363\210\230\252\140\307\305"
	"\064\130\155\147\057\344\321\364\275\033\224\317\362\307\341\007"
	"\145\176\213\342\352\063\167\227\355\247\063\315\222\271\163\042"
	"\340\117\243\024\311\206\254\133\217\344\042\105\160\047\147\114"
	"\245\267\255\225\132\250\326\211\067\306\023\347\036\070\015\112"
	"\207\340\263\015\326\352\354\063\246\262\322\241\143\150\023\024"
	"\366\230\131\037\255\165\322\214\322\250\374\152\361\025\103\343"
	"\126\357\365\125\355\331\222\066\064\155\006\105\201\046\164\233"
	"\327\136\362\371\247\015\025\347\254\346\202\055\226\366\357\375"
	"\031\002\250\121\357\201\057\107\245\121\145\353\310\073\264\367"
	"\001\354\275\333\376\117\202\007\224\137\255\320\211\367\327\102"
	"\061\211\163\323\006\111\311\210\277\161\207\230\233\150\062\136"
	"\202\223\214\117\012\032\277\144\377\114\247\152\307\106\375\107"
	"\033\306\176\240\376\157\210\263\100\242\134\024\222\226\231\136"
	"\103\163\070\266\243\064\236\147\247\045\252\342\204\325\301\321"
	"\356\222\355\017\137\160\033\174\143\057\055\373\231\165\177\311"
	"\343\233\334\006\107\241\232\305\302\301\335\070\256\036\203\306"
	"\044\254\173\013\027\015\123\135\166\005\316\374\267\206\104\013"
	"\153\156\363\115\137\152\214\266\035\035\306\074\344\013\111\042"
	"\124\066\334\344\216\246\072\013\061\223\373\153\270\117\172\316"
	"\224\005\163\176\165\150\125\252\072\045\100\012\252\374\355\203"
	"\317\333\003\344\117\244\350\215\020\043\234\164\161\226\017\070"
	"\370\151\037\314\071\253\107\207\002\126\112\014\212\070\223\317"
	"\015\052\173\332\130\036\215\021\003\321\072\146\316\170\024\302"
	"\232\312\377\006\263\027\370\000\370\224\317\100\230\074\264\226"
	"\212\366\041\154\303\163\273\120\056\216\325\165\167\370\236\071"
	"\023\272\241\216\223\000\270\225\333\300\123\370\131\036\344\051"
	"\176\000\231\251\027\126\273\252\334\266\245\334\032\134\221\044"
	"\125\303\026\325\225\021\036\370\054\113\174\274\075\026\172\230"
	"\300\202\047\035\124\245\353\357\032\121\043\031\051\360\211\047"
	"\006\061\036\106\335\203\266\261\156\176\027\204\373\136\235\136"
	"\205\247\000\366\112\376\035\042\266\036\267\177\013\263\034\132"
	"\200\101\272\035\254\175\135\167\236\155\006\131\130\105\103\236"
	"\135\364\230\253\027\170\335\254\033\206\050\205\240\271\010\020"
	"\262\153\206\077\370\076\255\116\125\206\324\000\153\114\342\062"
	"\171\271\322\360\206\002\322\346\061\361\116\200\122\261\071\217"
	"\156\344\037\226\246\343\207\122\034\233\173\110\276\313\066\034"
	"\227\217\237\200\264\332\076\173\274\130\145\370\237\255\072\353"
	"\117\230\250\020\012\250\341\246\052\240\274\011\153\133\234\150"
	"\210\213\066\117\145\166\324\043\370\256\077\375\313\125\352\056"
	"\215\067\342\027\370\361\320\136\000\113\337\124\356\334\037\174"
	"\056\006\104\105\301\333\025\200\030\271\103\271\327\322\106\265"
	"\137\030\147\215\166\257\021\313\035\057\153\153\074\147\222\374"
	"\317\166\061\163\335\311\022\002\072\243\241\151\002\146\176\306"
	"\073\025\265\115\332\344\017\154\047\322\247\063\171\120\305\215"
	"\122\033\076\365\264\301\346\145\075\040\017\174\060\053\167\124"
	"\131\225\111\114\221\312\205\017\040\027\061\333\277\144\356\222"
	"\143\213\335\106\160\265\150\216\171\301\214\045\264\340\325\114"
	"\305\373\231\167\255\375\266\211\045\203\100\065\036\152\033\337"
	"\315\204\345\344\237\144\133\021\276\331\265\044\001\242\076\311"
	"\355\374\320\075\261\125\362\351\004\237\341\142\040\216\225\036"
	"\245\324\350\116\327\310\233\130\064\060\366\356\247\311\025\162"
	"\032\364\336\152\305\356\067\122\332\120\041\273\001\026\025\221"
	"\131\316\330\317\114\226\217\223\220\121\164\276\202\201\060\214"
	"\015\070\023\143\166\013\007\063\255\276\070\320\141\167\144\270"
	"\135\314\327\227\333\110\330\253\217\255\121\357\012\107\365\005"
	"\001\151\310\226\251\246\202\124\121\255\320\134\052\077\075\011"
	"\327\153\316\073\237\001\241\341\123\042\215\221\004\074\230\367"
	"\101\215\151\131\134\205\236\220\125\013\105\114\126\224\002\121"
	"\007\151\235\210\124\243\024\275\023\350\200\142\370\345\033\303"
	"\332\167\055\137\033\146\044\201\310\027\063\215\123\015\031\112"
	"\242\045\003\246\107\213\020\231\157\054\150\071\107\265\243\073"
	"\041\066\334\203\307\035\376\230\321\233\170\213\012\255\231\151"
	"\230\314\212\374\362\005\045\203\363\047\026\046\113\336\051\320"
	"\264\021\344\346\350\006\003\205\216\376\374\371\212\333\120\060"
	"\026\330\152\367\153\321\040\037\371\222\336\311\133\335\062\156"
	"\127\367\141\246\155\100\135\151\234\111\106\034\011\137\166\210"
	"\244\367\256\237\352\063\272\246\014\325\065\347\157\105\000\134"
	"\275\356\331\124\231\324\143\151\163\161\000\363\334\302\071\376"
	"\271\111\234\137\317\224\331\073\172\321\210\357\261\243\137\225"
	"\330\237\253\240\234\232\160\026\253\264\210\031\226\133\241\264"
	"\301\226\026\324\007\225\175\040\202\006\256\071\130\032\371\114"
	"\074\343\330\157\164\311\340\110\001\377\006\050\333\357\163\230"
	"\154\322\312\354\174\264\103\017\320\315\367\064\363\322\122\151"
	"\205\357\334\260\127\321\340\076\045\217\067\154\001\153\313\216"
	"\041\147\063\332\241\143\117\164\263\244\153\221\205\043\326\315"
	"\242\207\320\146\150\167\147\157\345\174\022\105\251\220\024\370"
	"\254\044\330\246\257\150\335\143\222\022\316\155\267\262\075\060"
	"\210\126\226\302\231\111\053\157\110\124\251\215\122\144\157\074"
	"\335\011\311\000\060\027\060\301\346\147\264\375\044\042\333\320"
	"\243\331\071\362\311\241\164\144\222\135\043\030\225\364\110\006"
	"\160\310\222\007\326\241\263\105\331\170\345\230\124\144\040\331"
	"\162\253\263\332\126\374\350\275\000\372\063\231\075\022\341\111"
	"\210\204\164\130\173\151\006\250\326\355\156\051\265\142\134\223"
	"\207\256\320\211\105\136\153\311\055\027\233\141\155\321\240\144"
	"\336\111\355\225\362\374\350\137\137\354\025\040\003\205\372\055"
	"\110\257\252\155\306\200\123\304\225\017\036\322\320\135\136\277"
	"\323\276\167\277\115\253\315\301\076\332\240\301\164\112\226\317"
	"\302\037\036\204\357\351\251\127\175\126\375\233\263\130\227\337"
	"\333\063\365\243\301\010\257\160\300\163\127\216\305\035\051\137"
	"\322\152\373\171\205\331\217\241\236\153\062\347\222\117\067\377"
	"\130\106\346\252\175\347\245\231\000\060\044\160\373\372\014\023"
	"\120\315\105\217\162\011\255\045\316\170\352\145\233\011\271\207"
	"\115\140\071\263\331\067\221\076\156\257\326\202\065\262\250\150"
	"\040\305\251\302\167\263\301\204\251\073\011\214\034\307\144\024"
	"\032\035\114\225\156\136\025\054\072\373\151\111\160\344\253\126"
	"\211\162\036\325\130\277\261\336\066\105\117\017\232\274\326\111"
	"\373\010\365\104\235\054\320\232\100\322\064\237\347\005\150\243"
	"\302\074\206\276\271\327\055\215\014\305\340\126\012\230\217\270"
	"\261\104\252\223\040\233\164\057\334\014\253\370\115\014\135\323"
	"\112\115\333\307\022\335\067\234\020\035\351\146\355\143\353\271"
	"\320\030\147\004\154\307\073\034\315\364\170\076\340\051\157\024"
	"\113\267\013\352\046\236\063\011\226\006\113\336\313\211\345\007"
	"\360\004\312\164\275\136\143\062\240\155\074\336\217\031\277\233"
	"\133\161\264\375\107\164\256\157\360\355\121\372\036\207\214\202"
	"\045\163\174\213\013\353\233\046\361\227\070\252\325\211\252\010"
	"\344\100\361\322\326\223\246\055\111\070\000\254\340\064\335\032"
	"\173\107\133\372\310\013\204\111\023\030\030\242\254\330\114\262"
	"\161\211\074\347\300\065\143\200\174\106\260\330\234\220\157\165"
	"\161\105\323\035\225\010\044\166\131\134\060\262\355\241\114\327"
	"\215\262\130\271\367\260\150\365\211\331\157\012\156\027\170\356"
	"\175\041\012\330\035\343\031\014\041\161\343\222\353\234\313\352"
	"\106\051\117\206\010\160\217\152\166\160\337\142\344\236\240\376"
	"\010\201\256\032\050\163\172\065\021\036\322\002\237\213\354\235"
	"\075\225\127\251\352\063\335\334\270\043\002\251\106\312\146\011"
	"\106\361\350\256\166\114\342\116\361\076\257\205\066\110\017\006"
	"\212\107\050\136\101\241\256\006\200\131\117\115\060\266\331\012"
	"\232\121\047\007\064\065\052\204\277\012\214\362\200\020\360\133"
	"\070\026\257\333\222\226\157\024\161\227\200\054\165\327\021\004"
	"\175\141\357\050\164\076\306\131\167\056\276\245\322\115\056\072"
	"\320\216\233\320\242\021\000\374\304\250\223\145\207\010\244\110"
	"\061\155\136\133\070\223\365\140\375\323\037\030\271\212\350\074"
	"\144\242\115\042\253\371\136\167\264\022\205\117\013\152\277\275"
	"\205\222\141\151\033\351\337\326\156\201\064\014\131\144\333\374"
	"\223\130\235\376\317\322\100\311\304\373\225\155\060\177\172\313"
	"\156\342\175\324\027\104\004\255\042\136\336\144\130\111\325\157"
	"\075\232\171\123\261\336\172\276\216\303\221\271\157\146\034\326"
	"\053\235\154\071\207\325\121\012\202\224\352\020\026\074\335\211"
	"\001\005\166\276\036\365\231\302\327\010\306\160\136\002\342\335"
	"\215\331\034\236\115\276\234\026\345\343\257\062\026\226\312\165"
	"\222\151\347\125\121\050\320\126\075\274\330\163\131\010\155\260"
	"\054\157\312\162\360\251\174\174\235\250\320\027\227\073\267\172"
	"\067\236\175\267\111\066\244\164\020\216\074\004\045\067\246\214"
	"\161\347\367\224\303\222\262\170\124\252\034\146\127\325\244\051"
	"\332\204\035\116\212\222\311\162\315\352\012\337\204\257\236\341"
	"\162\246\235\135\125\154\353\337\324\361\111\250\362\234\336\064"
	"\036\331\050\232\170\020\223\304\227\266\164\154\264\260\260\115"
	"\300\014\266\372\326\240\316\250\003\153\032\140\063\067\247\305"
	"\036\072\152\237\301\142\150\017\255\153\341\204\343\001\020\347"
	"\113\017\136\004\144\131\100\362\151\053\260\075\105\072\173\316"
	"\227\314\170\145\236\120\331\104\367\377\374\276\040\346\323\255"
	"\236\203\232\105\326\100\151\173\256\265\235\272\357\211\335\142"
	"\012\231\176\222\065\017\054\257\372\363\322\137\203\346\066\354"
	"\176\165\156\203\340\124\277\020\262\346\026\242\125\307\157\177"
	"\366\024\053\122\120\374\023\161\311\374\145\331\232\133\026\377"
	"\040\216\054\274\161\073\012\322\350\117\035\177\014\274\140\302"
	"\317\300\014\055\101\067\310\277\324\034\370\167\113\367\152\253"
	"\025\141\116\152\201\052\040\345\152\175\116\107\060\200\157\206"
	"\242\001\225\135\143\061\104\270\106\170\377\056\350\055\300\125"
	"\103\343\360\241\200\074\016\051\177\161\005\376\225\052\364\152"
	"\002\264\066\271\167\303\063\343\364\346\354\032\335\306\273\042"
	"\020\236\275\056\377\040\354\221\254\265\023\072\176\032\151\217"
	"\363\255\345\337\076\367\214\275\275\103\320\205\122\237\151\336"
	"\002\353\042\017\044\111\213\323\314\144\211\047\131\325\001\227"
	"\076\200\202\174\223\205\062\035\151\164\225\261\342\354\210\250"
	"\330\001\123\164\305\322\341\325\132\205\206\141\071\271\006\334"
	"\354\145\235\377\340\360\314\212\042\062\321\102\266\122\242\241"
	"\165\007\022\036\303\072\352\137\232\150\251\257\115\171\004\134"
	"\174\232\077\014\252\113\241\162\341\350\044\111\300\310\171\263"
	"\063\200\304\323\213\242\336\306\053\047\347\140\306\165\100\101"
	"\013\003\066\217\072\371\001\300\146\356\376\027\222\060\214\314"
	"\323\354\341\061\077\231\020\152\172\026\342\152\201\164\375\154"
	"\155\163\032\340\106\103\373\135\033\017\162\334\315\175\114\040"
	"\277\033\270\113\113\046\106\362\377\314\236\044\220\314\046\071"
	"\231\161\264\213\137\147\227\361\161\170\317\056\266\215\265\200"
	"\257\166\165\052\131\127\100\061\043\041\274\227\207\101\322\300"
	"\011\057\117\141\367\353\254\023\110\043\141\056\375\225\034\251"
	"\025\102\000\223\350\215\026\140\333\177\211\373\174\354\025\262"
	"\304\376\137\372\015\112\037\250\143\226\220\125\064\127\162\062"
	"\104\161\206\116\232\070\066\124\214\160\071\025\364\276\330\346"
	"\363\011\234\353\242\030\325\060\325\020\020\251\332\250\044\327"
	"\246\200\216\232\153\046\264\062\354\225\021\270\015\241\172\277"
	"\240\362\104\331\122\000\216\032\071\157\104\277\351\200\164\245"
	"\074\332\056\052\215\010\253\220\356\242\170\220\116\310\176\253"
	"\157\326\062\176\306\275\156\104\365\311\212\016\263\133\264\321"
	"\241\277\121\211\354\176\156\074\262\361\111\243\234\031\234\253"
	"\311\043\221\300\103\313\066\201\314\260\215\052\357\231\011\142"
	"\142\142\203\260\041\027\235\167\067\043\151\365\315\213\052\222"
	"\210\025\170\316\112\265\305\124\242\326\111\300\101\171\206\165"
	"\260\310\032\162\125\307\224\327\055\171\147\155\235\305\011\144"
	"\111\351\241\246\023\173\354\040\224\047\225\256\020\227\110\112"
	"\141\374\256\111\151\016\215\073\153\266\046\310\301\074\046\201"
	"\000\210\024\221\227\105\012\066\036\224\065\066\277\054\247\140"
	"\143\265\011\200\033\227\357\320\022\134\327\347\041\327\115\334"
	"\151\006\047\160\011\360\321\310\171\203\012\106\161\034\350\226"
	"\244\312\064\272\160\153\105\357\347\344\132\047\056\326\225\213"
	"\037\152\337\045\307\072\175\102\202\144\247\053\043\277\045\335"
	"\346\313\165\133\124\046\334\242\225\153\330\062\153\011\211\041"
	"\043\375\072\226\006\342\333\203\043\016\305\052\245\134\353\314"
	"\207\016\257\307\037\356\373\337\251\102\016\140\252\045\317\277"
	"\207\334\260\325\143\010\223\076\303\224\250\014\337\120\016\245"
	"\343\017\103\257\051\142\224\114\345\366\100\254\231\047\214\135"
	"\340\222\140\037\120\202\245\167\363\157\140\160\076\142\362\346"
	"\002\242\260\101\302\101\242\111\164\225\362\034\244\161\077\132"
	"\050\304\245\305\342\076\304\375\357\166\102\173\041\123\265\246"
	"\045\015\236\223\365\115\227\017\067\365\310\026\174\101\221\243"
	"\052\226\176\077\304\173\257\244\043\043\213\043\376\231\076\176"
	"\043\325\022\166\207\265\246\135\163\133\271\314\152\152\133\144"
	"\037\320\116\041\173\154\276\064\000\204\326\221\374\240\112\321"
	"\134\326\155\256\136\264\272\346\266\156\071\021\077\023\032\124"
	"\334\041\021\221\036\310\307\171\217\373\157\053\354\203\274\221"
	"\276\334\074\116\210\346\135\141\141\062\135\072\170\161\206\156"
	"\322\311\067\017\255\060\071\311\143\253\353\363\356\312\360\046"
	"\300\333\227\314\363\100\305\072\265\064\107\334\235\331\000\072"
	"\307\007\055\340\142\137\171\037\256\261\237\171\045\255\156\164"
	"\210\147\312\367\056\051\233\315\265\240\241\264\150\350\363\010"
	"\373\343\154\062\067\031\063\050\201\252\206\062\370\077\071\356"
	"\353\173\006\200\100\012\076\302\203\257\273\165\305\131\200\005"
	"\166\262\204\065\356\277\021\317\345\146\326\027\246\047\053\106"
	"\276\137\362\357\012\211\155\112\234\324\146\242\306\124\001\276"
	"\015\035\235\275\376\176\305\131\115\205\044\222\044\146\216\373"
	"\304\072\373\056\043\017\053\077\217\122\170\220\301\352\207\023"
	"\301\235\100\271\104\173\354\043\054\067\343\111\101\015\074\164"
	"\164\106\171\066\062\054\374\056\161\257\253\120\325\017\123\371"
	"\303\122\013\326\350\073\250\215\106\273\323\023\326\125\333\176"
	"\353\331\136\341\367\367\034\230\055\311\203\256\343\300\324\041"
	"\331\202\275\357\164\105\147\227\246\107\322\266\215\065\266\165"
	"\063\324\100\153\056\176\065\041\242\252\304\317\073\343\027\147"
	"\107\217\271\073\371\142\365\317\053\173\010\154\271\102\065\000"
	"\070\160\064\175\370\323\364\167\163\176\026\235\323\130\252\154"
	"\043\125\244\073\243\371\275\123\135\270\312\265\343\046\261\123"
	"\143\144\056\336\007\242\205\064\241\233\342\046\017\044\010\324"
	"\352\152\037\036\314\356\134\170\355\242\074\135\325\050\067\223"
	"\102\105\054\352\326\034\036\063\262\330\042\355\262\020\366\005"
	"\261\335\274\303\253\030\331\357\237\214\002\373\050\014\034\337"
	"\206\127\144\236\365\376\343\261\262\047\052\116\302\141\103\225"
	"\220\116\306\302\101\010\016\212\146\163\032\001\176\012\132\310"
	"\024\032\212\156\172\324\262\023\311\305\326\027\364\272\264\334"
	"\173\167\154\053\251\146\156\035\121\273\313\114\105\060\127\357"
	"\113\214\260\345\027\343\126\367\234\371\323\361\071\373\011\251"
	"\343\107\151\037\307\235\221\035\245\276\261\315\045\022\352\260"
	"\347\300\262\031\256\217\224\366\211\172\263\063\031\061\041\166"
	"\053\345\120\066\332\206\252\351\106\006\110\242\274\261\274\026"
	"\135\241\117\260\364\320\175\352\001\322\302\064\267\050\250\062"
	"\145\165\205\064\226\042\344\376\155\360\153\177\344\336\073\372"
	"\117\050\206\132\367\235\241\362\023\321\342\232\363\147\227\266"
	"\314\022\335\047\244\050\047\064\057\267\175\154\107\322\002\211"
	"\315\134\066\350\344\003\207\026\261\035\112\355\110\231\245\275"
	"\224\206\177\203\105\034\153\140\373\215\224\007\104\012\113\001"
	"\261\242\030\342\274\324\157\241\315\242\073\357\273\135\275\357"
	"\215\364\351\240\201\166\161\305\054\077\006\007\225\027\355\316"
	"\135\356\027\323\215\241\316\137\330\105\162\153\326\316\166\327"
	"\006\176\275\003\375\002\352\202\252\205\105\051\274\157\066\071"
	"\231\162\307\124\302\226\277\221\165\242\044\175\333\322\314\156"
	"\034\076\366\216\251\117\066\110\332\300\300\035\133\272\172\335"
	"\344\125\211\047\346\116\222\132\113\311\241\165\110\230\221\077"
	"\206\047\355\276\242\255\025\335\071\306\244\222\102\345\160\151"
	"\175\124\261\241\017\067\361\130\000\023\374\066\063\234\025\316"
	"\207\326\062\372\153\365\263\366\066\111\154\015\370\031\332\156"
	"\315\035\365\332\066\122\364\317\267\117\126\222\273\116\344\157"
	"\024\274\334\171\036\130\172\160\223\010\042\241\040\251\161\120"
	"\344\326\043\353\232\021\133\245\302\240\030\171\372\213\200\357"
	"\175\265\153\344\121\272\247\122\067\331\233\046\202\014\167\146"
	"\342\233\121\175\254\255\042\157\115\072\350\110\305\151\067\103"
	"\036\243\047\160\136\317\303\225\250\136\274\052\152\063\220\115"
	"\316\341\312\173\216\355\352\334\047\323\044\354\074\133\060\133"
	"\377\127\313\135\046\217\362\317\355\256\371\127\342\211\245\260"
	"\153\160\053\372\135\026\326\204\352\372\161\047\126\241\202\125"
	"\371\116\263\040\335\246\357\312\125\350\042\067\162\310\347\335"
	"\070\023\327\225\051\255\031\023\250\213\072\377\054\275\125\046"
	"\013\010\106\351\256\065\264\003\036\327\072\220\237\042\156\327"
	"\065\105\154\136\363\206\162\234\021\254\233\075\152\360\143\166"
	"\370\252\137\246\340\024\252\376\353\344\217\212\006\375\142\073"
	"\103\316\232\066\124\014\322\145\271\156\243\043\136\007\231\127"
	"\262\371\376\222\015\250\220\371\215\037\204\224\035\346\317\140"
	"\265\152\226\012\166\151\160\057\330\023\123\066\033\354\216\315"
	"\346\214\137\364\065\360\355\302\020\161\126\055\130\046\215\015"
	"\220\044\027\007\216\207\067\146\233\212\235\267\167\053\205\135"
	"\267\345\121\354\325\077\257\345\260\005\023\011\053\240\026\274"
	"\305\056\303\123\266\372\271\122\204\126\012\374\201\217\131\071"
	"\164\253\046\112\352\325\060\233\333\103\245\006\343\273\303\250"
	"\352\206\374\241\201\265\363\006\014\375\002\215\215\134\307\002"
	"\010\355\114\362\303\174\216\236\277\063\245\243\357\150\114\332"
	"\356\110\173\160\376\156\166\012\154\170\227\372\325\137\374\335"
	"\114\110\320\017\305\137\255\205\222\122\050\202\273\165\134\251"
	"\275\327\032\273\106\220\306\263\011\135\256\336\275\252\274\011"
	"\363\214\031\270\353\307\076\176\032\146\000\325\333\135\177\231"
	"\065\231\124\174\051\032\060\063\170\336\022\065\211\316\077\174"
	"\132\131\065\106\040\163\304\072\332\305\017\265\043\217\117\130"
	"\050\244\325\122\277\005\205\067\344\230\155\155\146\255\352\300"
	"\006\037\006\047\223\313\141\155\220\161\043\263\000\162\014\051"
	"\026\341\174\325\347\002\015\313\232\173\070\000\051\042\301\057"
	"\102\307\126\326\223\270\104\043\052\150\327\053\332\343\124\361"
	"\304\321\307\253\323\325\167\155\121\257\156\172\322\057\252\025"
	"\367\001\353\212\272\057\255\344\227\205\017\162\150\144\144\055"
	"\065\053\331\011\001\120\167\122\000\345\315\322\024\167\347\014"
	"\171\323\226\063\002\104\027\232\311\047\014\062\213\160\137\301"
	"\234\070\312\236\211\101\360\211\047\276\134\073\065\103\107\256"
	"\026\336\341\031\042\371\263\354\040\300\036\254\061\176\156\316"
	"\266\070\154\077\172\135\311\241\033\045\335\121\151\045\000\177"
	"\004\342\231\047\333\114\023\374\015\062\251\076\260\027\014\146"
	"\120\171\246\313\326\160\154\362\225\112\103\376\160\103\176\164"
	"\045\027\233\001\144\256\376\161\341\247\257\221\276\274\370\017"
	"\065\236\332\013\017\107\375\244\222\101\243\002\204\041\166\252"
	"\070\021\254\235\300\252\016\241\121\275\063\020\172\053\037\257"
	"\311\371\272\331\101\270\175\323\371\040\325\176\101\113\050\172"
	"\135\324\027\036\176\046\300\320\344\363\340\136\036\377\015\350"
	"\371\310\301\072\200\077\015\171\137\342\367\241\056\040\034\214"
	"\365\064\253\164\133\153\104\077\137\044\235\176\044\253\146\035"
	"\163\050\127\363\147\144\155\307\106\145\151\165\205\206\001\173"
	"\273\255\357\026\030\064\125\170\131\363\366\175\236\135\232\021"
	"\206\361\005\356\126\162\265\235\327\037\022\135\245\024\330\141"
	"\301\310\167\332\375\314\123\126\300\111\323\136\247\156\160\055"
	"\137\165\033\266\350\321\123\277\361\146\035\227\172\366\370\074"
	"\276\157\027\274\073\152\022\373\264\345\132\133\124\312\211\263"
	"\100\245\152\050\166\275\350\147\043\006\377\236\374\367\332\273"
	"\146\362\167\242\134\211\236\021\157\370\155\303\303\366\167\004"
	"\233\341\055\022\236\026\172\302\034\171\140\030\160\073\323\326"
	"\055\113\171\211\324\027\233\104\020\010\007\324\376\177\331\232"
	"\141\006\254\377\035\046\302\071\240\042\122\020\135\046\347\213"
	"\161\141\025\106\170\260\212\211\270\222\136\267\021\067\122\162"
	"\076\376\162\133\045\065\225\305"
#define      xecc_z	15
#define      xecc	((&data[6419]))
	"\265\016\276\357\364\232\013\261\254\274\345\104\331\117\214\225"
	"\334\163\101\177\037"
#define      lsto_z	1
#define      lsto	((&data[6437]))
	"\343"
#define      pswd_z	256
#define      pswd	((&data[6458]))
	"\277\342\177\166\364\267\311\147\366\307\331\121\355\017\347\263"
	"\147\317\211\034\256\314\151\045\356\225\246\066\067\376\264\226"
	"\224\352\311\125\113\321\040\270\006\020\346\124\133\376\366\234"
	"\323\074\045\201\011\217\247\367\044\116\056\134\115\342\363\341"
	"\314\275\067\030\217\127\320\225\150\267\352\303\265\340\140\210"
	"\034\206\012\046\025\262\035\072\000\113\227\115\056\212\057\372"
	"\110\146\023\327\276\344\154\047\233\127\352\120\070\112\331\125"
	"\320\344\173\345\227\230\040\227\344\267\345\023\102\024\015\212"
	"\173\041\142\072\005\317\141\240\046\113\361\136\226\313\263\146"
	"\260\057\114\107\310\154\337\255\044\304\300\147\331\315\362\125"
	"\357\124\217\364\043\360\225\111\074\207\250\322\123\134\071\004"
	"\213\205\113\123\362\053\000\027\360\300\176\311\216\161\036\175"
	"\305\256\162\351\237\010\063\333\220\333\255\343\070\346\347\303"
	"\154\063\027\136\137\030\166\117\330\365\031\147\146\070\345\053"
	"\346\130\025\205\140\110\140\360\044\016\324\134\365\274\040\142"
	"\360\067\301\117\117\067\236\050\054\270\220\222\360\165\276\326"
	"\315\323\134\056\034\275\037\100\314\363\234\301\260\274\044\240"
	"\364\345\357\104\335\110\136\134\147\264\042\377"
#define      rlax_z	1
#define      rlax	((&data[6722]))
	"\045"
#define      tst1_z	22
#define      tst1	((&data[6724]))
	"\361\020\212\126\213\107\224\150\355\305\346\357\115\063\010\307"
	"\342\057\176\075\042\235\303\111\130\272"
#define      opts_z	1
#define      opts	((&data[6749]))
	"\126"
#define      chk1_z	22
#define      chk1	((&data[6753]))
	"\231\207\043\226\162\037\204\362\106\010\116\053\172\024\062\355"
	"\244\331\327\263\251\132\263\072\151\000\126"
#define      tst2_z	19
#define      tst2	((&data[6777]))
	"\211\041\067\003\076\034\011\060\374\127\077\203\312\277\350\266"
	"\033\366\241\365"
#define      msg2_z	19
#define      msg2	((&data[6799]))
	"\060\262\267\346\345\065\340\075\242\243\271\047\107\131\252\240"
	"\243\161\173\004\123\133"
#define      date_z	1
#define      date	((&data[6819]))
	"\111"
#define      shll_z	10
#define      shll	((&data[6821]))
	"\127\123\337\071\241\163\277\050\017\123\025"
#define      inlo_z	3
#define      inlo	((&data[6831]))
	"\044\205\306"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
