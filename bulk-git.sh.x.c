#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f bulk-git.sh 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\360"
#define      msg2_z	19
#define      msg2	((&data[3]))
	"\227\350\370\074\202\373\165\055\002\077\206\102\357\172\030\236"
	"\042\341\140\056\344"
#define      chk2_z	19
#define      chk2	((&data[24]))
	"\275\263\002\242\232\373\065\231\326\247\024\054\006\112\236\271"
	"\157\113\311\362\061\312"
#define      text_z	4932
#define      text	((&data[1181]))
	"\250\031\042\211\264\017\246\030\117\246\044\312\226\157\357\077"
	"\327\230\251\360\060\222\341\242\327\236\125\242\154\101\023\025"
	"\132\066\237\017\105\105\047\225\354\114\137\202\274\117\302\223"
	"\350\153\203\030\376\145\272\326\003\017\170\160\121\213\205\253"
	"\302\045\273\010\153\342\235\127\057\375\332\353\114\234\177\065"
	"\010\003\115\006\150\007\335\153\027\125\333\150\340\141\024\243"
	"\207\317\253\362\262\110\111\342\106\044\315\223\301\115\310\311"
	"\120\025\320\270\035\255\044\064\002\000\235\343\142\262\207\351"
	"\202\062\333\065\173\045\027\301\112\345\125\013\062\035\325\202"
	"\063\245\073\120\123\140\205\126\140\043\072\303\325\301\254\130"
	"\363\210\215\156\255\244\060\370\211\205\003\274\242\330\076\326"
	"\176\172\046\321\333\254\050\073\317\142\376\245\043\253\375\027"
	"\063\212\205\341\057\266\331\271\073\335\165\336\265\264\264\063"
	"\056\332\005\011\207\056\105\127\220\104\375\264\360\372\313\043"
	"\205\121\005\265\007\337\156\102\274\343\040\161\227\324\245\306"
	"\257\253\320\067\331\025\216\152\132\213\036\112\206\351\156\013"
	"\072\163\300\101\122\057\204\016\022\244\200\251\171\046\160\050"
	"\322\100\137\253\126\355\026\260\171\064\373\377\036\151\013\130"
	"\335\314\232\057\373\036\076\015\302\276\267\073\345\047\144\267"
	"\147\304\143\275\262\171\156\053\256\152\052\314\323\066\044\260"
	"\002\277\340\375\335\036\012\240\335\301\334\303\351\100\172\120"
	"\004\336\016\266\127\175\342\005\347\015\321\273\103\366\153\105"
	"\265\114\102\223\152\115\063\110\017\017\013\370\120\206\111\125"
	"\144\130\014\274\325\356\301\275\373\223\170\077\211\344\204\077"
	"\060\307\322\233\024\006\344\044\025\357\035\146\166\146\274\332"
	"\277\310\226\224\267\130\122\263\353\312\362\165\257\166\264\340"
	"\076\207\173\123\215\137\167\243\117\224\011\305\373\306\240\272"
	"\216\066\117\105\216\241\370\172\154\352\357\034\141\244\374\240"
	"\054\167\363\271\327\153\134\047\000\146\354\373\055\215\266\273"
	"\303\005\001\122\247\371\314\024\344\274\060\106\141\054\346\215"
	"\244\331\106\173\105\243\242\105\012\217\101\067\034\367\363\340"
	"\375\364\063\244\356\377\270\322\274\350\030\035\025\377\252\271"
	"\331\361\065\036\225\330\144\240\150\245\330\205\234\313\145\231"
	"\277\230\076\255\230\366\200\124\337\231\162\364\230\035\256\162"
	"\016\343\221\244\273\365\104\043\232\034\250\066\347\016\320\247"
	"\247\016\124\077\005\325\224\345\156\006\332\007\043\210\171\062"
	"\154\012\326\047\000\032\113\232\067\364\321\036\002\242\305\251"
	"\260\032\351\266\360\175\233\137\203\165\146\247\376\340\332\152"
	"\353\260\222\353\313\335\206\002\321\127\041\324\371\347\176\252"
	"\001\147\140\362\344\373\121\150\161\267\020\157\230\352\331\204"
	"\232\153\157\146\111\365\150\033\115\211\357\107\160\155\361\162"
	"\325\121\144\271\115\265\042\277\155\062\056\006\034\010\212\267"
	"\164\371\035\276\357\205\331\075\017\311\204\177\067\165\362\014"
	"\307\126\306\025\014\350\324\172\032\003\200\067\014\013\356\201"
	"\004\013\077\364\221\031\061\240\342\266\040\032\053\022\047\362"
	"\151\355\007\166\326\334\360\360\337\161\050\353\174\026\154\201"
	"\042\254\166\263\305\250\124\250\136\164\303\212\207\352\174\360"
	"\327\204\146\255\140\127\236\100\311\306\054\106\335\230\307\377"
	"\105\076\263\012\346\010\263\105\174\166\317\004\140\114\364\070"
	"\320\133\346\061\263\205\162\175\114\236\303\052\066\213\052\174"
	"\311\335\206\260\346\072\365\142\260\304\146\021\020\133\112\341"
	"\267\061\022\152\267\204\347\004\043\253\056\132\066\130\326\377"
	"\066\135\257\034\227\244\177\110\150\346\132\171\101\244\132\370"
	"\326\155\143\216\362\113\222\025\366\300\157\054\030\105\054\117"
	"\242\333\153\072\200\352\202\351\320\334\142\022\201\274\013\130"
	"\052\157\346\034\272\170\061\261\070\241\335\121\346\011\240\211"
	"\345\013\303\145\366\105\116\307\042\261\331\243\156\345\373\230"
	"\124\341\264\016\131\346\277\222\207\235\343\156\247\204\370\214"
	"\220\273\362\206\001\100\116\043\361\050\307\137\015\302\370\141"
	"\244\255\157\376\224\057\220\034\314\164\212\164\371\203\000\211"
	"\076\362\020\100\063\136\144\045\206\053\204\223\356\175\364\222"
	"\052\144\221\276\223\042\332\140\226\145\324\220\350\325\031\047"
	"\307\051\150\372\207\314\037\016\370\244\242\346\042\226\171\114"
	"\373\013\013\216\055\345\357\304\113\303\124\064\230\155\133\140"
	"\227\303\132\037\220\172\055\210\037\317\157\101\146\351\216\141"
	"\364\231\360\041\177\337\345\312\242\072\376\073\247\132\233\077"
	"\036\366\136\256\161\213\067\220\133\246\322\301\217\140\043\204"
	"\371\023\245\171\362\213\104\225\305\102\321\155\235\155\254\273"
	"\143\013\152\325\227\242\146\362\110\070\264\330\231\327\135\223"
	"\353\002\014\336\216\120\163\124\223\105\302\061\262\157\354\026"
	"\172\127\353\021\371\121\003\102\212\270\033\044\220\170\267\173"
	"\173\056\141\343\150\332\215\343\110\207\142\032\360\064\142\217"
	"\146\121\172\046\331\366\027\021\307\227\025\306\237\362\007\123"
	"\106\105\250\335\016\365\153\070\075\131\366\377\315\100\337\231"
	"\042\111\265\046\201\000\301\016\302\111\170\014\160\364\015\233"
	"\272\171\271\113\002\246\062\050\150\103\154\373\335\233\271\366"
	"\211\206\143\053\130\020\035\105\114\323\101\336\221\063\001\227"
	"\015\353\064\130\356\063\000\075\043\105\143\035\130\030\332\041"
	"\067\223\051\147\364\366\021\012\060\365\311\043\257\010\133\042"
	"\307\177\262\167\042\102\076\165\075\102\072\115\071\335\367\131"
	"\077\377\223\343\172\223\316\367\366\216\243\312\037\164\255\152"
	"\155\022\231\250\323\332\152\010\236\303\107\274\317\255\310\004"
	"\202\240\342\207\241\114\274\207\334\147\107\245\236\153\330\133"
	"\333\112\324\143\350\363\144\014\245\333\246\205\127\142\116\166"
	"\313\342\337\012\017\344\227\317\063\307\371\162\250\031\334\335"
	"\307\126\105\345\027\023\054\117\116\265\010\017\117\301\344\221"
	"\151\347\236\047\044\013\215\276\013\135\120\262\071\064\222\366"
	"\033\021\045\236\246\140\223\251\030\171\342\046\323\123\255\142"
	"\240\365\347\306\100\011\004\141\237\145\251\377\225\105\204\146"
	"\121\276\122\235\242\071\050\063\154\302\122\244\313\321\054\214"
	"\067\252\201\126\314\327\274\301\200\310\267\357\345\264\376\014"
	"\201\352\164\350\175\045\253\334\357\156\103\210\135\326\142\234"
	"\356\371\115\272\251\003\153\074\173\364\240\367\044\362\010\126"
	"\253\114\276\235\327\167\032\324\133\170\006\053\225\115\273\275"
	"\361\023\257\364\145\014\132\104\325\220\276\331\166\165\257\263"
	"\074\226\356\363\154\011\024\316\006\324\327\242\365\142\016\355"
	"\217\124\017\050\117\023\010\020\334\237\063\053\212\171\053\221"
	"\155\073\152\304\177\261\363\251\324\154\174\323\353\333\354\077"
	"\327\253\154\154\246\215\223\300\134\125\147\313\324\007\365\064"
	"\274\261\013\134\361\342\046\222\036\136\107\175\270\046\156\304"
	"\216\355\211\036\221\072\142\306\052\320\147\371\324\350\107\236"
	"\212\143\315\067\102\040\371\355\256\275\340\301\306\320\334\363"
	"\046\372\103\276\045\153\120\132\024\241\246\272\176\062\055\251"
	"\113\377\074\305\221\237\177\064\112\157\313\307\343\131\374\373"
	"\331\246\140\013\325\102\312\054\341\210\030\052\130\014\052\131"
	"\324\210\017\047\170\262\144\130\040\375\053\104\370\361\072\117"
	"\003\320\271\171\214\237\027\076\300\013\126\077\005\035\052\137"
	"\026\152\037\356\350\027\370\342\003\104\025\000\353\121\117\377"
	"\202\163\126\101\132\054\153\367\111\334\200\176\275\204\016\024"
	"\054\307\375\160\301\200\142\274\165\374\025\045\253\121\163\236"
	"\301\046\062\316\107\211\034\022\157\034\145\115\013\306\376\172"
	"\253\073\233\312\322\354\150\010\121\154\330\036\330\367\272\322"
	"\012\270\206\060\004\017\041\250\063\127\044\024\237\154\212\131"
	"\076\277\105\002\141\357\253\236\234\332\204\057\116\121\361\057"
	"\307\104\067\153\373\356\015\142\226\206\353\143\320\047\104\335"
	"\033\231\151\106\233\005\103\247\213\162\137\314\352\014\243\163"
	"\013\242\173\300\231\065\307\026\160\332\230\042\072\223\233\135"
	"\054\306\363\145\257\201\267\227\074\260\076\275\072\012\303\002"
	"\067\071\225\235\234\224\027\123\173\346\264\074\336\060\242\064"
	"\356\060\233\370\147\255\241\242\032\157\277\170\050\056\154\040"
	"\220\370\137\050\007\315\152\330\115\161\370\010\161\202\272\246"
	"\264\162\374\371\053\103\041\304\253\047\371\047\167\315\016\270"
	"\355\371\255\362\033\176\060\341\160\337\365\120\340\311\267\144"
	"\250\227\350\122\016\372\210\273\117\005\353\065\001\246\162\072"
	"\024\022\277\254\212\275\170\253\121\167\301\111\126\247\101\131"
	"\316\155\314\073\140\073\374\326\151\246\046\162\047\137\367\064"
	"\352\024\022\043\023\102\345\212\371\241\171\104\070\374\106\232"
	"\010\232\242\306\245\015\316\210\276\363\224\062\262\002\036\372"
	"\044\241\232\323\375\115\124\354\107\325\227\173\254\271\342\141"
	"\175\334\306\230\114\236\155\214\254\021\220\216\204\012\125\263"
	"\073\333\264\057\341\362\103\033\371\043\375\360\100\131\043\014"
	"\006\167\253\013\126\212\337\055\331\230\336\270\101\157\352\252"
	"\107\105\300\162\270\314\221\236\243\107\366\255\363\265\165\375"
	"\363\154\212\155\002\366\236\304\073\354\012\320\047\212\333\104"
	"\065\026\047\072\320\327\066\177\105\310\320\044\144\212\367\160"
	"\346\204\116\271\105\261\377\264\307\166\260\236\111\043\006\271"
	"\012\254\117\305\070\126\121\075\172\072\355\170\235\307\024\010"
	"\334\270\072\222\165\337\301\214\076\044\211\073\212\213\135\073"
	"\212\302\162\224\020\232\307\112\237\225\371\065\377\002\057\205"
	"\213\077\024\054\137\353\333\163\026\111\074\043\163\244\316\147"
	"\130\213\161\265\070\102\335\050\221\275\155\350\017\347\375\355"
	"\074\160\363\177\172\165\253\140\346\344\275\171\330\171\021\052"
	"\263\267\255\103\061\265\250\102\000\042\356\057\163\120\066\060"
	"\155\276\234\366\012\147\236\175\357\370\036\367\143\037\314\353"
	"\101\106\330\111\033\307\074\235\040\106\005\052\065\054\314\127"
	"\376\260\050\100\267\341\010\004\345\050\177\345\117\322\170\254"
	"\025\312\307\254\035\223\340\020\277\117\054\305\037\324\276\274"
	"\102\144\071\044\331\024\044\242\147\041\213\111\172\120\364\134"
	"\062\327\057\075\201\142\255\204\156\134\055\335\217\342\256\272"
	"\274\341\000\326\103\051\331\343\312\306\225\140\101\322\031\311"
	"\344\162\201\010\203\351\172\353\252\111\321\123\213\335\377\356"
	"\144\003\047\050\322\061\224\266\047\220\255\130\333\336\157\343"
	"\020\375\121\223\141\261\006\065\153\173\360\101\141\125\227\122"
	"\074\111\170\225\305\214\336\335\230\113\220\313\326\332\172\311"
	"\304\147\173\213\160\264\130\360\177\107\063\174\023\266\022\245"
	"\130\044\033\103\004\141\007\132\150\357\336\323\027\014\003\261"
	"\054\142\204\161\034\225\047\166\237\053\264\240\354\327\300\341"
	"\225\110\305\145\006\101\176\154\251\362\352\313\365\245\116\007"
	"\252\371\260\235\270\234\113\063\344\342\040\060\060\002\033\071"
	"\266\217\026\026\145\215\257\172\060\271\226\157\034\300\240\042"
	"\021\016\304\032\235\221\266\213\270\245\101\266\275\321\221\164"
	"\316\275\320\212\123\127\075\354\134\336\226\321\147\253\060\267"
	"\146\030\031\164\236\331\363\327\137\062\114\137\065\115\107\156"
	"\220\031\313\214\131\272\005\240\226\353\123\264\367\161\225\221"
	"\034\333\073\174\314\035\316\103\345\375\233\050\171\222\110\065"
	"\025\034\117\162\153\023\106\127\067\311\217\015\275\171\371\235"
	"\022\054\321\250\307\255\013\310\310\156\116\001\107\131\204\311"
	"\307\371\060\377\130\310\243\165\255\223\304\145\077\251\214\020"
	"\326\157\075\060\026\034\320\031\210\305\264\172\113\340\367\003"
	"\115\236\165\173\006\211\336\363\154\006\021\031\213\132\072\305"
	"\166\300\325\370\271\310\015\043\103\043\176\231\377\133\252\062"
	"\114\272\356\013\155\101\131\162\106\061\110\373\360\245\140\162"
	"\300\140\054\163\037\004\121\000\173\002\334\303\047\253\253\020"
	"\073\117\342\050\352\137\016\262\172\074\352\112\100\105\174\024"
	"\020\073\176\303\111\312\214\264\116\177\207\162\177\116\050\140"
	"\306\064\373\214\340\371\362\176\272\061\232\374\122\205\353\164"
	"\310\330\040\273\175\211\347\226\324\027\353\310\272\134\217\104"
	"\203\324\344\306\002\111\265\274\373\225\333\332\122\043\227\241"
	"\016\077\112\203\222\116\206\046\045\245\306\220\341\326\316\337"
	"\201\305\211\133\232\040\300\025\257\067\261\156\315\253\001\052"
	"\374\073\300\333\166\137\106\230\174\331\377\055\331\201\163\145"
	"\257\162\202\064\054\231\053\211\350\137\257\057\173\353\220\026"
	"\374\271\243\324\322\374\122\254\056\103\301\325\305\036\075\062"
	"\330\341\125\055\264\347\106\315\223\124\151\043\170\033\260\167"
	"\157\000\071\254\241\236\216\031\355\007\060\132\272\076\342\001"
	"\275\311\336\151\045\015\154\046\064\345\102\361\137\104\142\343"
	"\026\253\213\201\356\041\071\151\337\167\207\102\246\172\302\070"
	"\254\362\156\327\250\020\047\343\377\004\307\271\157\313\223\200"
	"\213\210\065\056\376\022\234\064\363\176\116\002\151\014\021\214"
	"\007\122\042\231\004\357\274\325\043\327\242\012\363\371\134\025"
	"\027\232\156\353\115\150\150\217\166\341\202\306\266\325\255\377"
	"\215\121\055\274\061\221\356\121\316\352\220\372\356\355\173\070"
	"\305\372\124\357\303\201\076\123\356\101\277\211\147\127\162\066"
	"\024\151\043\240\006\254\176\210\230\133\331\343\062\121\055\103"
	"\377\354\165\075\373\222\062\205\364\234\345\242\357\241\035\365"
	"\336\202\343\337\244\223\201\326\132\146\011\157\013\035\106\375"
	"\267\120\352\075\313\354\063\105\340\350\100\234\376\213\021\237"
	"\045\271\310\242\350\121\226\364\016\156\237\152\262\026\101\177"
	"\017\267\045\354\211\256\253\256\154\353\012\364\146\141\036\260"
	"\141\022\336\311\002\235\013\360\365\021\251\250\266\236\152\341"
	"\347\202\362\316\157\333\044\336\222\065\055\053\017\073\002\105"
	"\055\153\064\237\020\063\333\173\123\215\113\326\143\135\020\346"
	"\241\157\211\124\101\040\024\000\356\050\302\220\337\244\351\016"
	"\250\020\121\217\123\271\253\307\276\111\253\103\163\134\130\163"
	"\263\273\036\152\213\031\056\227\112\301\337\345\160\252\036\326"
	"\122\136\166\001\357\230\235\342\351\345\143\105\304\375\342\115"
	"\251\166\364\350\007\044\010\127\353\006\221\316\022\375\141\323"
	"\340\314\323\206\213\221\001\021\101\176\334\052\336\276\155\144"
	"\350\222\111\123\034\061\246\374\203\212\274\254\102\365\351\221"
	"\217\302\364\062\262\237\172\077\177\117\245\025\374\111\355\003"
	"\116\362\174\247\074\143\034\270\033\226\364\236\045\026\110\044"
	"\204\162\070\310\177\305\060\057\317\222\270\115\240\272\363\261"
	"\300\021\051\273\067\014\351\104\124\027\323\375\220\042\052\075"
	"\063\161\051\243\352\340\125\055\335\055\362\145\243\155\364\006"
	"\226\151\037\156\164\315\363\031\014\363\305\255\305\256\143\254"
	"\070\126\325\241\221\011\320\337\170\216\237\252\257\274\151\103"
	"\176\221\274\113\231\203\304\344\106\122\306\074\135\053\132\076"
	"\205\071\344\261\277\303\335\140\371\313\300\332\027\075\240\310"
	"\075\057\037\010\005\167\042\211\037\057\335\010\257\314\112\105"
	"\366\375\107\172\077\217\026\150\137\170\015\342\347\041\233\335"
	"\217\054\341\264\070\327\346\012\344\211\301\363\212\037\337\160"
	"\252\271\334\267\056\020\145\273\064\136\353\130\007\105\053\121"
	"\217\236\377\275\335\204\226\305\043\130\377\130\223\076\230\171"
	"\171\313\177\216\124\323\037\231\103\215\053\206\273\242\111\210"
	"\143\203\337\072\355\134\155\323\304\273\154\242\125\105\362\161"
	"\102\156\235\223\236\032\303\257\201\346\033\100\243\262\124\270"
	"\151\331\037\143\171\202\176\251\276\007\213\220\017\011\002\130"
	"\263\262\323\170\111\262\020\277\172\103\250\255\334\251\045\302"
	"\262\111\333\002\214\235\132\335\365\032\142\227\316\057\104\363"
	"\125\235\272\342\313\261\154\071\103\040\174\134\173\163\254\026"
	"\107\120\313\102\174\076\156\000\157\325\306\170\210\304\156\371"
	"\256\127\154\016\017\302\145\156\173\337\361\040\150\004\047\123"
	"\265\257\057\251\316\201\047\114\261\072\275\236\220\024\010\027"
	"\044\150\152\076\077\047\276\112\211\277\135\370\273\300\027\175"
	"\102\160\152\304\374\227\215\346\273\332\213\200\364\350\227\070"
	"\325\147\034\304\134\313\006\134\054\003\101\324\375\131\204\170"
	"\116\276\366\003\077\020\112\103\014\332\252\002\150\354\121\301"
	"\341\162\227\143\114\122\337\332\354\247\367\342\064\053\044\146"
	"\075\100\146\205\105\034\000\360\304\200\340\062\026\001\314\342"
	"\160\230\210\170\045\150\162\330\354\224\313\236\225\225\373\173"
	"\124\244\363\063\014\360\065\257\114\274\221\056\142\145\300\217"
	"\245\000\325\034\333\115\300\271\136\232\264\355\117\110\010\115"
	"\152\134\227\137\371\226\270\245\227\336\223\362\312\213\012\123"
	"\345\210\130\021\325\137\201\252\043\076\045\204\006\333\173\167"
	"\160\056\237\165\272\152\277\076\304\136\300\372\137\054\002\077"
	"\030\135\072\302\226\264\174\035\263\022\337\224\021\035\022\060"
	"\244\230\152\132\200\046\277\050\032\243\173\231\101\104\201\105"
	"\170\030\171\110\325\036\003\251\065\321\244\156\145\073\173\245"
	"\267\307\013\253\320\147\061\104\377\077\235\246\107\174\053\153"
	"\256\151\250\203\062\034\167\220\212\013\061\327\334\141\313\152"
	"\110\256\254\255\140\200\106\252\116\370\371\253\316\130\350\174"
	"\323\034\105\372\231\107\161\133\260\311\256\157\167\202\134\174"
	"\043\255\015\037\023\111\351\156\347\211\044\346\376\220\176\064"
	"\207\005\260\372\013\030\006\136\046\101\243\006\105\005\170\036"
	"\134\212\142\102\377\251\124\041\242\021\170\313\042\236\257\174"
	"\150\303\122\360\235\364\224\047\212\036\271\105\332\301\024\114"
	"\026\313\032\223\323\154\270\174\266\253\043\172\137\322\303\273"
	"\252\261\112\303\304\272\344\335\137\044\107\172\250\101\026\306"
	"\240\027\157\366\017\343\031\177\055\242\051\063\347\011\147\174"
	"\171\273\372\136\134\346\036\263\252\212\010\166\226\210\350\113"
	"\347\251\313\274\351\317\254\337\004\003\125\030\075\051\222\153"
	"\145\167\232\145\274\035\320\216\352\164\342\140\103\213\353\024"
	"\127\260\330\204\156\247\204\104\320\070\057\342\056\035\053\077"
	"\163\024\342\155\204\301\131\257\343\365\162\235\053\161\141\225"
	"\206\344\354\375\350\254\333\025\321\152\233\302\022\047\332\300"
	"\126\024\265\051\042\333\226\040\002\035\013\012\204\106\251\354"
	"\206\022\327\043\207\260\374\067\355\161\346\110\144\321\022\105"
	"\173\146\072\203\246\277\027\370\047\165\237\353\176\137\333\210"
	"\243\360\133\142\207\146\337\346\356\034\015\016\226\022\173\317"
	"\067\321\045\005\330\053\106\320\071\270\130\341\157\272\145\063"
	"\325\063\350\014\325\120\244\125\130\121\161\052\152\120\321\346"
	"\271\242\157\070\356\121\134\350\257\173\005\047\271\110\351\047"
	"\320\040\233\310\310\156\260\366\346\025\024\035\060\250\011\047"
	"\225\332\301\363\065\330\000\077\144\022\027\164\013\160\232\006"
	"\260\074\215\131\274\261\240\374\262\063\215\264\311\264\357\355"
	"\042\157\121\137\253\360\164\011\310\026\302\144\260\174\114\233"
	"\176\102\216\222\271\365\056\071\000\166\342\335\363\304\040\112"
	"\264\073\314\342\371\267\153\153\376\143\273\146\376\145\042\351"
	"\354\273\263\312\246\344\045\145\176\237\341\026\320\301\171\272"
	"\273\163\070\166\053\041\164\073\046\200\012\076\357\011\237\121"
	"\353\360\152\335\031\303\236\117\143\114\215\266\223\336\331\261"
	"\243\024\073\055\302\024\351\023\370\027\133\371\133\330\142\235"
	"\200\262\307\323\101\207\207\021\110\302\016\127\140\202\004\345"
	"\041\160\040\144\005\201\314\205\257\150\013\207\224\076\117\044"
	"\015\354\004\211\201\060\157\000\263\317\055\341\130\021\252\312"
	"\300\115\262\342\123\354\365\354\227\152\173\275\364\133\354\100"
	"\174\246\307\253\045\146\076\022\120\053\065\354\011\267\061\210"
	"\306\163\332\251\146\154\301\264\241\071\322\017\032\317\235\210"
	"\324\000\310\007\210\371\274\325\200\215\203\324\373\066\174\025"
	"\244\047\153\164\015\346\353\053\044\252\120\325\100\371\255\264"
	"\366\352\204\306\342\135\215\001\144\350\352\234\127\141\040\352"
	"\033\160\122\202\272\307\070\261\326\027\076\301\201\237\074\254"
	"\122\272\174\312\372\076\361\004\047\112\206\151\000\014\261\233"
	"\105\373\355\027\103\075\172\077\252\362\204\045\273\117\365\050"
	"\311\345\346\375\216\024\157\166\000\162\054\253\252\056\263\244"
	"\013\306\144\050\147\256\320\115\345\132\046\344\232\176\302\062"
	"\214\056\000\253\127\360\042\064\116\164\322\335\351\322\252\040"
	"\355\327\247\207\052\372\357\337\034\205\072\311\144\173\233\322"
	"\006\134\215\247\243\176\153\063\137\114\254\177\235\236\116\261"
	"\111\310\154\023\232\156\264\033\153\207\327\235\067\175\110\312"
	"\031\015\125\354\305\171\117\260\225\172\174\226\235\134\167\007"
	"\022\354\172\132\027\132\341\310\316\074\211\105\321\013\344\376"
	"\060\365\036\123\064\001\337\276\131\367\025\076\216\027\251\241"
	"\213\163\154\321\307\074\174\261\166\162\153\301\251\272\033\255"
	"\124\251\147\325\012\104\114\165\054\014\077\011\305\043\256\077"
	"\014\223\333\155\072\254\337\253\221\316\221\343\003\112\030\377"
	"\134\055\365\141\117\306\122\210\117\040\015\330\225\256\275\102"
	"\304\235\265\034\300\201\276\104\330\067\352\017\134\002\103\061"
	"\111\331\237\031\162\155\241\343\167\331\307\077\002\143\034\073"
	"\316\351\223\017\275\010\114\263\315\177\054\147\021\116\272\035"
	"\331\346\322\017\376\371\011\364\241\003\077\030\306\247\177\004"
	"\040\064\367\161\377\354\132\046\246\107\146\175\373\124\051\260"
	"\071\223\014\350\012\127\174\047\365\350\170\024\133\110\075\263"
	"\261\140\372\046\144\077\271\312\173\020\017\072\055\205\111\217"
	"\243\255\007\035\311\013\175\231\015\001\054\150\352\252\323\221"
	"\314\030\343\137\336\302\050\372\346\351\305\247\143\355\170\245"
	"\244\376\121\344\061\201\047\203\173\200\131\150\176\167\110\017"
	"\277\170\176\016\261\172\142\340\131\231\063\326\260\342\366\141"
	"\312\372\360\133\144\261\061\162\234\131\341\174\363\050\101\005"
	"\021\246\323\166\353\352\213\346\245\377\256\105\274\250\131\012"
	"\255\252\127\136\201\233\360\021\120\107\033\350\276\243\224\037"
	"\032\250\312\250\056\157\074\356\373\040\306\354\030\153\307\376"
	"\276\322\326\144\142\303\116\022\174\041\002\075\144\152\125\345"
	"\121\140\146\213\152\073\321\366\140\235\040\124\137\041\145\171"
	"\113\120\123\064\322\161\357\033\033\251\112\316\055\257\126\351"
	"\033\134\075\111\253\141\251\224\306\034\352\224\035\022\317\303"
	"\017\317\066\176\127\341\347\271\305\014\137\010\160\327\141\065"
	"\121\063\127\355\170\254\236\120\327\223\137\361\333\073\374\127"
	"\160\360\076\143\100\046\161\310\216\356\043\023\236\037\164\206"
	"\212\364\104\272\200\173\250\272\330\072\002\141\353\154\247\014"
	"\043\351\160\313\245\034\303\242\343\133\174\314\142\300\332\114"
	"\215\132\113\254\024\002\344\205\154\261\326\056\051\363\256\237"
	"\020\235\327\037\133\370\164\106\361\373\155\177\104\054\153\027"
	"\107\037\250\125\046\104\373\111\306\353\174\373\312\246\313\246"
	"\120\267\170\024\232\224\154\054\011\323\322\324\204\140\144\124"
	"\171\037\052\131\257\224\034\054\372\100\223\215\236\076\005\161"
	"\231\353\044\253\150\170\113\247\156\364\201\167\314\141\213\247"
	"\266\262\015\207\227\022\234\141\264\156\237\211\376\301\245\301"
	"\323\335\007\241\017\274\361\324\377\144\310\312\345\271\300\117"
	"\335\301\236\156\023\313\320\256\030\104\112\013\062\177\142\130"
	"\212\315\062\224\160\251\353\310\307\102\103\131\207\226\261\117"
	"\112\315\217\016\060\361\003\254\001\236\233\053\211\021\146\343"
	"\267\131\132\245\163\263\023\246\170\122\271\261\142\077\224\346"
	"\360\116\162\350\167\333\102\111\217\241\123\031\023\006\016\240"
	"\351\006\135\106\063\174\270\252\062\341\173\336\357\037\226\074"
	"\157\367\055\053\134\002\353\330\360\210\326\035\237\155\145\024"
	"\250\063\112\107\134\263\003\244\054\052\105\264\106\304\226\247"
	"\001\356\044\345\003\303\231\006\354\135\212\226\361\170\141\217"
	"\073\273\362\222\304\004\276\025\113\026\147\025\152\261\114\360"
	"\200\012\324\271\307\333\301\030\054\060\034\021\161\003\276\057"
	"\132\274\300\107\026\026\045\242\243\107\006\056\065\300\370\317"
	"\202\200\067\041\377\305\347\013\265\335\355\251\053\243\242\124"
	"\101\142\036\327\365\322\301\114\256\055\305\114\334\055\104\235"
	"\335\103\053\235\323\117\230\044\340\365\207\331\037\355\323\155"
	"\102\213\341\043\125\023\176\051\033\044\117\156\117\272\132\244"
	"\251\317\153\213\304\023\052\353\337\354\250\140\170\317\015\160"
	"\100\175\172\113\035\174\101\330\155\051\347\072\367\122\112\003"
	"\240\127\101\175\277\002\106\111\125\063\114\054\173\171\033\035"
	"\264\104\257\204\250\163\271\154\131\312\362\200\250\223\236\101"
	"\307\167\061\115\254\132\036\344\130\261\362\120\110\347\053\144"
	"\064\051\312\155\022\274\346\372\254\242\071\312\261\113\275\137"
	"\044\327\310\104\017\227\257\330\015\077\203\071\220\004\160\146"
	"\233\220\372\204\131\111\015\013\257\023\342\024\352\270\104\010"
	"\106\335\015\247\352\371\222\261\126\212\257\261\313\330\066\267"
	"\122\206\320\126\370\127\013\207\372\226\266\353\054\221\333\321"
	"\060\242\214\310\163\024\216\377\322\274\075\001\356\227\143\333"
	"\162\163\166\005\011\370\070\066\322\316\027\233\276\070\027\243"
	"\317\371\264\062\356\257\233\043\005\064\325\261\342\323\120\245"
	"\167\067\215\343\256\144\110\214\212\031\320\340\010\065\155\341"
	"\214\076\241\145\206\146\352\015\046\015\252\075\375\115\207\063"
	"\311\162\053\150\277\002\302\062\310\210\054\315\335\232\173\301"
	"\366\270\025\315\364\014\201\256\377\357\361\226\034\251\272\316"
	"\316\346\153\301\212\053\361\105\164\353\015\170\213\107\025\027"
	"\073\317\354\324\043\022\017\317\135\044\270\325\272\007\320\267"
	"\240\233\136\244\127\240\267\166\103\065\145\036\164\027\026\307"
	"\167\375\362\026\206\341\326\030\324\044\041\257\123\177\204\275"
	"\070\125\047\262\371\225\231\100\211\150\374\321\157\117\166\037"
	"\142\325\344\065\030\060\345\113\155\252\131\266\033\203\107\016"
	"\027\172\340\123\112\062\221\324\144\141\017\113\031\330\073\261"
	"\321\203\276\266\163\304\131\011\025\315\136\250\022\040\331\305"
	"\217\306\333\011\035\306\033\027\030\037\131\243\327\164\307\150"
	"\355\177\344\150\103\076\161\130\013\317\001\036\360\333\343\177"
	"\242\276\211\277\205\244\326\236\304\060\101\233\244\011\004\221"
	"\211\350\372\314\046\154\045\062\074\047\120\054\003\064\254\245"
	"\363\065\144\170\332\073\027\237\154\131\073\021\142\077\243\353"
	"\047\235\270\115\011\336\177\105\006\320\161\011\005\036\256\370"
	"\124\023\161\057\117\210\316\273\341\011\314\103\110\157\057\160"
	"\014\350\275\026\307\075\133\315\016\315\327\023\354\205\013\100"
	"\231\174\157\350\004\075\243\345\107\160\051\217\337\131\377\354"
	"\102\275\003\012\373\137\330\011\055\257\034\031\065\050\131\316"
	"\244\311\266\251\007\132\217\116\313\271\335\253\023\335\227\125"
	"\232\233\137\225\372\067\236\047\347\273\101\034\343\232\352\210"
	"\144\241\061\153\374\301\271\307\172\227\162\215\164\012\343\016"
	"\245\102\244\240\172\103\310\141\376\011\175\342\244\150\153\010"
	"\012\234\164\007\136\055\316\330\304\101\146\070\114\111\107\362"
	"\214\353\222\006\057\132\150\055\144\346\020\010\117\173\021\131"
	"\030\205\140\166\262\057\117\167\160\265\257\275\377\367\257\213"
	"\343\101\222\022\234\373\100\000\341\120\011\060\313\032\212\344"
	"\237\353\132\122\032\252\311\213\140\171\110\140\160\367\353\124"
	"\071\176\146\325\172\246\326\133\366\337\214\302\371\027\247\231"
	"\002\001\353\035\254\265\250\014\056\361\155\237\351\130\363\043"
	"\327\132\370\121\000\317\255\367\256\072\272\250\122\141\101\124"
	"\143\055\161\017\342\032\034\021\014\211\260\366\342\244\031\272"
	"\376\022\014\377\341\272\367\220\365\261\070\107\022\172\233\165"
	"\247\015\205\212\050\242\233\065\054\114\053\017\361\105\311\360"
	"\127\326\357\071\220\346\311\206\230\002\315\252\174\151\040\044"
	"\167\246\257\237\111\113\325\165\227\001\204\211\106\116\171\236"
	"\045\151\327\265\120\241\074\351\244\011\224\041\162\264\105\351"
	"\133\365\211\244\100\136\032\330\137\237\141\246\356\333\104\023"
	"\105\034\311\226\276\005\177\142\016\023\203\201\310\311\152\044"
	"\276\364\310\376\122\343\326\262\203\070\131\161\024\236\205\131"
	"\272\116\360\171\124\157\333\142\203\136\344\113\050\116\157\346"
	"\103\070\345\226\034\273\111\237\364\242\020\010\100\225\142\373"
	"\344\122\164\070\302\120\233\105\257"
#define      tst1_z	22
#define      tst1	((&data[6664]))
	"\316\000\276\176\345\170\303\015\163\056\101\043\004\004\021\027"
	"\001\072\073\037\202\234\105\226\304\021\071\243\247\126"
#define      xecc_z	15
#define      xecc	((&data[6694]))
	"\123\223\006\226\214\254\362\107\010\267\310\212\345\274\035\102"
	"\253\316\134\324\234"
#define      opts_z	1
#define      opts	((&data[6712]))
	"\307"
#define      pswd_z	256
#define      pswd	((&data[6730]))
	"\322\225\124\030\105\324\251\034\242\252\333\264\344\176\134\072"
	"\335\046\264\107\141\117\117\000\333\147\016\201\147\364\252\022"
	"\201\343\135\314\345\233\357\355\353\356\075\137\034\051\135\150"
	"\117\021\260\261\141\000\261\075\147\300\277\317\265\151\341\066"
	"\114\077\003\062\332\362\037\306\341\134\046\376\206\203\146\326"
	"\225\027\207\367\030\070\064\177\371\363\116\256\135\060\344\251"
	"\160\350\334\112\333\373\021\274\130\067\272\337\273\041\265\121"
	"\071\074\110\121\165\175\321\156\161\040\034\316\120\001\170\300"
	"\352\125\013\305\120\035\202\251\125\075\210\020\137\076\142\230"
	"\172\252\352\357\050\273\136\231\333\172\150\054\174\341\355\146"
	"\066\371\054\207\026\256\061\154\354\271\174\113\370\336\344\162"
	"\211\317\142\261\212\300\113\146\073\263\223\267\224\200\036\313"
	"\172\113\122\221\372\203\375\346\075\171\062\065\130\027\250\342"
	"\346\012\224\161\313\337\327\006\223\153\276\050\354\335\363\146"
	"\050\105\367\042\310\364\011\006\156\073\073\307\123\344\251\071"
	"\356\075\253\271\035\203\300\260\356\177\330\332\134\313\101\204"
	"\021\070\247\332\055\260\340\233\354\034\143\100\000\014\172\357"
	"\112\115\057\061\341\066\215\266\322\114\206\123\135\313\015\060"
	"\141\142\110\246\066\362\303\331\234\236\216\200\034\353\273\372"
	"\071\353\054\032\041\272\320\364\006\127\107\143\043\125\224\204"
#define      rlax_z	1
#define      rlax	((&data[7033]))
	"\241"
#define      tst2_z	19
#define      tst2	((&data[7038]))
	"\307\153\214\126\005\306\117\227\075\237\144\123\073\374\057\065"
	"\157\234\174\246\202\340\007\354\251\101\247"
#define      msg1_z	65
#define      msg1	((&data[7069]))
	"\317\225\264\212\146\250\220\275\333\017\173\257\144\155\015\274"
	"\102\142\324\044\175\150\304\305\115\203\324\377\241\111\121\356"
	"\242\003\235\122\242\176\156\001\175\232\242\333\135\205\050\011"
	"\046\242\003\376\150\363\151\043\026\110\371\220\334\160\100\211"
	"\173\101\337\041\141\127\012\007\146\360\364\340\106\210\145\375"
	"\145\220"
#define      shll_z	10
#define      shll	((&data[7143]))
	"\177\147\115\112\021\066\241\141\351\127\263"
#define      inlo_z	3
#define      inlo	((&data[7154]))
	"\225\133\302"
#define      chk1_z	22
#define      chk1	((&data[7161]))
	"\064\127\305\307\364\332\363\064\357\370\371\122\215\355\272\126"
	"\167\051\203\264\152\300\371\055\022\204\047"
#define      lsto_z	1
#define      lsto	((&data[7184]))
	"\071"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
