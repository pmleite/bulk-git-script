#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f bulk-git.sh -o bulk-git 
#endif

static  char data [] = 
#define      rlax_z	1
#define      rlax	((&data[0]))
	"\130"
#define      inlo_z	3
#define      inlo	((&data[1]))
	"\024\266\150"
#define      pswd_z	256
#define      pswd	((&data[38]))
	"\103\361\031\135\357\207\336\304\163\161\115\232\014\252\134\144"
	"\325\041\352\004\127\341\276\234\055\021\106\067\037\315\003\143"
	"\277\035\045\363\300\313\330\367\204\070\245\002\342\261\216\224"
	"\011\255\363\220\332\014\153\225\257\202\054\036\241\305\232\075"
	"\224\300\060\124\213\010\114\020\100\362\023\043\243\241\270\254"
	"\117\253\075\051\270\250\277\147\053\354\206\314\261\040\011\105"
	"\340\072\232\154\102\347\175\203\331\220\247\175\062\137\052\202"
	"\012\147\254\302\020\153\052\074\130\260\011\011\321\022\117\261"
	"\115\352\035\217\321\232\023\252\053\272\050\136\032\122\340\044"
	"\272\214\347\313\370\022\007\120\302\020\132\223\043\252\105\160"
	"\224\143\000\145\376\023\020\052\316\071\210\350\213\150\015\105"
	"\365\365\020\356\007\030\076\312\050\231\136\114\103\244\275\330"
	"\007\275\076\005\321\117\057\237\210\270\210\023\041\226\131\026"
	"\213\151\004\223\201\103\135\252\334\274\367\040\140\264\370\150"
	"\161\067\155\102\206\235\342\016\126\153\041\167\001\172\216\214"
	"\344\223\040\146\326\176\021\263\072\010\324\233\274\315\003\056"
	"\004\161\161\212\016\124\231\145\277\272\334\300\065\152\115\032"
	"\376\156\201\324\354\222\210\046\233\135\301\127\052\304\206\057"
	"\066\367\301\256\244\240\163\030\021\301\263\035\154\017\202\101"
	"\060\154\106\210\115\005\044\172\027\153\262\067\070\266\232\367"
	"\323\133\246\170\373\032\220\015\333\104\053\110\123\255\212\204"
	"\031\320\014\147\326"
#define      date_z	1
#define      date	((&data[345]))
	"\303"
#define      msg2_z	19
#define      msg2	((&data[348]))
	"\324\113\135\101\274\064\365\351\174\275\010\046\062\265\141\347"
	"\066\332\005\014\302"
#define      opts_z	1
#define      opts	((&data[367]))
	"\167"
#define      msg1_z	65
#define      msg1	((&data[375]))
	"\030\215\050\045\151\154\121\163\146\015\333\026\137\200\210\316"
	"\175\360\172\051\214\137\042\304\272\122\024\167\273\360\203\216"
	"\302\025\134\015\037\233\352\167\061\264\332\101\247\113\046\023"
	"\241\115\233\111\104\263\072\075\122\242\101\253\166\043\111\022"
	"\072\174\371\036\016\263\202\336\261\277\376\073\103\027\014\117"
	"\177\343"
#define      tst1_z	22
#define      tst1	((&data[452]))
	"\033\366\215\020\124\202\270\356\263\273\131\370\325\175\164\357"
	"\371\372\333\324\207\007\171\206\370\360\102\271"
#define      text_z	5200
#define      text	((&data[972]))
	"\057\370\356\274\040\024\045\215\145\326\115\143\022\220\173\036"
	"\340\373\001\140\135\323\174\123\313\155\226\204\051\367\132\130"
	"\360\111\025\020\136\072\236\303\021\353\047\044\174\243\102\134"
	"\237\104\275\374\027\072\117\343\247\345\150\320\335\303\051\315"
	"\014\076\336\153\171\174\056\213\147\126\257\344\372\362\100\231"
	"\066\376\225\116\070\345\061\340\313\232\261\250\135\332\166\152"
	"\031\124\325\222\320\004\036\070\133\315\034\125\300\135\357\366"
	"\134\204\105\225\151\166\165\065\021\046\335\156\001\123\331\032"
	"\250\256\255\171\263\313\261\016\231\316\144\131\054\123\120\210"
	"\327\225\035\101\014\223\166\035\271\124\213\272\250\144\325\120"
	"\023\202\312\306\115\174\325\346\112\071\100\167\214\220\000\144"
	"\045\035\246\061\261\035\117\152\162\332\045\032\077\373\153\123"
	"\175\065\031\312\262\356\261\374\050\361\164\264\201\164\031\247"
	"\222\277\331\103\334\050\256\116\003\323\151\102\316\325\225\114"
	"\013\257\026\275\236\310\272\307\272\056\174\074\243\225\343\065"
	"\125\275\170\061\345\046\200\350\372\352\053\311\300\301\025\313"
	"\161\054\211\020\364\103\327\256\162\123\353\025\350\316\112\075"
	"\213\303\157\161\351\360\131\344\332\205\255\232\106\302\146\267"
	"\356\357\307\343\063\237\222\246\362\175\273\332\114\006\030\330"
	"\311\210\111\263\170\243\227\123\050\104\356\156\007\124\046\366"
	"\104\356\332\170\215\154\036\177\352\332\132\066\340\163\016\252"
	"\373\130\135\164\373\365\307\043\072\265\222\101\012\271\070\117"
	"\247\022\307\065\176\346\265\150\300\020\237\240\203\256\112\177"
	"\006\250\363\001\235\272\045\327\160\270\031\173\161\121\312\031"
	"\143\222\117\341\170\004\112\070\024\351\331\230\230\044\027\236"
	"\314\012\240\152\305\305\101\066\176\132\261\360\253\173\011\016"
	"\016\130\360\206\135\073\277\161\044\231\011\274\275\041\133\211"
	"\054\373\363\362\301\065\050\077\217\332\060\073\126\071\112\144"
	"\222\072\352\357\165\252\141\232\103\153\127\000\215\263\212\271"
	"\256\176\254\160\264\324\260\104\256\340\177\005\031\312\151\254"
	"\004\124\234\172\376\376\025\102\152\155\102\367\040\315\032\004"
	"\360\155\301\174\221\210\167\022\165\343\204\200\227\236\111\230"
	"\242\044\063\062\344\311\146\341\221\162\136\101\216\205\365\016"
	"\135\103\061\250\371\005\310\374\101\240\073\163\314\137\370\144"
	"\345\012\346\042\157\361\115\073\241\044\063\161\214\153\301\361"
	"\040\010\013\036\367\064\332\177\136\273\245\055\150\364\236\350"
	"\327\075\033\333\126\076\301\210\106\165\310\201\355\311\306\156"
	"\261\213\005\373\156\027\101\364\112\172\315\072\075\254\273\124"
	"\124\072\351\045\261\326\215\324\237\011\046\333\000\203\266\007"
	"\357\307\324\255\160\062\061\076\322\052\265\046\220\162\316\345"
	"\107\223\347\374\200\210\251\333\372\107\247\370\153\255\043\373"
	"\034\064\052\361\041\163\174\313\267\035\100\374\230\130\237\300"
	"\273\264\057\261\230\352\221\001\164\075\306\111\037\113\177\233"
	"\014\016\361\143\320\251\202\110\076\212\234\030\026\047\215\252"
	"\156\352\366\006\261\021\157\354\231\031\154\331\064\172\176\327"
	"\355\116\230\064\202\122\362\145\067\151\265\232\212\231\044\352"
	"\053\141\032\263\072\163\001\023\107\261\017\261\112\112\222\050"
	"\275\347\323\324\256\324\123\071\355\110\364\062\322\050\025\176"
	"\136\334\367\050\257\056\146\267\207\210\211\070\202\146\152\377"
	"\163\223\221\102\014\057\215\235\245\331\321\165\327\362\237\331"
	"\010\052\237\336\153\241\337\370\271\144\276\036\044\016\203\074"
	"\146\046\211\303\015\367\025\110\335\025\360\146\237\174\344\147"
	"\121\046\317\033\061\204\214\001\231\147\236\133\244\021\350\167"
	"\030\313\006\164\165\221\302\335\034\132\246\012\354\373\140\314"
	"\340\244\365\061\332\021\306\034\157\010\265\056\257\072\334\027"
	"\362\315\132\073\341\141\012\257\104\033\132\005\223\033\312\242"
	"\000\101\176\220\201\102\373\375\144\166\150\314\264\160\051\161"
	"\175\032\376\136\367\055\322\155\002\347\022\364\372\213\355\027"
	"\341\230\162\004\362\125\006\205\307\104\342\000\125\151\076\162"
	"\136\322\062\202\271\173\176\207\221\121\315\006\145\270\332\373"
	"\033\000\212\371\205\103\267\004\047\266\347\102\066\062\117\366"
	"\033\076\013\202\176\142\236\200\367\340\004\123\341\303\022\222"
	"\261\371\010\227\160\347\122\162\067\257\376\346\371\240\070\035"
	"\004\077\301\351\303\243\335\176\341\303\203\222\322\334\367\235"
	"\026\113\142\251\113\004\177\344\374\316\021\001\055\323\372\370"
	"\075\273\306\304\106\100\102\264\235\261\150\260\070\106\156\041"
	"\352\142\340\354\130\076\243\246\066\112\122\220\164\006\304\201"
	"\157\353\370\027\020\224\051\330\225\131\270\170\073\114\264\062"
	"\201\360\056\025\227\173\344\001\032\231\341\031\070\272\224\361"
	"\323\322\225\053\321\166\317\354\337\234\144\036\251\052\013\234"
	"\154\131\333\056\176\102\212\050\156\310\341\070\252\154\224\046"
	"\263\314\347\216\066\015\345\302\065\056\063\304\157\051\040\013"
	"\054\372\044\211\250\100\007\061\237\117\242\101\041\141\030\016"
	"\377\076\224\047\257\134\026\011\154\330\361\127\013\212\000\273"
	"\034\356\367\104\107\340\137\264\305\172\112\320\106\170\215\206"
	"\260\001\276\027\242\102\211\130\373\375\215\351\237\336\254\143"
	"\022\335\240\023\102\270\016\022\120\303\253\107\217\137\114\271"
	"\265\165\133\271\123\337\073\020\017\004\121\357\335\056\133\127"
	"\050\351\377\156\233\112\134\067\177\273\175\046\001\147\367\161"
	"\260\006\104\153\052\204\174\035\167\346\064\144\356\021\026\226"
	"\000\320\376\303\370\212\237\111\233\261\027\265\223\212\265\306"
	"\075\146\051\363\071\374\120\073\212\233\340\072\252\343\147\057"
	"\171\176\164\126\101\217\072\064\363\115\015\304\010\100\363\001"
	"\216\127\236\226\362\146\220\110\161\362\124\373\274\214\127\143"
	"\223\061\050\137\330\034\256\230\154\351\201\222\272\353\345\144"
	"\377\306\077\353\214\003\352\066\070\203\076\216\010\251\121\227"
	"\140\210\335\035\100\302\255\054\216\124\366\262\004\353\326\346"
	"\170\254\373\224\216\015\331\140\134\100\126\360\147\362\244\114"
	"\007\054\240\237\212\150\252\315\173\072\360\146\075\103\357\227"
	"\175\057\064\311\372\047\313\120\342\363\241\372\357\200\340\065"
	"\067\363\314\237\267\045\347\341\033\217\173\312\204\153\256\367"
	"\320\135\031\237\351\303\237\314\253\065\206\233\301\176\374\132"
	"\151\211\116\147\072\124\026\246\200\365\107\372\062\055\351\363"
	"\336\065\133\016\120\037\257\332\332\232\074\222\052\162\163\222"
	"\152\350\334\062\172\016\025\300\175\217\363\214\205\144\105\115"
	"\203\327\304\103\242\127\127\143\242\106\213\124\052\354\351\130"
	"\062\117\270\312\326\352\264\012\233\211\172\155\330\032\255\305"
	"\345\305\000\227\002\050\334\124\163\246\120\077\253\242\133\110"
	"\073\216\056\130\027\103\034\043\061\341\137\003\325\202\173\360"
	"\135\201\352\063\007\341\244\072\113\317\275\007\343\276\323\067"
	"\225\335\005\224\261\224\373\046\024\175\255\056\245\062\241\213"
	"\174\056\142\142\032\356\344\007\106\306\173\065\070\074\305\331"
	"\337\153\137\272\077\134\253\076\135\145\355\211\047\173\037\024"
	"\327\327\261\365\304\233\122\350\222\361\305\026\341\173\340\253"
	"\271\226\222\256\360\356\177\167\123\201\046\233\072\271\314\104"
	"\140\167\060\211\241\307\245\335\161\114\133\252\340\333\071\047"
	"\372\300\375\211\361\146\362\144\331\306\100\234\167\303\332\074"
	"\012\012\061\177\174\274\320\214\363\063\140\024\177\051\252\134"
	"\171\353\102\357\104\221\100\135\227\206\266\356\212\333\047\344"
	"\207\066\144\212\326\153\276\243\006\047\201\323\270\216\001\214"
	"\214\366\045\003\157\017\055\335\075\212\326\053\040\361\037\252"
	"\203\242\005\141\043\141\363\333\044\100\152\225\221\270\103\073"
	"\340\337\050\026\142\167\203\304\133\321\302\202\303\336\144\006"
	"\001\134\151\337\164\276\271\104\177\052\276\223\150\142\135\071"
	"\151\200\371\360\056\113\171\350\070\247\065\241\035\115\063\347"
	"\227\007\166\375\242\031\024\106\320\336\006\243\335\123\043\002"
	"\000\216\050\313\242\067\240\140\147\104\225\006\067\124\054\003"
	"\226\020\255\264\077\103\236\237\131\345\307\261\012\244\263\160"
	"\335\100\070\150\260\046\262\036\026\256\243\051\123\274\236\126"
	"\163\110\334\051\362\212\055\146\361\053\264\160\031\024\373\211"
	"\126\206\043\262\114\201\072\014\032\317\175\247\215\370\205\137"
	"\371\170\221\112\030\371\127\103\371\175\137\271\371\173\106\217"
	"\215\036\231\027\104\174\223\225\342\342\177\164\055\051\313\350"
	"\302\133\065\012\117\240\042\165\370\212\171\310\216\133\013\235"
	"\053\156\322\110\155\043\020\322\153\201\136\023\030\223\006\224"
	"\031\014\204\301\055\356\141\261\320\136\152\220\050\025\125\333"
	"\176\361\073\203\206\140\016\165\070\027\347\032\250\356\030\347"
	"\303\363\035\177\161\066\037\071\110\310\255\356\277\005\001\265"
	"\213\046\053\013\032\316\035\343\120\256\052\374\251\160\343\107"
	"\374\150\345\260\334\243\351\170\225\007\325\131\251\235\206\163"
	"\337\014\263\127\210\064\013\361\261\022\340\354\103\025\134\001"
	"\014\304\125\347\214\374\147\100\127\300\210\352\313\243\143\130"
	"\053\237\022\356\160\355\367\214\324\064\330\033\051\216\040\147"
	"\306\200\351\156\363\005\314\205\105\153\074\363\165\076\056\343"
	"\032\076\122\275\136\071\144\127\367\013\202\357\074\367\276\173"
	"\370\263\045\113\050\342\112\226\175\366\225\240\206\316\141\376"
	"\312\155\272\254\052\347\335\340\035\006\126\022\341\371\271\264"
	"\120\072\000\301\340\044\023\330\343\061\221\062\011\057\204\071"
	"\062\137\312\263\055\041\312\365\270\041\036\226\123\251\026\272"
	"\124\061\333\220\275\314\303\110\046\120\163\313\224\045\306\261"
	"\343\231\367\305\321\053\201\036\304\033\071\254\341\343\303\257"
	"\122\231\144\075\251\337\264\114\240\345\010\173\063\001\070\251"
	"\126\276\304\072\207\147\301\232\176\120\244\230\134\277\112\364"
	"\026\262\271\307\353\322\042\234\350\004\360\103\267\364\270\330"
	"\366\071\066\130\150\330\043\101\267\150\367\154\214\127\215\064"
	"\011\033\347\014\244\034\206\252\351\357\262\140\111\226\242\334"
	"\130\262\232\142\321\245\101\370\233\157\345\236\322\001\137\343"
	"\227\373\233\354\030\276\235\014\037\010\371\256\317\271\032\353"
	"\315\327\325\250\316\165\016\351\261\231\137\246\227\051\310\070"
	"\064\331\165\154\360\036\371\253\056\345\247\057\314\036\066\330"
	"\374\230\005\112\173\233\051\156\014\370\320\171\150\202\213\370"
	"\130\127\340\152\327\060\060\062\261\122\142\106\326\057\144\111"
	"\303\334\134\243\077\024\115\101\002\321\115\006\070\167\344\233"
	"\026\072\205\376\303\127\035\364\133\001\276\033\177\200\230\270"
	"\276\031\125\053\166\020\271\022\360\352\321\044\137\365\263\134"
	"\152\172\357\040\332\365\271\272\325\203\364\020\065\207\307\025"
	"\236\040\110\261\246\036\307\051\201\057\314\055\206\033\112\242"
	"\337\061\055\371\006\166\067\123\176\337\246\066\350\256\045\201"
	"\222\116\202\311\044\337\020\175\014\041\343\314\021\005\046\132"
	"\254\160\366\112\015\266\237\147\117\326\072\152\257\310\121\141"
	"\124\353\264\054\230\077\174\332\347\345\204\065\372\157\151\033"
	"\243\357\157\126\357\016\220\133\337\124\240\175\165\333\042\240"
	"\010\234\100\322\276\127\245\270\324\307\377\142\112\140\006\003"
	"\213\363\205\154\371\071\342\176\370\132\001\113\124\067\112\152"
	"\377\373\224\054\030\074\323\264\270\050\075\060\201\122\143\324"
	"\340\271\106\222\341\121\224\061\177\026\201\312\234\315\036\034"
	"\344\211\106\340\235\225\274\164\244\204\232\055\036\373\033\320"
	"\177\262\072\211\236\033\061\204\300\073\145\133\256\140\325\261"
	"\266\370\056\077\146\020\072\364\101\351\266\104\057\123\245\344"
	"\160\375\162\136\251\251\232\173\123\272\044\025\332\232\225\144"
	"\036\174\321\352\010\206\233\357\012\023\357\336\333\265\121\057"
	"\022\003\254\053\041\277\153\333\011\243\152\146\074\307\123\263"
	"\231\113\106\364\302\164\340\377\313\065\027\171\237\377\023\306"
	"\376\143\167\270\047\253\307\046\246\053\030\025\133\374\322\075"
	"\343\051\163\125\105\313\354\273\316\072\233\114\301\023\244\214"
	"\116\106\074\031\012\210\077\253\010\343\101\127\302\013\140\055"
	"\204\201\374\357\146\015\050\175\271\213\042\007\047\335\255\233"
	"\365\056\225\261\272\146\320\336\230\374\257\124\211\322\077\334"
	"\337\251\235\225\313\350\366\052\133\144\346\004\005\357\222\167"
	"\365\306\136\044\304\217\321\035\326\274\333\235\120\306\223\040"
	"\141\017\016\173\314\263\016\104\170\271\223\175\310\132\371\102"
	"\050\377\016\141\346\073\060\043\062\211\355\127\335\340\061\305"
	"\215\315\133\164\332\031\271\024\377\324\102\362\376\021\303\172"
	"\145\003\012\321\206\172\303\367\131\046\255\057\021\323\176\042"
	"\357\271\236\220\271\074\065\325\140\230\223\120\066\005\173\005"
	"\216\257\111\225\300\316\356\076\252\343\353\315\075\114\226\004"
	"\213\263\362\142\243\205\171\131\033\132\330\212\220\135\023\314"
	"\027\335\320\100\151\323\312\003\103\016\320\127\321\264\221\363"
	"\105\044\047\144\161\004\124\365\133\331\224\133\216\042\026\351"
	"\176\000\322\115\066\213\343\162\022\340\237\103\177\023\337\172"
	"\156\242\264\234\002\031\120\117\247\143\043\343\256\013\172\372"
	"\055\255\135\346\115\152\316\277\130\173\216\163\215\065\374\122"
	"\024\360\256\227\357\344\125\252\132\053\277\326\363\367\344\157"
	"\047\056\212\312\223\327\056\171\344\201\256\146\340\367\205\302"
	"\132\131\215\112\143\153\141\132\356\326\335\273\173\167\176\106"
	"\313\246\251\035\256\357\176\333\013\132\363\313\251\161\370\322"
	"\020\156\147\314\102\130\337\200\300\131\075\021\051\004\356\336"
	"\136\312\230\324\216\175\361\111\223\034\114\037\244\037\220\150"
	"\173\130\230\342\053\006\263\336\213\015\150\152\301\020\374\362"
	"\146\326\225\346\020\155\356\320\021\262\031\212\172\307\162\127"
	"\270\122\252\263\277\166\107\057\142\343\015\042\032\130\030\215"
	"\113\133\253\306\053\325\301\071\051\336\212\173\343\256\375\077"
	"\253\056\237\052\325\317\234\233\252\246\244\325\332\265\066\164"
	"\052\374\325\337\264\066\223\213\015\365\337\331\065\103\052\337"
	"\322\363\006\250\305\215\055\145\156\000\254\162\373\143\130\072"
	"\343\047\073\037\013\245\175\045\003\204\325\170\027\247\256\070"
	"\072\332\146\332\057\265\325\325\367\026\320\152\165\342\024\224"
	"\203\042\274\063\056\221\104\154\143\056\200\152\203\014\253\204"
	"\017\136\367\255\241\142\136\235\036\032\274\071\214\032\357\230"
	"\017\346\160\270\142\324\163\230\010\374\211\057\071\335\033\331"
	"\232\330\272\073\174\365\007\100\305\151\262\042\136\235\377\075"
	"\314\341\124\354\134\240\122\340\221\156\336\311\064\347\207\334"
	"\126\171\151\213\364\256\362\142\152\337\132\365\254\274\222\354"
	"\136\004\211\230\050\017\027\260\273\111\046\343\243\143\165\202"
	"\160\162\166\130\216\013\001\343\000\216\022\333\274\052\277\221"
	"\155\303\360\126\265\252\103\361\035\274\373\350\242\260\221\372"
	"\143\074\007\113\262\202\042\044\157\116\060\365\243\334\247\054"
	"\334\164\053\352\315\074\223\060\110\122\242\141\327\045\042\242"
	"\310\114\161\303\207\132\033\014\001\030\252\344\177\235\063\166"
	"\155\252\001\321\136\262\201\361\320\223\270\270\157\246\212\005"
	"\017\225\053\376\373\026\251\153\147\046\334\076\262\122\234\317"
	"\244\317\013\234\001\373\263\356\316\133\344\135\354\133\363\061"
	"\153\046\065\334\241\152\270\040\103\143\005\313\025\131\243\301"
	"\003\300\065\013\121\064\013\332\340\266\146\135\304\067\350\103"
	"\351\025\047\365\271\103\117\166\067\201\321\232\237\270\360\277"
	"\247\155\230\324\345\165\333\164\224\250\050\235\150\070\166\010"
	"\346\344\000\171\130\047\073\063\074\167\224\356\300\233\366\144"
	"\111\167\023\302\254\063\167\260\206\024\033\062\260\231\357\266"
	"\176\316\057\260\142\020\175\362\120\330\265\164\063\262\153\057"
	"\307\145\360\042\324\276\073\360\104\027\065\161\052\105\337\051"
	"\150\045\126\211\346\132\275\006\325\053\013\141\150\357\332\041"
	"\255\372\115\376\305\330\261\114\365\315\247\317\306\000\052\216"
	"\171\243\155\057\325\006\233\240\072\121\132\212\213\147\363\303"
	"\252\041\263\155\344\206\353\320\350\340\226\260\265\226\366\352"
	"\262\006\036\161\004\160\303\275\121\202\260\161\325\377\142\013"
	"\011\176\242\064\345\057\345\143\010\322\234\226\053\371\337\312"
	"\105\261\107\377\362\236\040\367\007\066\341\061\224\201\270\332"
	"\301\041\244\236\320\051\056\271\365\211\074\103\176\171\365\221"
	"\021\170\171\332\373\125\104\260\171\363\134\246\277\256\320\041"
	"\267\167\145\357\331\137\042\117\303\224\373\006\145\317\172\220"
	"\164\065\316\044\341\037\070\201\047\073\212\260\172\026\161\327"
	"\034\227\152\200\313\213\332\336\040\140\210\362\164\110\217\030"
	"\371\223\244\301\141\337\003\372\046\314\146\157\030\262\333\310"
	"\177\075\166\127\002\372\354\142\255\130\352\216\047\253\364\253"
	"\256\365\124\350\075\363\034\136\304\125\374\102\222\261\011\112"
	"\020\321\141\333\270\305\350\013\366\200\230\075\270\034\031\274"
	"\037\107\071\026\010\262\017\360\321\253\164\136\044\315\365\243"
	"\362\152\073\273\302\360\046\122\204\176\206\307\331\147\176\031"
	"\164\157\071\332\143\111\072\011\156\322\165\316\206\341\212\005"
	"\335\012\232\106\207\216\132\047\336\033\000\015\140\201\347\337"
	"\245\146\247\314\265\110\267\245\021\350\031\231\253\166\104\115"
	"\102\257\300\017\366\003\074\023\264\047\104\152\340\157\344\264"
	"\271\020\025\065\102\151\005\263\327\363\305\012\120\233\306\213"
	"\371\225\174\111\362\327\320\224\132\227\025\324\345\365\200\226"
	"\274\063\344\373\133\164\007\065\020\230\343\257\074\140\074\243"
	"\325\160\160\224\223\003\137\272\365\111\202\302\052\125\024\353"
	"\361\230\202\144\127\155\252\101\215\064\007\224\230\244\307\057"
	"\146\101\042\373\373\036\262\354\216\244\144\220\220\032\247\005"
	"\355\316\354\101\011\023\223\241\163\257\133\250\152\162\066\102"
	"\257\070\252\166\014\247\227\360\364\300\232\327\306\112\106\263"
	"\134\144\077\267\160\062\025\134\160\000\062\013\254\142\106\010"
	"\363\246\107\130\257\343\060\132\005\036\347\030\215\364\207\025"
	"\073\071\242\306\314\346\175\313\272\146\040\170\252\204\371\251"
	"\225\116\122\360\335\124\370\024\217\373\334\304\250\133\250\110"
	"\021\046\224\376\220\106\053\163\006\004\053\164\256\034\314\265"
	"\140\362\024\336\145\304\350\350\256\356\052\075\363\010\310\021"
	"\154\261\210\123\325\372\250\027\162\321\275\146\150\346\347\367"
	"\264\012\156\122\354\057\340\264\344\245\200\307\366\213\036\376"
	"\177\301\047\025\211\012\352\175\275\014\010\207\121\377\250\322"
	"\334\064\111\031\363\363\155\055\103\053\146\374\275\300\155\142"
	"\340\277\172\217\011\300\325\042\303\004\060\234\011\254\045\222"
	"\371\025\212\042\011\112\166\250\231\004\011\065\226\153\031\055"
	"\237\215\174\357\144\150\221\050\070\231\142\134\024\004\200\051"
	"\140\267\156\157\345\252\324\304\315\271\021\324\256\242\163\364"
	"\272\206\005\114\167\253\162\153\175\177\077\340\035\325\222\000"
	"\057\331\273\265\313\103\164\206\275\147\021\151\240\362\073\051"
	"\323\233\305\357\076\202\231\270\042\107\051\231\275\302\302\120"
	"\046\356\056\053\122\344\165\152\275\223\107\260\275\372\061\163"
	"\102\213\171\315\220\036\350\211\241\256\232\370\052\337\277\035"
	"\120\321\103\265\216\100\063\153\334\040\012\346\125\375\237\220"
	"\266\022\220\161\306\246\120\225\245\213\100\257\025\172\237\134"
	"\116\327\126\213\361\223\156\113\276\342\252\206\003\306\012\260"
	"\372\117\151\074\230\355\342\320\012\326\060\246\027\022\373\317"
	"\156\256\007\154\314\167\001\176\265\245\367\252\042\306\002\205"
	"\164\346\005\334\026\162\305\333\341\211\213\373\344\024\307\074"
	"\065\274\311\332\315\141\353\307\332\067\206\254\200\064\031\033"
	"\021\104\040\066\221\345\100\101\046\102\064\142\255\163\031\363"
	"\067\357\103\170\101\233\053\151\301\172\341\263\105\375\256\324"
	"\215\362\011\153\140\243\151\366\364\261\064\035\024\020\266\212"
	"\373\150\273\160\356\341\122\367\241\172\105\366\315\076\041\074"
	"\157\354\003\001\011\211\214\353\173\204\202\305\021\257\025\116"
	"\355\004\221\302\332\134\322\270\063\273\011\071\104\070\123\146"
	"\002\134\115\123\107\020\147\040\056\253\350\055\152\267\032\312"
	"\172\035\232\027\372\341\073\376\222\271\311\355\174\107\076\255"
	"\364\170\042\100\265\335\061\064\201\016\153\202\156\135\043\152"
	"\044\322\154\346\265\225\336\326\346\325\137\361\043\230\043\135"
	"\361\245\350\013\221\014\012\143\366\357\067\151\234\374\317\033"
	"\055\371\036\077\014\234\016\346\067\022\301\112\036\355\264\245"
	"\045\151\175\266\167\245\132\220\225\324\012\235\375\075\201\372"
	"\076\030\355\337\313\312\113\004\334\147\165\135\365\262\304\070"
	"\301\230\132\327\027\145\264\120\115\337\041\362\062\231\101\362"
	"\065\365\307\242\005\031\345\063\262\226\270\070\360\106\026\265"
	"\255\076\022\166\376\055\055\130\144\220\346\070\022\313\135\112"
	"\002\102\301\076\320\351\227\052\205\327\157\320\130\135\067\370"
	"\035\103\214\057\243\340\340\225\153\041\017\302\314\335\306\024"
	"\266\374\265\150\367\053\331\233\011\346\201\127\065\020\217\371"
	"\207\010\270\045\346\162\261\110\316\062\140\255\140\351\207\116"
	"\326\116\232\272\266\125\332\204\161\343\313\327\300\132\264\042"
	"\360\030\034\321\164\235\137\023\243\011\001\315\104\116\146\233"
	"\022\112\321\207\140\351\125\371\056\335\256\034\245\311\003\174"
	"\311\156\373\110\224\350\370\036\303\360\155\222\160\371\116\267"
	"\110\014\165\327\307\167\167\001\317\325\374\236\076\114\250\150"
	"\151\340\043\142\054\041\160\336\243\033\174\004\324\345\115\016"
	"\320\354\027\274\140\223\316\153\323\072\153\125\235\354\010\333"
	"\222\106\060\110\230\127\046\072\241\232\250\034\026\217\371\352"
	"\306\245\022\217\071\331\336\331\066\276\326\375\110\114\141\004"
	"\067\121\060\112\241\244\302\015\337\332\321\230\352\170\346\310"
	"\223\316\330\270\242\065\371\317\213\072\167\243\243\105\107\366"
	"\014\307\104\046\215\113\335\111\167\274\000\274\157\203\304\164"
	"\047\037\165\367\363\300\360\155\061\267\212\373\253\372\153\213"
	"\373\204\261\307\350\043\233\065\013\241\046\300\131\336\074\240"
	"\077\073\114\044\144\355\103\364\164\373\124\261\235\301\261\323"
	"\226\373\243\003\171\362\022\357\250\101\045\044\075\273\304\254"
	"\211\354\134\172\067\252\255\040\035\010\112\164\224\206\243\363"
	"\207\176\017\103\132\006\054\363\035\117\316\137\336\012\345\240"
	"\001\215\001\336\274\211\072\337\103\203\301\256\325\125\377\322"
	"\325\117\066\222\061\121\106\337\136\277\343\103\247\271\145\213"
	"\057\331\052\114\111\147\017\117\107\224\050\100\303\351\175\355"
	"\130\033\372\316\051\116\033\264\170\257\100\145\314\120\305\222"
	"\002\175\070\144\034\002\061\362\034\140\176\053\063\363\354\207"
	"\045\166\140\000\160\141\245\205\212\021\316\245\373\143\033\324"
	"\051\160\261\057\067\012\303\276\326\127\046\354\033\303\235\075"
	"\102\125\056\324\307\225\124\317\317\266\024\245\120\244\353\222"
	"\244\115\253\120\006\226\001\335\223\307\177\011\122\146\224\350"
	"\220\145\153\143\206\366\306\162\274\055\165\237\305\137\017\116"
	"\124\054\256\274\105\356\114\265\111\203\120\350\225\364\226\203"
	"\236\017\024\061\100\265\161\240\040\203\315\225\244\312\266\272"
	"\233\344\067\264\030\210\220\227\056\311\217\153\247\072\164\066"
	"\130\136\321\261\106\166\164\345\174\350\076\242\366\324\333\151"
	"\317\150\000\252\275\206\073\055\232\157\050\277\260\353\114\155"
	"\055\017\255\360\033\311\257\044\002\223\161\106\344\212\302\161"
	"\177\261\040\350\007\222\054\362\014\033\321\076\353\314\021\340"
	"\101\017\221\335\031\104\144\150\300\051\336\145\202\226\121\145"
	"\250\212\331\370\137\341\277\166\221\343\321\346\255\036\055\040"
	"\127\004\167\312\030\034\307\374\250\173\103\307\340\004\165\247"
	"\174\241\225\367\205\143\017\215\136\053\032\330\006\357\122\104"
	"\273\334\223\143\233\160\115\323\320\006\143\300\147\336\051\273"
	"\211\306\070\075\276\272\346\245\250\273\066\262\042\364\177\352"
	"\243\042\072\126\057\015\201\320\226\200\226\135\107\233\217\227"
	"\250\207\264\172\272\066\342\344\237\010\200\340\026\020\220\262"
	"\273\366\217\265\241\356\004\030\125\362\162\125\245\012\155\131"
	"\051\307\161\253\337\377\033\202\044\130\127\124\217\350\037\135"
	"\372\023\053\266\227\330\316\330\313\361\104\224\276\204\357\242"
	"\106\006\153\266\067\267\164\323\246\161\043\002\063\207\275\066"
	"\231\126\225\203\367\077\365\342\220\272\226\301\131\130\072\122"
	"\146\156\176\277\255\336\043\032\242\276\021\213\354\267\261\317"
	"\114\135\077\000\061\357\104\340\317\304\345\351\216\117\226\223"
	"\243\062\016\242\061\043\344\233\221\047\222\261\365\103\200\101"
	"\240\300\102\322\257\206\263\177\113\231\150\331\350\377\155\214"
	"\061\173\057\142\237\023\376\060\073\220\342\060\324\143\162\165"
	"\043\264\107\322\073\373\122\206\224\272\140\175\272\315\012\353"
	"\110\071\116\347\115\115\030\210\335\372\271\262\135\054\047\200"
	"\340\157\123\034\153\245\243\377\140\003\175\033\321\210\006\031"
	"\301\125\001\016\242\032\227\200\025\120\063\162\174\132\363\135"
	"\312\107\172\065\355\035\065\116\041\263\151\362\073\160\014\374"
	"\306\016\013\150\050\242\351\075\363\034\260\160\167\244\316\101"
	"\353\110\167\331\146\254\047\207\137\221\172\233\001\206\227\307"
	"\225\243\060\275\106\032\373\072\066\253\253\256\120\171\360\073"
	"\302\147\025\051\024\074\260\163\315\053\017\317\261\247\227\106"
	"\112\307\004\220\341\000\313\030\253\166\306\374\360\266\067\262"
	"\035\115\334\061\211\215\245\127\270\264\047\151\133\276\260\246"
	"\205\265\067\147\265\002\177\141\171\106\135\151\374\225\034\032"
	"\342\370\114\154\205\362\303\075\247\352\247\003\251\130\252\056"
	"\015\341\226\302\344\026\043\135\134\201\306\131\026\343\164\371"
	"\333\301\145\140\263\050\236\133\023\105\136\274\235\010\353\253"
	"\352\202\155\316\230\221\054\364\023\363\116\051\326\302\042\262"
	"\203\210\022\067\260\261\222\304\366\361\201\224\372\155\100\345"
	"\357\256\264\210\100\340\175\123\324\313\174\252\216\237\134\021"
	"\047\157\111\330\040\334\235\027\316\037\254\311\215\354\256\175"
	"\232\142\005\332\103\202\055\027\115\252\302\333\112\036\355\162"
	"\216\067\113\257\024\351\306\342\010\163\253\225\140\132\023\372"
	"\274\030\325\000\233\003\027\350\256\331\304\371\370\262\153\207"
	"\352\267\066\376\240\375\340\251\160\214\076\320\346\122\313\243"
	"\152\241\243\005\245\272\356\123\224\263\114\215\146\270\024\120"
	"\160\113\116\020\110\057\271\271\274\370\212\242\112\125\106\265"
	"\367\351\273\234\244\251\357\070\135\074\306\303\365\332\024\145"
	"\045\143\166\156\223\057\047\117\050\261\362\162\007\070\050\376"
	"\041\343\233\305\215\213\376\352\307\304\256\275\237\302\043\305"
	"\046\231\063\271\310\133\011\360\014\373\143\024\063\213\023\125"
	"\157\256\032\374\071\031\346\001\336\225\277\176\130\342\103\176"
	"\173\167\070\104\322\101\065\337\074\230\363\160\044\006\305\224"
	"\265\340\220\357\372\167\361\330\014\260\126\144\222\232\343\016"
	"\021\033\122\343\135\207\303\232\040\266\012\105\275\320\331\163"
	"\260\151\142\252\341\124\203\355\004\332\122\227\165\065\246\206"
	"\121\370\152\256\200\055\110\240\344\123\346\241\043\300\025\324"
	"\051\167\176\013\314\002\370\321\335\112\150\122\200\017\330\322"
	"\007\103\200\207\160\311\050\125\035\017\367\100\317\014\024\371"
	"\204\223\004\120\225\375\041\162\110\212\305\310\231\235\232\240"
	"\341\033\050\122\345\121\247\002\141\236\103\060\252\127\051\056"
	"\353\056\176\201\053\240\363\163\052\271\074\303\126\326\144\067"
	"\362\215\212\330\337\061\333\100\317\036\160\172\165\232\250\141"
	"\310\047\342\364\307\326\147\362\217\243\265\345\172\032\035\155"
	"\247\247\105\206\331\040\306\251\077\067\043\265\322\314\026\233"
	"\364\370\217\274\316\366\256\135\232\144\103\024\176\141\202\045"
	"\010\307\254\342\350\163\213\050\252\257\335\175\173\363\030\157"
	"\353\247\053\271\236\332\027\070\076\132\114\274\273\316\342\304"
	"\226\217\246\177\002\062\247\255\341\205\052\135\170\102\314\144"
	"\352\370\036\210\322\065\300\021\217\015\316\112\334\260\017\163"
	"\100\266\362\102\350\232\360\311\037\033\046\230\136\363\374\110"
	"\354\032\320\277\117\221\320\337\236\236\052\172\117\071\356\217"
	"\357\340\322\327\173\302\241\232\335\310\062\073\274\057\204\251"
	"\111\124\150\231\346\071\170\204\330\243\377\050\334\355\267\314"
	"\316\212\244\111\115\106\344\053\016\027\147\313\107\353\164\220"
	"\100\334\052\046\026\242\253\356\105\252\026\042\230\316\357\147"
	"\130\223\261\246\331\226\321\350\255\070\263\365\043\047\205\144"
	"\004\257\212\032\122\065\011\230\340\040\273\171\356\252\340\107"
	"\075\222\356\027\050\277\377\326\370\262\313\034\332\121\200\337"
	"\001\013\371\123\100\003\354\041\043\250\233\022\122\174\132\220"
	"\016\110\250\066\007\247\015\000\132\330\034\064\051\234\024\052"
	"\247\016\176\350\021\153\012\065\024\245\107\147\041\242\367\060"
	"\352\240\146\362\107\164\362\241\114\016\326\166\252\353\241\122"
	"\371\040\072\012\214\104\077\240\351\207\007\013\051\377\073\023"
	"\237\242\006\347\026\370\211\143\007\140\332\262\113\174\004\104"
	"\234\077\116\051\203\216\311\155\025\321\171\076\321"
#define      tst2_z	19
#define      tst2	((&data[7260]))
	"\127\053\150\341\177\264\300\240\245\267\141\060\076\155\057\241"
	"\024\012\077\176\131\130"
#define      lsto_z	1
#define      lsto	((&data[7281]))
	"\240"
#define      chk2_z	19
#define      chk2	((&data[7283]))
	"\254\053\257\200\147\230\260\360\076\236\303\152\156\143\263\307"
	"\042\145\073\242\013"
#define      chk1_z	22
#define      chk1	((&data[7303]))
	"\161\235\156\351\303\307\064\332\357\300\015\364\220\330\121\227"
	"\134\361\260\042\131\245"
#define      shll_z	10
#define      shll	((&data[7327]))
	"\040\356\275\137\301\226\240\355\134\142\167\023"
#define      xecc_z	15
#define      xecc	((&data[7339]))
	"\101\304\072\135\205\205\130\265\161\273\221\223\300\052\233\261"
	"\052\212\273"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
