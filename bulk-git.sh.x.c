#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f bulk-git.sh -o bulk-git 
#endif

static  char data [] = 
#define      shll_z	10
#define      shll	((&data[2]))
	"\005\326\013\076\007\074\237\226\100\301\127\334\171\103"
#define      inlo_z	3
#define      inlo	((&data[14]))
	"\225\050\033"
#define      text_z	5158
#define      text	((&data[845]))
	"\273\055\337\265\363\251\031\021\050\211\302\045\237\237\156\076"
	"\112\076\174\060\070\201\006\261\305\114\377\275\050\244\011\343"
	"\321\350\231\305\222\262\326\273\074\231\340\333\070\117\032\202"
	"\215\227\262\306\031\271\170\336\005\167\233\055\033\244\021\355"
	"\215\253\262\040\135\210\334\231\041\275\165\132\014\220\335\232"
	"\050\217\140\101\111\330\037\117\120\273\175\154\140\217\131\356"
	"\072\014\016\227\224\352\061\266\250\247\021\264\070\356\117\140"
	"\176\260\241\307\211\301\026\331\174\224\106\335\043\237\313\135"
	"\254\331\365\100\304\047\367\154\316\011\041\006\367\161\146\165"
	"\041\010\075\252\311\124\203\106\350\312\043\014\152\356\151\026"
	"\310\136\127\215\206\116\372\124\130\034\133\117\215\302\305\256"
	"\312\002\130\224\127\334\333\077\246\377\113\020\355\265\046\266"
	"\024\175\104\232\314\077\357\044\133\112\164\350\014\071\227\327"
	"\074\357\154\223\314\107\323\163\106\037\204\064\325\252\353\351"
	"\050\057\204\365\156\163\032\312\275\217\262\312\311\111\242\005"
	"\071\016\231\005\126\155\170\235\214\374\321\141\247\275\113\320"
	"\355\317\306\134\103\341\046\000\160\330\313\071\042\156\077\133"
	"\175\330\141\323\105\332\160\322\327\102\064\177\000\177\120\355"
	"\117\027\111\222\370\157\223\150\110\137\242\153\315\341\307\112"
	"\272\050\035\377\003\216\322\333\321\006\132\321\205\253\277\325"
	"\302\010\147\272\170\373\043\301\132\306\054\047\247\363\161\141"
	"\034\217\141\037\036\063\373\357\072\126\301\300\001\201\225\303"
	"\212\375\176\002\370\242\304\122\150\360\171\017\343\353\161\000"
	"\172\323\040\231\007\033\210\101\161\112\001\163\314\226\066\126"
	"\223\265\131\213\127\035\336\277\015\130\317\361\103\101\362\276"
	"\024\022\127\033\055\340\135\237\053\136\022\367\365\111\116\210"
	"\376\247\024\126\304\363\026\322\113\345\304\217\046\266\115\073"
	"\310\245\127\366\206\264\226\261\023\250\251\010\362\367\220\361"
	"\237\245\107\144\230\135\066\344\103\373\163\152\262\301\245\172"
	"\146\375\161\355\261\007\236\305\260\110\315\242\100\136\223\337"
	"\003\333\103\234\070\172\200\174\166\364\346\050\265\214\243\034"
	"\211\024\011\073\034\250\000\315\361\315\157\061\053\003\020\057"
	"\336\124\313\027\316\114\223\105\100\172\155\366\006\020\023\217"
	"\045\035\312\101\305\312\017\266\230\176\350\303\202\371\363\141"
	"\115\277\170\034\013\014\141\114\206\316\103\214\337\126\034\004"
	"\163\346\106\071\261\125\360\111\324\330\015\126\321\000\267\037"
	"\277\060\073\313\074\234\030\303\153\133\120\112\261\154\116\045"
	"\122\225\136\004\352\116\115\277\047\133\025\370\134\315\027\034"
	"\375\123\347\072\360\377\375\133\133\115\246\014\271\364\061\014"
	"\212\220\020\165\336\136\064\005\271\111\376\025\026\026\061\024"
	"\151\031\116\131\031\114\265\164\232\133\201\124\120\262\141\332"
	"\103\161\117\041\317\203\047\211\315\045\237\344\073\320\370\245"
	"\352\107\376\003\224\264\167\057\017\370\203\137\253\344\071\356"
	"\126\211\020\045\014\067\257\331\135\116\276\231\037\266\076\011"
	"\376\075\014\223\361\204\302\001\174\105\140\050\052\232\027\200"
	"\043\047\246\060\137\126\011\274\244\310\126\303\176\225\315\175"
	"\322\331\020\304\136\322\305\333\030\046\003\103\300\032\304\343"
	"\102\152\023\241\300\035\136\145\345\264\050\144\111\365\342\034"
	"\317\363\340\055\306\246\011\336\315\014\042\215\047\346\161\151"
	"\121\205\012\021\243\150\167\211\035\237\356\146\225\321\202\145"
	"\304\143\223\212\012\234\151\327\251\213\145\320\162\327\072\303"
	"\134\105\324\000\255\114\212\312\353\170\061\201\020\335\124\055"
	"\023\365\051\340\131\010\060\206\211\100\323\024\321\134\143\255"
	"\346\333\033\044\033\302\030\317\160\015\034\325\334\064\120\200"
	"\030\344\225\253\123\235\046\275\222\337\373\076\156\370\362\031"
	"\130\052\012\017\127\227\113\214\175\236\375\213\362\275\253\171"
	"\130\253\246\304\321\174\167\372\072\202\242\351\337\300\316\227"
	"\255\153\347\324\151\066\237\364\301\140\112\047\377\223\146\274"
	"\323\173\331\067\215\175\327\360\063\317\216\011\167\141\151\265"
	"\324\253\101\305\063\315\265\011\223\001\312\313\226\271\203\100"
	"\131\044\201\256\266\226\317\144\042\033\125\157\272\052\324\066"
	"\055\073\346\274\135\335\265\221\233\100\321\042\252\214\132\051"
	"\234\164\372\321\321\271\272\272\077\376\316\346\043\322\232\233"
	"\176\340\221\103\217\000\311\364\136\024\112\037\112\327\124\215"
	"\053\334\207\217\335\076\271\044\210\000\362\077\067\242\166\276"
	"\025\067\110\033\044\375\056\370\350\161\303\145\072\141\317\024"
	"\141\232\132\231\253\177\007\352\356\006\056\347\364\060\210\205"
	"\155\262\363\241\211\006\334\350\026\170\332\055\103\016\063\215"
	"\136\260\031\013\005\215\010\256\075\174\057\127\356\373\304\224"
	"\036\370\312\011\262\224\275\372\040\055\160\072\165\130\312\065"
	"\345\157\127\351\304\312\232\161\030\235\313\057\011\372\327\232"
	"\112\210\221\051\076\374\145\302\032\346\244\307\263\003\360\255"
	"\300\340\335\117\321\247\070\013\364\176\104\006\351\255\063\141"
	"\142\332\344\103\331\316\125\202\214\013\044\337\014\142\244\272"
	"\064\156\202\020\062\006\063\213\017\102\267\022\174\101\332\260"
	"\013\333\127\136\212\255\053\172\325\053\107\152\037\355\211\075"
	"\211\337\236\051\021\316\361\164\200\062\020\255\102\161\347\374"
	"\335\165\136\132\123\252\005\242\263\131\071\022\133\153\274\052"
	"\374\215\171\053\210\373\011\271\230\106\342\165\037\102\375\145"
	"\050\117\063\352\246\072\130\366\012\161\236\164\311\210\277\243"
	"\007\035\115\236\064\350\026\064\077\040\174\342\356\234\131\125"
	"\160\256\072\364\160\204\252\375\041\102\374\377\230\225\200\017"
	"\345\345\142\176\034\172\015\353\224\322\135\373\372\003\264\031"
	"\224\277\166\075\046\311\056\367\024\213\376\036\160\017\274\225"
	"\212\131\213\201\340\036\110\102\056\226\220\276\001\214\220\015"
	"\212\056\157\221\044\322\257\210\275\233\367\367\024\323\211\211"
	"\242\047\163\224\027\254\366\016\234\355\231\042\363\364\360\215"
	"\242\125\077\070\314\247\272\160\145\025\337\050\353\234\107\360"
	"\250\216\077\363\263\164\060\036\003\154\135\350\001\334\017\127"
	"\041\306\362\107\354\321\333\022\217\202\010\306\247\105\037\347"
	"\271\367\325\030\016\340\214\126\324\322\027\157\113\101\353\253"
	"\232\351\257\043\101\036\134\164\110\056\132\136\163\024\157\224"
	"\044\016\243\031\051\204\356\367\246\232\064\237\063\263\042\150"
	"\214\321\000\177\201\060\243\125\071\162\270\275\237\354\226\361"
	"\222\361\056\252\250\037\127\370\030\175\175\233\075\015\162\324"
	"\374\121\047\224\257\171\117\173\206\300\322\131\271\057\253\116"
	"\243\133\162\075\254\172\063\316\317\277\125\070\335\054\153\366"
	"\303\317\007\163\305\047\206\305\356\323\135\114\364\072\326\051"
	"\053\037\072\070\226\275\007\220\327\013\045\332\137\105\140\234"
	"\276\006\261\134\043\256\224\377\135\265\004\133\032\263\375\151"
	"\024\124\261\072\007\145\160\171\126\222\201\040\265\243\144\343"
	"\004\365\102\253\036\133\374\014\106\334\373\030\361\240\206\021"
	"\134\305\313\221\101\342\277\252\057\320\135\343\313\341\174\111"
	"\222\020\004\130\305\354\147\077\300\072\072\165\240\244\101\255"
	"\244\135\101\027\057\016\172\050\077\034\034\365\247\200\144\176"
	"\230\035\001\360\244\111\126\156\000\126\170\074\241\207\105\252"
	"\350\215\227\111\315\272\163\253\252\370\136\255\302\040\325\176"
	"\157\063\167\337\225\304\030\261\043\177\046\205\366\013\340\273"
	"\156\355\010\156\015\277\130\137\137\360\101\102\242\110\315\311"
	"\101\243\011\114\312\036\144\077\110\323\316\361\137\025\157\026"
	"\210\207\213\056\065\112\246\025\331\317\376\373\143\172\222\327"
	"\102\333\377\076\141\046\317\307\022\104\376\311\343\215\221\301"
	"\361\226\216\352\336\342\243\134\047\130\315\236\372\251\127\142"
	"\304\233\026\024\206\333\344\024\004\173\231\205\076\335\021\347"
	"\112\112\353\162\364\206\114\013\074\045\041\301\362\125\101\135"
	"\222\327\060\113\373\010\354\065\226\231\215\350\245\125\257\302"
	"\057\004\131\213\022\016\216\155\172\252\316\316\240\215\016\103"
	"\043\267\246\350\303\266\170\043\015\302\355\012\063\325\237\233"
	"\045\065\304\143\271\362\032\002\372\104\053\121\201\047\374\104"
	"\041\324\051\332\070\360\232\324\247\151\017\354\265\007\112\313"
	"\216\052\132\134\322\022\147\231\070\272\302\305\223\241\207\352"
	"\242\201\313\117\027\140\354\073\053\110\356\374\202\362\375\217"
	"\017\033\214\201\263\144\057\077\031\052\233\015\260\364\200\323"
	"\065\064\052\373\126\007\226\065\137\035\077\337\073\071\165\000"
	"\050\216\036\372\026\113\112\073\077\007\275\310\016\103\066\233"
	"\327\201\201\004\346\004\305\026\325\001\060\161\277\340\022\012"
	"\150\237\052\164\060\064\156\143\333\351\176\163\343\342\125\162"
	"\166\345\137\166\261\362\071\137\203\164\251\306\110\231\327\375"
	"\110\023\256\215\140\035\125\033\167\177\330\232\352\373\222\246"
	"\050\035\144\300\350\273\025\155\062\054\347\177\010\044\322\027"
	"\314\154\022\000\203\055\134\057\306\236\260\231\367\000\270\141"
	"\373\041\362\320\252\131\333\170\301\060\261\064\260\170\236\140"
	"\360\245\075\317\314\265\070\262\150\376\021\035\277\127\275\356"
	"\167\143\274\354\156\221\051\345\361\153\032\241\054\166\116\061"
	"\311\171\141\342\046\035\323\046\140\266\242\172\353\233\100\166"
	"\302\207\040\322\073\251\256\302\020\326\031\037\302\054\174\054"
	"\255\134\142\161\113\217\101\216\074\110\162\026\037\257\102\232"
	"\013\335\070\306\023\115\374\020\042\211\351\074\240\143\230\352"
	"\216\311\261\015\040\142\325\204\133\040\212\322\136\235\022\247"
	"\133\332\326\376\020\126\210\055\162\060\257\305\165\167\063\057"
	"\013\165\334\333\300\262\166\102\053\367\046\270\205\351\124\112"
	"\233\114\245\324\175\277\014\076\314\167\125\053\245\226\342\254"
	"\266\135\026\301\215\215\344\231\377\326\156\125\127\152\210\003"
	"\337\305\131\046\117\215\051\255\253\226\317\107\260\302\321\074"
	"\145\072\014\361\077\241\322\050\053\372\145\242\035\172\143\316"
	"\263\172\234\102\013\220\203\345\366\172\022\047\300\370\100\025"
	"\210\134\310\041\043\226\246\037\030\322\120\167\361\214\320\114"
	"\073\123\320\235\316\172\116\334\173\000\304\033\017\212\215\317"
	"\233\170\063\201\254\141\344\047\274\022\362\202\051\274\050\313"
	"\143\332\062\335\140\026\371\350\260\274\336\376\255\210\027\170"
	"\073\333\005\223\017\046\076\250\035\315\067\071\317\033\306\167"
	"\254\021\240\122\320\221\041\251\210\256\330\301\203\043\166\320"
	"\176\247\115\336\203\216\013\075\022\051\367\342\340\071\051\045"
	"\024\330\162\367\336\104\377\350\277\372\103\227\150\017\137\341"
	"\353\165\067\066\366\276\161\301\070\166\025\150\263\162\337\307"
	"\205\125\120\312\301\110\153\234\304\140\226\211\263\167\224\216"
	"\215\044\246\135\117\155\206\345\347\326\300\056\376\230\217\273"
	"\002\246\371\037\241\235\336\121\360\104\304\051\303\001\077\227"
	"\377\123\043\120\047\213\035\017\114\335\151\057\154\072\051\106"
	"\351\073\325\000\357\030\147\244\214\330\076\161\331\047\256\040"
	"\024\325\332\053\240\262\211\236\117\215\064\245\251\061\017\064"
	"\257\310\272\201\270\007\306\271\312\372\360\353\321\120\357\143"
	"\056\036\066\131\262\000\121\165\137\315\346\370\012\121\042\055"
	"\103\332\235\235\201\154\025\347\161\145\045\057\242\312\354\312"
	"\054\070\035\243\217\337\132\330\113\330\160\106\230\323\102\160"
	"\054\174\051\076\063\003\014\062\072\005\313\224\125\035\064\106"
	"\052\263\104\006\227\061\377\302\015\232\020\265\254\200\143\243"
	"\113\061\363\253\010\167\042\331\053\122\320\355\307\200\263\262"
	"\213\267\113\125\024\213\033\275\034\142\007\326\074\337\117\212"
	"\336\263\254\221\352\136\135\033\334\136\027\032\325\037\117\076"
	"\261\320\201\044\345\001\213\300\006\023\253\266\025\016\145\207"
	"\136\053\155\110\062\204\116\347\054\255\304\364\115\144\021\337"
	"\211\010\373\347\043\226\163\010\313\255\254\373\232\315\242\350"
	"\076\262\030\321\071\043\104\007\006\227\335\110\023\302\177\271"
	"\077\073\375\060\202\005\117\357\016\177\207\243\373\123\144\176"
	"\175\003\063\365\237\306\355\270\102\247\200\367\271\056\044\172"
	"\040\010\060\325\162\050\153\167\265\234\354\134\136\125\012\177"
	"\163\250\117\373\205\155\002\054\071\331\226\112\006\376\075\013"
	"\226\034\155\301\017\253\045\340\102\035\073\350\016\076\322\204"
	"\272\130\267\055\023\072\014\052\020\270\174\065\026\317\214\344"
	"\105\052\236\140\174\004\171\307\325\231\333\331\354\166\067\265"
	"\115\124\301\344\047\135\067\345\107\107\075\363\300\331\315\310"
	"\113\230\022\012\314\023\170\364\367\255\363\201\313\232\336\051"
	"\146\306\005\075\074\223\250\042\176\075\355\116\062\014\051\204"
	"\261\005\100\160\011\211\311\057\276\066\304\350\023\361\063\362"
	"\007\244\366\251\215\356\042\007\304\042\341\106\066\223\053\253"
	"\225\003\332\353\117\322\247\237\275\176\250\145\111\033\023\315"
	"\373\223\302\162\360\215\275\301\114\261\032\167\342\003\037\047"
	"\261\263\375\012\035\327\122\316\053\023\110\003\010\211\220\367"
	"\214\250\354\274\035\365\063\012\376\010\040\031\363\276\210\035"
	"\374\160\123\301\236\017\333\133\215\310\316\344\050\163\201\073"
	"\224\342\014\134\007\071\124\052\020\111\140\323\215\047\335\073"
	"\200\060\376\070\370\266\265\336\245\266\310\112\135\316\030\235"
	"\367\243\240\116\117\235\051\373\236\346\133\070\274\141\300\261"
	"\071\016\237\003\124\201\144\027\223\216\251\367\310\104\153\064"
	"\300\302\171\113\106\330\376\133\112\032\203\043\331\275\276\067"
	"\122\261\014\125\277\241\117\004\235\146\347\222\247\120\204\274"
	"\142\327\024\226\251\322\055\112\022\346\075\130\371\342\367\065"
	"\143\224\136\223\174\023\313\002\036\260\342\264\007\342\270\156"
	"\030\206\157\217\001\326\134\216\323\213\165\220\001\375\226\302"
	"\031\216\026\035\105\052\341\155\277\010\165\152\144\174\125\314"
	"\346\176\142\070\027\367\276\265\254\372\202\235\135\257\273\215"
	"\357\113\072\356\063\343\273\154\374\143\323\321\273\265\260\050"
	"\177\140\150\376\377\053\050\170\333\250\273\264\012\216\136\223"
	"\002\107\311\077\150\276\377\102\322\051\043\021\230\033\044\155"
	"\002\366\176\147\027\007\116\247\133\026\174\116\203\166\045\004"
	"\266\150\172\133\361\106\040\123\064\203\311\101\217\310\132\074"
	"\303\041\207\002\223\340\002\364\074\050\311\036\176\011\006\134"
	"\022\136\312\344\366\264\351\313\357\062\307\247\301\062\155\345"
	"\074\231\172\146\013\217\310\333\170\360\005\203\231\015\307\046"
	"\004\361\212\155\022\014\051\211\330\030\057\336\136\352\041\030"
	"\247\365\033\215\223\335\260\211\060\022\356\224\363\065\310\000"
	"\102\037\070\014\047\242\302\036\334\156\054\154\017\301\016\136"
	"\020\310\110\225\305\334\172\264\236\331\002\125\007\113\160\041"
	"\353\065\377\231\056\105\145\222\104\224\035\133\006\021\210\360"
	"\043\170\015\320\133\246\364\337\244\354\111\172\237\252\300\135"
	"\304\115\234\246\121\160\357\207\355\127\214\004\123\053\253\073"
	"\257\026\155\206\132\131\333\000\006\014\027\254\136\374\307\365"
	"\245\343\040\343\015\022\320\320\336\173\127\061\274\367\067\270"
	"\075\331\315\222\361\305\273\016\113\114\202\021\177\336\045\315"
	"\366\162\043\252\167\165\326\262\142\000\157\071\326\043\342\326"
	"\122\005\241\376\242\361\012\163\106\013\345\234\157\326\340\006"
	"\120\214\007\047\177\354\077\105\133\352\112\007\206\077\162\354"
	"\045\041\000\045\064\160\026\056\013\340\113\361\075\134\202\054"
	"\074\000\056\364\373\033\071\035\245\214\017\144\207\336\023\361"
	"\102\211\223\327\010\340\115\247\127\025\317\364\274\305\111\255"
	"\213\230\311\241\360\211\300\210\306\335\262\363\375\074\004\317"
	"\035\161\036\353\215\336\042\207\075\227\145\220\030\202\003\210"
	"\134\375\146\317\115\227\115\336\006\143\024\224\212\001\024\362"
	"\265\135\214\056\226\357\271\124\260\362\101\003\305\100\113\066"
	"\057\272\136\312\127\161\011\303\075\314\332\260\173\065\130\252"
	"\207\211\052\142\320\363\373\016\216\276\163\150\061\146\344\016"
	"\063\250\160\147\055\373\225\015\061\165\257\034\206\375\215\035"
	"\001\264\006\262\317\310\155\273\277\317\177\167\366\245\335\115"
	"\054\227\307\051\050\011\255\164\355\277\024\365\244\077\270\124"
	"\124\211\271\015\027\140\044\365\070\340\134\314\035\324\200\313"
	"\047\074\305\113\065\304\041\103\377\014\160\060\050\337\010\214"
	"\020\376\225\345\015\261\003\000\335\267\225\175\032\235\071\164"
	"\372\144\135\350\357\170\050\270\103\052\023\122\335\041\371\011"
	"\271\130\230\153\121\333\161\306\333\202\313\230\267\004\155\307"
	"\013\342\053\325\227\041\341\224\154\026\357\203\200\336\023\266"
	"\166\054\105\237\205\361\324\021\311\351\376\000\244\262\371\057"
	"\226\234\247\202\243\056\264\272\152\141\040\363\076\312\355\065"
	"\076\317\301\375\006\325\120\040\066\257\162\126\027\374\231\270"
	"\077\045\057\362\061\002\012\224\322\072\302\356\337\363\075\201"
	"\074\016\070\362\002\277\316\205\346\206\375\227\335\220\050\043"
	"\372\133\262\154\027\136\125\361\117\165\133\110\037\344\204\320"
	"\141\205\126\164\351\230\320\134\010\135\033\212\122\075\042\045"
	"\232\106\315\271\370\244\212\202\010\012\141\073\322\012\272\007"
	"\022\124\344\251\171\120\333\007\377\357\222\040\173\265\112\237"
	"\363\157\060\135\177\301\226\005\035\272\357\051\234\361\177\260"
	"\327\224\333\245\303\014\031\121\210\354\162\044\136\261\173\333"
	"\100\364\255\006\146\325\215\344\215\013\063\255\220\352\345\025"
	"\254\203\113\027\056\111\220\063\273\114\251\312\262\073\011\251"
	"\362\065\273\373\332\000\173\317\357\325\147\375\076\146\100\303"
	"\152\040\110\137\356\115\271\325\064\145\322\332\002\142\162\354"
	"\172\076\250\033\141\020\006\230\005\321\151\174\344\335\240\041"
	"\167\064\203\004\205\065\172\014\141\345\124\355\043\145\276\163"
	"\022\325\251\120\302\137\366\036\101\200\012\052\075\205\217\301"
	"\064\242\206\342\157\312\251\312\366\054\167\165\100\252\371\140"
	"\353\046\254\336\326\057\266\031\125\015\126\351\135\337\301\344"
	"\001\327\075\331\022\266\312\016\350\174\112\115\075\057\230\271"
	"\117\002\124\222\106\106\372\267\326\335\342\134\334\326\244\123"
	"\150\156\202\313\131\305\242\176\355\351\321\220\022\256\276\130"
	"\317\250\001\205\325\044\024\030\175\107\042\234\152\125\375\145"
	"\161\245\177\163\374\234\050\007\317\373\276\205\337\015\165\313"
	"\165\151\247\130\023\164\026\030\231\326\355\231\057\214\322\070"
	"\124\041\157\207\237\342\030\351\337\352\347\126\141\057\051\113"
	"\076\142\104\044\313\063\270\345\327\163\376\310\252\316\366\117"
	"\167\017\010\141\127\031\341\333\003\250\131\352\223\146\256\114"
	"\052\363\145\162\131\312\021\035\363\307\371\117\035\070\330\103"
	"\321\214\241\273\364\035\065\003\242\133\316\230\055\124\373\260"
	"\345\055\334\056\270\333\121\316\117\006\041\054\211\332\356\043"
	"\233\000\024\276\271\336\112\151\343\013\303\253\033\077\016\312"
	"\331\174\232\374\011\174\065\345\317\044\366\160\154\010\252\130"
	"\302\263\013\124\232\054\167\133\166\326\230\023\023\201\311\304"
	"\307\364\243\074\036\125\362\073\256\135\172\247\334\040\304\032"
	"\230\274\057\004\374\132\155\151\324\040\125\167\273\251\354\073"
	"\337\344\307\022\050\127\075\003\054\105\377\037\166\373\141\030"
	"\226\254\303\065\146\145\276\054\374\040\010\342\375\033\115\263"
	"\275\373\156\204\301\245\223\213\115\343\150\116\341\350\145\064"
	"\050\326\256\166\123\334\001\121\272\051\350\011\131\257\243\021"
	"\247\123\215\222\101\000\172\210\361\144\062\227\156\070\351\042"
	"\276\244\363\120\240\204\140\172\337\051\246\260\220\232\273\311"
	"\016\350\011\362\330\357\000\243\035\027\112\035\165\340\161\302"
	"\314\206\026\365\261\247\071\265\037\304\317\076\157\256\233\137"
	"\221\225\211\254\175\170\010\276\107\076\230\354\050\346\250\302"
	"\171\266\345\221\135\141\105\317\372\252\270\122\141\330\370\234"
	"\121\247\276\075\344\011\140\305\161\072\342\005\130\003\053\363"
	"\020\362\236\271\264\202\112\121\014\021\205\152\131\115\105\304"
	"\376\226\212\065\112\121\007\207\230\152\034\030\231\271\255\122"
	"\171\211\353\075\036\221\343\254\237\147\370\004\356\154\300\015"
	"\015\315\344\104\157\032\220\333\134\141\000\005\244\316\370\332"
	"\324\302\346\101\041\137\051\116\271\141\167\176\206\027\315\345"
	"\355\174\111\265\212\302\056\316\127\370\304\154\216\151\035\013"
	"\347\113\374\234\112\262\131\131\345\115\064\365\251\013\230\113"
	"\321\357\070\245\345\216\112\324\101\103\052\064\203\376\041\016"
	"\111\064\050\226\343\171\161\317\023\037\236\011\112\370\200\231"
	"\071\236\017\342\364\250\163\207\106\171\101\066\224\162\316\177"
	"\372\277\262\217\156\202\340\207\372\365\172\207\225\260\144\247"
	"\201\365\204\321\010\222\121\304\315\332\225\112\215\324\012\110"
	"\212\316\134\105\013\005\205\203\033\263\103\266\040\360\075\136"
	"\257\041\153\122\115\311\227\263\225\225\023\322\300\150\241\125"
	"\112\220\035\346\340\270\300\056\323\163\146\011\376\205\272\010"
	"\346\137\336\134\370\244\113\270\135\343\016\236\354\022\304\044"
	"\161\362\374\117\144\373\022\326\132\256\337\223\171\260\223\057"
	"\210\341\067\073\225\050\057\114\100\240\327\236\176\000\322\111"
	"\367\210\056\074\311\065\266\222\226\335\263\360\013\057\262\334"
	"\131\003\163\106\064\115\122\305\050\010\307\234\022\154\272\350"
	"\021\215\020\267\170\315\213\027\273\114\217\235\177\111\277\206"
	"\317\007\325\322\325\175\372\173\353\170\305\010\311\342\247\104"
	"\270\140\002\040\052\173\121\331\072\151\223\350\122\046\301\121"
	"\062\231\353\377\124\250\200\164\162\110\040\327\071\244\123\202"
	"\144\236\276\242\162\012\120\305\010\063\057\163\056\123\057\235"
	"\266\237\022\135\126\170\353\173\212\103\111\371\066\321\130\002"
	"\324\171\215\055\064\212\114\154\251\007\111\061\331\267\032\256"
	"\336\135\175\344\230\314\242\142\104\312\125\163\027\226\101\336"
	"\072\252\264\003\174\327\123\157\172\032\077\206\323\323\004\275"
	"\311\236\060\130\043\165\141\372\051\015\236\324\260\002\333\333"
	"\150\066\022\225\250\063\061\063\316\230\254\042\040\026\355\247"
	"\073\066\066\315\323\160\261\064\325\217\112\105\152\035\326\022"
	"\146\131\171\337\241\173\270\162\356\371\316\256\043\016\274\247"
	"\133\255\355\317\240\257\143\140\334\244\004\075\177\052\123\310"
	"\265\127\314\015\053\323\055\172\154\317\072\261\013\076\173\141"
	"\230\150\302\007\117\272\360\172\076\272\202\201\345\015\347\203"
	"\104\017\014\230\264\062\157\145\007\360\325\102\133\124\326\274"
	"\260\023\064\073\077\333\303\340\207\175\266\361\204\015\225\113"
	"\137\307\030\174\160\153\322\270\073\121\205\151\302\342\125\357"
	"\115\026\170\273\343\216\317\224\226\146\077\206\114\137\122\210"
	"\071\337\244\007\241\110\162\037\333\114\130\047\220\362\036\024"
	"\235\064\021\133\253\340\272\043\245\351\104\316\036\001\250\342"
	"\047\302\344\044\273\004\061\014\223\021\273\335\212\047\240\227"
	"\351\054\073\320\022\333\260\351\364\114\016\154\340\314\106\020"
	"\060\121\005\322\147\172\367\314\110\102\106\252\316\375\107\263"
	"\374\173\001\303\013\205\173\250\043\254\301\205\356\360\014\011"
	"\000\215\030\267\070\067\157\250\071\273\071\335\353\010\014\126"
	"\203\340\371\332\200\365\104\356\301\367\306\336\014\220\105\162"
	"\006\074\027\064\161\254\325\045\177\061\325\020\266\160\116\155"
	"\323\065\100\157\023\017\122\157\322\021\311\317\320\343\227\123"
	"\336\251\334\226\255\320\257\013\330\075\135\315\232\065\032\253"
	"\323\372\067\034\356\077\070\264\260\361\111\115\374\364\301\135"
	"\354\255\006\134\253\173\111\064\205\067\024\052\116\210\270\163"
	"\316\155\121\361\025\224\271\175\322\317\237\026\023\101\346\217"
	"\061\043\223\164\103\147\072\205\211\131\127\260\303\057\331\166"
	"\376\322\373\217\360\344\347\323\072\052\071\063\301\070\256\375"
	"\015\373\362\252\023\034\057\033\305\175\171\324\073\157\202\245"
	"\337\133\152\347\052\301\002\312\047\041\014\106\012\231\347\127"
	"\267\106\266\202\065\322\141\165\255\122\211\167\263\300\231\040"
	"\203\012\363\365\170\275\301\062\257\251\014\046\174\212\272\311"
	"\142\061\341\306\057\252\167\364\173\026\204\057\270\040\332\320"
	"\151\315\133\176\246\030\232\334\200\022\137\124\041\225\234\137"
	"\305\264\211\307\117\134\232\042\110\336\314\321\057\003\212\256"
	"\112\100\110\161\337\351\167\366\177\360\247\052\335\121\347\203"
	"\136\340\110\272\332\102\167\351\321\344\215\170\145\070\141\150"
	"\365\160\025\103\120\247\175\026\172\020\143\075\071\141\057\156"
	"\172\262\133\304\255\023\105\241\130\075\003\031\277\044\240\277"
	"\035\257\055\074\070\355\224\063\246\163\001\265\212\170\162\037"
	"\356\301\022\074\251\320\177\171\012\367\007\112\366\064\120\165"
	"\274\137\306\064\073\311\105\305\054\200\112\367\022\047\373\030"
	"\315\102\262\127\306\307\246\073\177\111\115\127\074\375\304\030"
	"\336\313\115\263\377\315\076\031\303\155\307\262\153\340\054\213"
	"\332\104\047\237\037\302\003\351\323\143\016\223\133\003\145\313"
	"\305\336\145\274\267\136\172\347\223\240\046\155\334\335\075\173"
	"\263\062\370\202\217\006\134\321\111\327\327\271\360\031\161\311"
	"\033\001\147\174\074\031\155\041\061\146\044\170\361\262\376\350"
	"\115\152\150\245\042\066\104\312\343\054\332\136\006\164\053\354"
	"\302\017\057\025\155\110\156\157\142\304\130\241\214\245\007\070"
	"\343\006\330\275\222\213\335\104\307\225\143\032\276\013\204\057"
	"\374\015\235\051\357\330\314\300\003\123\106\026\140\122\303\107"
	"\170\223\134\046\374\007\271\165\115\151\111\166\003\200\235\101"
	"\043\076\117\300\071\030\152\160\026\155\100\003\275\043\014\113"
	"\155\341\106\130\361\064\125\076\332\043\360\027\344\006\204\154"
	"\116\312\263\064\006\215\124\160\062\300\233\314\317\210\114\135"
	"\361\327\233\214\177\172\346\014\327\014\023\211\365\106\250\107"
	"\033\376\112\263\347\016\027\173\231\041\030\002\370\301\216\135"
	"\222\000\064\314\303\221\021\230\222\277\344\034\212\320\225\273"
	"\122\337\157\072\355\206\265\206\247\315\211\240\217\027\376\041"
	"\030\062\356\334\304\000\164\126\277\131\162\112\051\010\006\174"
	"\347\165\266\325\374\153\134\244\071\345\105\311\375\103\352\026"
	"\166\331\362\073\331\146\221\231\300\004\344\351\014\352\145\364"
	"\140\034\311\135\210\045\002\301\013\107\212\011\212\165\037\001"
	"\117\021\074\051\170\315\302\070\322\247\042\337\221\210\323\362"
	"\244\235\117\054\302\121\356\316\231\171\327\043\356\367\044\075"
	"\010\141\147\201\056\052\272\001\321\334\340\143\145\263\125\011"
	"\121\245\066\023\367\044\342\220\235\271\264\214\261\331\312\271"
	"\072\061\073\151\133\366\152\055\322\113\220\070\377\346\102\120"
	"\214\170\144\203\235\106\024\073\000\311\307\261\242\222\153\335"
	"\303\247\107\037\235\262\114\160\375\334\250\374\303\352\115\117"
	"\143\261\322\000\370\347\073\370\260\003\252\123\225\025\060\131"
	"\274\170\170\131\052\304\312\047\241\162\044\144\134\161\263\300"
	"\043\206\300\033\155\374\024\036\000\276\161\225\323\242\356\220"
	"\032\147\352\104\054\264\154\315\047\220\062\204\002\346\104\046"
	"\154\005\101\332\001\125\370\001\024\152\227\350\014\206\171\047"
	"\355\143\153\031\030\330\347\077\151\031\303\153\000\007\221\155"
	"\014\323\107\016\051\100\020\076\252\247\046\267\055\237\336\032"
	"\003\112\064\033\042\033\132\213\065\036\367\065\045\211\243\062"
	"\134\352\100\206\052\120\304\325\370\353\214\045\212\152\100\215"
	"\264\164\251\326\220\004\141\306\042\131\374\110\342\237\172\076"
	"\211"
#define      rlax_z	1
#define      rlax	((&data[6386]))
	"\014"
#define      pswd_z	256
#define      pswd	((&data[6422]))
	"\004\165\026\052\000\200\153\216\064\340\067\013\160\073\155\066"
	"\136\306\063\246\250\322\041\347\134\334\255\020\351\067\232\355"
	"\255\260\030\022\172\062\356\251\207\144\017\374\261\034\215\315"
	"\110\124\203\210\364\177\347\361\316\205\033\161\205\321\270\057"
	"\006\113\102\201\175\060\053\005\225\073\002\106\127\217\023\240"
	"\344\226\051\330\026\020\311\344\226\345\125\033\267\016\113\276"
	"\131\215\100\327\276\153\335\123\247\337\232\376\157\255\237\123"
	"\104\310\053\132\330\365\077\156\332\224\212\222\242\326\120\374"
	"\144\220\323\042\374\260\166\243\220\020\242\377\276\101\122\002"
	"\011\176\135\342\163\234\120\116\061\333\340\324\261\060\320\025"
	"\301\244\070\275\125\256\141\345\277\003\344\176\104\066\201\115"
	"\264\336\057\050\173\200\166\254\134\127\200\015\207\121\043\111"
	"\366\133\007\113\012\150\060\312\154\025\110\260\113\311\376\000"
	"\247\056\051\043\257\237\317\013\366\120\031\176\242\074\310\230"
	"\230\317\344\242\070\024\154\244\051\265\125\165\176\124\166\046"
	"\202\237\111\062\077\031\075\066\152\127\265\014\223\175\245\053"
	"\115\211\316\205\236\073\052\310\360\177\075\157\323\264\226\126"
	"\124\340\210\223\371\306\312\143\035\177\160\261\374\025\334\111"
	"\237\252\317\255\060\203\073\145\143\163\161\324\257\336\013\015"
	"\245\076\264\115\020\325\065\154\262\342\175\233\032\030\211\307"
	"\310\241\164\371\045"
#define      opts_z	1
#define      opts	((&data[6712]))
	"\302"
#define      date_z	1
#define      date	((&data[6713]))
	"\220"
#define      tst2_z	19
#define      tst2	((&data[6717]))
	"\340\124\250\262\147\254\126\201\032\230\014\212\356\044\231\110"
	"\043\107\355\112\255\036\224\242"
#define      chk2_z	19
#define      chk2	((&data[6740]))
	"\046\034\022\036\114\174\235\123\121\172\226\301\237\277\132\042"
	"\076\043\371\014\121\272\243\270\324"
#define      msg1_z	65
#define      msg1	((&data[6767]))
	"\204\343\020\176\002\353\026\342\007\164\055\241\335\373\114\052"
	"\324\144\023\216\145\264\111\012\263\140\355\176\273\004\011\203"
	"\164\016\233\221\167\216\236\260\326\104\210\376\067\245\205\354"
	"\050\234\063\025\123\015\136\332\177\300\174\341\162\117\035\007"
	"\347\113\250\301\345\011\300\335\222\344\256\360\267\135\132"
#define      chk1_z	22
#define      chk1	((&data[6846]))
	"\054\124\274\227\111\127\244\157\041\217\317\107\063\024\235\057"
	"\032\103\264\010\026\145\374\121\134\105"
#define      xecc_z	15
#define      xecc	((&data[6871]))
	"\346\206\154\153\172\054\000\205\041\354\260\132\303\310\074\144"
	"\016\300\273\102"
#define      lsto_z	1
#define      lsto	((&data[6888]))
	"\125"
#define      msg2_z	19
#define      msg2	((&data[6891]))
	"\232\051\212\267\351\026\374\320\156\137\165\261\156\364\176\251"
	"\051\115\371\066\375\042"
#define      tst1_z	22
#define      tst1	((&data[6911]))
	"\337\104\323\161\116\070\305\035\213\301\223\050\362\250\026\305"
	"\030\333\001\114\071\163\035\304\055\170"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
