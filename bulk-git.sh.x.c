#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f bulk-git.sh -o bulk-git 
#endif

static  char data [] = 
#define      msg1_z	65
#define      msg1	((&data[16]))
	"\004\063\336\204\364\144\124\057\042\117\165\136\014\117\323\362"
	"\036\250\175\012\267\212\333\041\245\346\167\106\230\307\361\072"
	"\247\330\101\127\221\276\062\021\265\271\275\353\151\364\334\057"
	"\245\101\361\206\373\233\331\277\015\225\263\270\347\266\324\354"
	"\063\327\316\326\266\264\360\176\246\155\123\100\027\366\060\123"
	"\153\024\001\224\355\015\013"
#define      shll_z	10
#define      shll	((&data[89]))
	"\165\031\173\016\351\364\057\141\054\166\120\315\115"
#define      chk1_z	22
#define      chk1	((&data[100]))
	"\063\302\233\144\157\265\253\046\261\152\335\344\206\102\235\113"
	"\066\340\016\344\156\156\227\100\214\033"
#define      inlo_z	3
#define      inlo	((&data[126]))
	"\070\250\213"
#define      xecc_z	15
#define      xecc	((&data[129]))
	"\221\252\266\001\105\364\227\241\246\314\233\017\111\340\363\331"
	"\161"
#define      text_z	5201
#define      text	((&data[358]))
	"\277\075\106\123\053\124\136\141\056\266\327\107\003\151\124\261"
	"\000\224\076\034\311\056\214\056\102\114\010\263\031\061\371\330"
	"\157\077\053\233\224\211\374\302\100\323\012\104\075\136\366\075"
	"\362\064\132\273\143\346\351\245\062\362\131\113\044\122\044\223"
	"\222\117\056\047\330\053\352\031\377\364\135\074\122\123\171\105"
	"\207\323\001\353\272\353\220\354\335\352\070\001\075\134\225\320"
	"\254\303\367\205\357\341\236\356\325\373\052\050\117\244\155\327"
	"\170\156\302\062\131\123\037\067\075\130\070\173\264\315\113\141"
	"\221\103\346\200\044\204\156\372\200\231\043\320\075\220\247\265"
	"\377\151\347\131\275\006\220\372\137\311\165\023\226\301\165\047"
	"\004\133\250\050\340\026\043\141\257\106\061\355\327\330\242\327"
	"\102\212\061\377\221\301\372\360\213\160\004\041\061\171\111\066"
	"\324\361\137\265\007\202\026\267\311\107\244\240\040\107\170\143"
	"\321\251\143\142\033\046\255\255\270\312\361\245\364\363\121\201"
	"\007\277\012\106\036\065\214\152\040\337\276\351\252\311\161\114"
	"\025\015\330\305\353\317\340\355\026\223\130\163\034\150\027\153"
	"\113\104\265\132\054\253\277\070\131\153\277\016\276\365\270\321"
	"\317\211\021\033\367\054\215\164\034\067\103\305\004\112\207\311"
	"\242\070\127\246\122\175\170\124\265\336\205\017\351\162\042\147"
	"\311\035\001\367\064\226\220\171\247\002\123\020\053\341\303\032"
	"\152\227\104\027\273\144\170\057\023\236\242\230\110\047\034\032"
	"\336\306\306\033\113\046\174\107\037\152\117\316\127\212\144\145"
	"\333\220\242\072\013\377\151\171\013\276\122\015\361\107\136\323"
	"\056\070\125\067\370\231\362\336\353\206\173\241\172\343\277\020"
	"\115\370\245\030\036\306\034\074\250\231\144\043\372\163\357\043"
	"\124\340\076\137\362\063\343\253\366\147\037\224\103\327\032\142"
	"\206\327\242\076\275\326\361\305\002\027\142\363\250\146\364\035"
	"\325\231\306\372\361\120\000\220\221\203\022\205\064\170\027\361"
	"\266\250\362\021\031\362\255\060\211\311\375\363\107\343\310\364"
	"\076\364\260\170\216\066\363\036\326\276\165\266\277\115\347\067"
	"\203\155\175\205\013\112\224\154\305\260\320\111\342\324\236\004"
	"\352\137\123\244\122\367\163\061\000\031\224\272\355\133\007\221"
	"\223\256\230\331\341\306\360\040\377\315\324\357\050\246\011\236"
	"\163\074\174\004\130\276\002\017\073\256\244\261\227\224\004\027"
	"\226\153\252\321\151\025\116\201\235\345\103\157\170\366\045\263"
	"\261\235\170\236\106\163\027\006\322\336\021\327\020\362\000\360"
	"\305\013\166\200\341\157\334\064\144\210\325\127\156\143\342\172"
	"\275\055\345\077\244\040\311\226\226\027\165\365\163\074\106\144"
	"\346\235\046\105\254\271\140\344\374\030\117\222\063\014\262\021"
	"\375\050\251\236\362\176\136\335\022\345\124\064\240\141\037\217"
	"\004\051\227\047\366\135\241\015\330\145\037\136\007\371\106\153"
	"\111\037\320\064\034\277\265\115\247\333\346\063\270\120\230\114"
	"\256\177\220\274\300\320\326\145\027\160\351\360\317\033\116\072"
	"\065\270\126\206\010\327\016\035\314\015\034\045\201\013\147\310"
	"\043\375\165\116\326\177\212\033\346\177\051\007\260\360\200\341"
	"\013\040\203\340\013\210\100\266\246\156\135\171\362\235\376\157"
	"\155\303\140\375\167\005\331\350\111\224\344\202\354\242\354\031"
	"\054\026\110\210\153\042\167\264\152\313\161\223\074\140\176\302"
	"\014\143\055\117\330\333\000\240\064\173\342\025\066\250\146\334"
	"\323\273\151\152\247\002\255\026\315\073\304\272\172\263\235\235"
	"\253\224\347\047\341\167\262\036\142\046\266\013\044\022\012\201"
	"\031\304\227\113\047\140\044\045\151\145\273\267\277\153\276\347"
	"\024\334\112\045\204\147\211\015\335\347\066\327\350\173\274\010"
	"\145\074\350\062\302\144\316\326\206\221\025\107\103\210\135\166"
	"\140\235\074\221\144\132\247\172\312\261\215\146\124\173\333\022"
	"\046\212\255\160\271\347\007\216\121\024\362\362\351\054\372\252"
	"\065\157\324\173\267\225\326\004\370\044\211\320\316\175\360\224"
	"\336\202\226\270\015\131\143\227\231\044\044\072\171\056\215\045"
	"\035\225\102\136\254\313\050\252\324\210\011\271\206\306\203\125"
	"\227\264\075\164\275\014\261\145\026\111\120\114\130\027\347\043"
	"\176\152\151\100\160\210\056\267\127\210\313\025\170\057\077\001"
	"\235\136\334\273\372\156\274\340\170\210\114\241\352\221\246\062"
	"\066\305\157\162\011\161\067\002\201\345\260\265\225\164\036\157"
	"\134\030\127\236\260\142\225\044\125\210\321\277\156\261\331\343"
	"\254\334\150\100\333\167\014\007\004\153\312\164\167\321\153\041"
	"\373\027\140\052\167\373\310\234\003\303\110\335\264\007\270\325"
	"\262\036\064\176\265\127\055\214\234\110\277\161\111\213\075\330"
	"\051\073\231\113\326\210\134\246\012\353\371\002\246\013\242\066"
	"\006\350\005\223\215\154\371\104\331\037\305\315\055\206\042\306"
	"\036\161\324\103\064\043\214\206\316\210\156\201\222\011\124\220"
	"\346\354\214\345\057\145\144\033\231\213\345\150\061\235\340\244"
	"\226\162\063\153\335\343\035\330\200\361\064\141\300\147\203\364"
	"\176\024\140\015\054\273\374\027\031\211\255\125\261\265\121\371"
	"\020\172\254\277\345\046\330\251\063\275\132\200\271\306\206\042"
	"\236\055\261\361\045\127\011\121\077\274\151\016\235\267\154\226"
	"\164\216\264\022\116\346\271\316\312\001\027\037\022\211\251\374"
	"\124\171\124\102\212\146\303\210\267\243\171\320\237\060\306\154"
	"\176\053\157\164\204\351\336\066\040\360\362\366\006\307\052\207"
	"\217\143\052\022\223\233\361\077\011\210\002\216\261\104\024\050"
	"\150\113\366\107\256\241\250\360\301\025\341\353\133\027\240\141"
	"\054\172\201\320\304\316\301\150\370\334\061\104\210\045\211\030"
	"\375\222\047\276\306\327\176\340\045\143\076\221\311\024\220\104"
	"\032\152\150\247\277\004\235\342\306\224\071\217\373\243\155\024"
	"\253\034\333\261\211\217\156\302\313\047\144\354\221\225\263\300"
	"\313\227\204\323\370\356\041\157\072\173\270\350\263\176\174\236"
	"\174\217\164\051\226\132\104\146\355\010\326\363\012\030\061\263"
	"\071\225\015\212\273\173\010\205\072\252\056\106\132\025\276\164"
	"\225\211\026\271\073\260\011\125\212\256\166\247\035\333\144\233"
	"\101\200\232\034\215\311\276\104\353\153\041\131\034\373\365\271"
	"\331\122\232\303\364\335\137\065\050\243\026\113\301\005\133\106"
	"\362\363\104\303\276\021\035\335\136\347\252\170\341\270\327\372"
	"\344\362\023\271\106\150\331\141\355\005\160\034\174\261\132\340"
	"\126\100\060\175\060\214\033\231\232\146\035\171\066\314\244\236"
	"\255\272\073\122\104\337\112\130\053\230\005\124\351\313\102\016"
	"\243\352\151\316\157\264\226\126\262\364\130\131\156\374\000\346"
	"\342\266\046\241\007\300\351\335\157\010\057\004\026\372\257\260"
	"\066\124\216\060\246\023\347\322\326\240\220\005\320\013\225\226"
	"\116\216\351\212\105\202\153\062\377\165\351\171\243\127\361\066"
	"\110\246\363\343\340\333\021\154\053\262\375\012\300\150\074\364"
	"\333\041\343\355\362\201\353\054\365\211\317\156\044\233\242\136"
	"\123\206\275\070\107\027\373\002\102\067\226\003\023\277\102\230"
	"\217\351\355\323\002\010\223\212\016\233\126\225\016\300\126\054"
	"\203\000\367\233\212\137\340\233\054\135\052\263\355\222\324\316"
	"\034\371\040\204\050\141\023\235\132\254\003\274\070\320\210\071"
	"\376\160\252\262\167\043\341\226\074\174\374\145\052\202\003\020"
	"\335\333\225\042\015\026\113\356\211\101\121\174\006\320\015\336"
	"\126\326\357\034\245\023\127\335\347\004\165\234\315\366\001\336"
	"\114\207\053\115\133\066\077\332\250\060\364\010\303\322\144\143"
	"\022\173\065\242\142\264\031\240\162\077\037\136\271\353\226\372"
	"\352\352\313\212\202\221\245\245\352\047\075\145\047\207\252\277"
	"\233\311\371\245\137\230\351\245\052\361\152\172\333\115\073\240"
	"\026\075\074\115\031\070\041\266\016\152\314\107\127\347\300\316"
	"\374\046\126\347\066\102\143\244\251\144\360\265\120\273\146\277"
	"\076\047\204\200\362\341\317\325\050\175\204\320\241\022\104\155"
	"\355\005\052\253\002\105\275\233\175\207\355\311\000\012\263\273"
	"\210\151\110\377\156\075\354\350\133\357\022\264\116\350\332\261"
	"\312\344\065\162\206\103\126\074\231\157\172\342\132\053\157\013"
	"\034\201\223\347\202\034\175\340\223\032\137\054\001\041\063\157"
	"\311\247\312\004\145\131\363\211\037\250\116\040\241\323\275\317"
	"\345\166\237\351\065\367\017\007\035\362\274\133\206\202\105\136"
	"\131\326\026\051\334\322\254\367\152\024\204\303\267\334\077\322"
	"\076\377\165\146\103\134\334\141\377\270\042\104\335\165\126\210"
	"\271\177\141\144\025\067\112\302\172\301\261\031\316\155\041\002"
	"\026\201\265\046\337\105\025\160\263\301\330\277\176\154\332\376"
	"\351\221\303\213\304\043\146\363\247\317\303\165\110\371\373\115"
	"\235\213\022\057\177\131\227\273\252\052\217\326\245\236\106\135"
	"\063\075\057\116\034\060\312\026\263\376\344\204\256\051\373\001"
	"\154\013\012\164\254\260\062\032\274\221\117\325\000\074\316\341"
	"\353\111\254\064\134\336\227\072\233\347\257\074\100\265\301\045"
	"\255\024\052\345\221\210\322\053\124\205\247\365\061\062\343\077"
	"\105\044\265\360\231\160\271\061\153\054\103\232\370\110\154\272"
	"\175\372\046\333\040\364\240\004\210\007\327\336\314\247\002\224"
	"\131\312\104\271\210\330\355\161\011\022\163\305\363\360\112\177"
	"\071\024\011\332\142\253\024\004\242\150\264\102\021\203\046\116"
	"\343\165\275\136\206\357\001\277\155\267\055\203\224\114\254\220"
	"\220\005\072\206\256\232\172\347\257\152\333\062\136\051\327\364"
	"\140\365\371\105\305\252\367\372\146\372\100\166\035\104\337\266"
	"\026\363\132\265\077\044\035\130\040\372\153\045\167\124\371\110"
	"\157\066\020\205\007\210\164\325\063\075\276\336\221\113\212\004"
	"\215\334\254\002\363\346\120\277\147\347\013\246\346\262\162\265"
	"\141\164\044\255\357\341\257\126\252\000\156\210\061\354\141\147"
	"\267\175\161\033\256\025\266\324\161\303\315\231\140\263\361\332"
	"\242\064\325\104\207\040\362\221\133\155\207\003\142\130\375\232"
	"\145\207\252\173\375\266\010\036\231\130\307\367\302\210\250\016"
	"\124\306\066\165\121\043\062\042\200\222\000\374\342\002\304\360"
	"\353\274\232\316\376\257\022\260\305\174\072\332\345\326\214\311"
	"\052\110\004\143\251\123\155\337\311\104\037\226\371\034\103\256"
	"\017\023\067\005\161\372\301\055\072\151\061\213\144\330\130\253"
	"\136\122\322\366\135\141\002\126\170\140\062\165\110\033\244\205"
	"\134\010\065\300\260\321\117\050\162\103\154\321\362\005\274\216"
	"\116\247\243\071\363\273\066\220\035\316\122\151\211\177\366\007"
	"\016\265\042\250\201\304\026\234\020\203\107\126\164\146\225\134"
	"\252\110\350\302\330\240\070\341\116\364\304\216\302\226\164\313"
	"\371\006\216\332\351\041\362\064\157\373\375\004\244\170\364\256"
	"\337\063\037\303\345\331\126\370\374\360\262\357\117\263\340\335"
	"\206\172\111\347\037\045\332\067\237\245\075\013\326\306\215\065"
	"\057\223\335\063\345\023\204\057\103\064\227\166\175\055\065\175"
	"\367\143\305\247\020\055\304\024\140\063\036\154\200\314\141\070"
	"\316\174\346\341\043\107\323\372\124\073\240\177\016\014\142\324"
	"\142\212\176\123\243\160\310\075\066\043\136\261\034\157\104\136"
	"\107\341\261\177\215\276\261\230\000\350\372\127\365\310\274\031"
	"\304\073\004\205\321\056\011\256\145\241\013\054\203\135\154\233"
	"\173\072\306\346\331\053\356\066\104\222\015\233\142\251\246\103"
	"\134\332\104\027\270\055\252\005\220\336\111\261\161\111\260\167"
	"\325\277\214\212\340\231\141\136\347\316\030\144\235\062\234\026"
	"\126\157\140\220\072\341\147\054\244\375\225\050\225\251\131\175"
	"\125\064\125\213\235\322\323\201\101\313\230\006\344\274\361\020"
	"\156\161\162\053\311\100\310\061\322\020\236\317\055\003\113\377"
	"\226\327\322\375\341\063\037\162\321\364\234\274\151\010\126\170"
	"\273\265\227\336\176\143\162\126\035\206\026\312\155\057\135\060"
	"\301\161\326\212\152\341\300\234\370\233\365\143\222\027\274\103"
	"\367\224\025\027\040\357\053\350\334\220\057\055\303\344\170\203"
	"\010\237\255\325\377\333\103\310\372\144\061\207\020\251\033\214"
	"\337\331\335\111\035\255\013\074\221\266\036\265\241\124\270\042"
	"\231\342\053\334\251\000\342\261\344\126\143\367\050\213\106\131"
	"\120\113\143\333\274\322\134\251\115\074\172\107\011\322\267\052"
	"\226\231\157\127\123\133\035\267\042\045\313\336\055\031\376\261"
	"\023\037\150\034\266\134\267\055\251\116\066\000\323\276\130\140"
	"\120\266\240\260\120\045\212\040\257\140\221\101\104\063\056\332"
	"\006\162\004\156\145\345\062\006\254\064\241\322\240\371\124\012"
	"\373\344\055\317\005\143\257\074\146\074\051\325\257\301\042\310"
	"\267\154\101\254\305\043\174\156\117\037\105\307\040\255\111\166"
	"\367\215\041\022\031\057\236\323\307\325\026\066\175\144\267\113"
	"\337\046\234\106\100\107\164\202\250\346\072\240\075\057\362\360"
	"\003\231\200\361\126\045\147\116\301\100\240\334\131\021\122\334"
	"\051\302\172\264\345\363\354\046\077\341\130\030\015\170\257\311"
	"\071\133\112\240\041\247\017\026\371\320\231\175\267\057\142\174"
	"\225\143\055\364\137\324\214\044\321\255\240\076\013\240\234\250"
	"\105\270\057\335\057\367\207\014\072\302\152\205\042\165\346\270"
	"\330\115\176\265\057\004\146\340\330\006\217\352\357\043\330\342"
	"\356\075\176\164\146\124\372\065\174\310\222\327\225\202\121\215"
	"\346\165\223\067\310\241\100\136\055\313\040\326\355\255\154\344"
	"\271\023\342\234\030\305\216\162\172\013\006\171\041\167\004\170"
	"\163\027\013\221\304\264\064\216\163\153\153\273\347\122\013\043"
	"\223\144\160\020\036\114\004\032\246\143\063\137\050\051\164\071"
	"\044\054\263\057\210\070\016\303\200\150\163\031\242\206\315\110"
	"\067\033\055\262\214\134\366\357\153\351\146\047\306\005\321\001"
	"\353\036\131\137\013\370\005\221\367\144\130\103\055\224\073\036"
	"\160\173\174\240\010\120\066\063\145\047\225\370\164\262\165\024"
	"\167\352\122\302\100\221\077\125\205\333\131\214\174\215\056\314"
	"\075\034\345\123\205\173\132\332\014\343\261\153\101\270\070\047"
	"\106\070\071\002\074\341\162\151\214\377\004\112\256\142\022\351"
	"\072\345\267\133\330\043\240\017\151\167\312\114\062\132\015\010"
	"\252\224\210\124\356\021\333\302\132\163\251\253\311\156\270\213"
	"\011\046\254\003\352\167\376\174\207\054\326\117\251\346\162\003"
	"\320\226\362\121\345\345\172\044\143\021\014\063\312\151\111\104"
	"\374\317\243\134\271\001\166\123\102\206\012\157\076\360\175\147"
	"\065\356\210\175\223\316\250\077\211\367\066\127\335\100\147\167"
	"\072\106\310\057\323\034\321\314\252\117\013\336\114\327\136\144"
	"\272\007\336\310\065\122\215\173\376\171\024\033\252\344\210\202"
	"\325\372\266\217\265\141\213\045\126\230\157\336\006\074\313\255"
	"\340\041\364\214\175\221\215\205\361\313\266\240\061\052\264\134"
	"\036\103\363\004\055\342\042\050\045\015\240\374\245\072\243\221"
	"\060\326\337\367\215\214\304\024\107\217\003\364\050\136\104\267"
	"\045\265\043\226\277\272\375\133\356\222\362\117\322\126\000\024"
	"\257\050\147\333\176\274\322\341\361\325\122\022\025\270\136\223"
	"\062\105\311\171\363\247\343\035\232\146\306\251\111\362\263\150"
	"\206\256\056\357\335\027\373\200\220\217\253\112\001\272\134\267"
	"\270\346\351\316\041\016\043\071\106\360\033\046\377\146\264\022"
	"\050\306\305\331\170\254\010\006\355\175\231\302\046\203\210\146"
	"\074\174\141\036\036\165\121\312\123\242\274\021\101\307\204\056"
	"\211\174\161\123\320\351\245\230\344\044\356\033\020\250\031\171"
	"\014\070\235\363\362\017\236\004\002\235\015\064\175\172\005\024"
	"\025\362\056\240\315\276\021\315\346\017\100\301\100\122\262\252"
	"\122\013\266\367\165\115\335\026\016\253\153\106\267\236\215\101"
	"\313\277\366\144\122\322\007\020\075\132\035\366\320\070\101\215"
	"\077\304\362\206\255\056\365\255\244\171\251\067\104\076\026\041"
	"\020\274\135\351\013\137\166\174\055\303\213\320\007\137\116\175"
	"\202\127\174\346\171\051\243\271\375\177\054\137\247\010\115\124"
	"\135\377\351\270\170\232\237\114\105\310\263\305\364\024\171\007"
	"\172\341\325\022\310\341\047\206\272\217\157\121\167\120\311\256"
	"\122\263\270\235\011\262\116\012\000\255\351\112\222\012\024\177"
	"\230\105\075\210\037\236\051\124\073\011\251\045\174\214\254\244"
	"\252\120\060\255\005\124\127\272\152\242\324\113\070\324\162\360"
	"\237\273\153\342\015\310\035\361\106\231\366\313\204\176\325\031"
	"\113\130\153\122\047\343\167\145\275\377\362\067\214\107\275\170"
	"\045\206\214\005\063\257\153\057\075\321\302\250\356\056\236\222"
	"\046\162\000\260\260\322\017\356\204\125\173\276\067\122\211\105"
	"\217\273\163\151\207\063\074\027\013\202\060\056\050\306\350\231"
	"\236\161\115\142\171\355\001\132\034\062\376\345\170\374\106\213"
	"\277\333\331\022\311\302\106\262\211\035\123\261\171\344\176\022"
	"\001\256\201\145\352\011\364\372\112\351\314\033\222\104\200\140"
	"\116\307\217\266\223\072\172\121\347\025\303\121\362\267\154\141"
	"\127\110\241\340\064\106\253\102\041\037\075\336\014\076\007\017"
	"\250\036\137\350\274\016\152\244\050\371\065\365\347\275\271\144"
	"\065\222\055\030\200\300\120\363\001\220\046\263\317\271\171\311"
	"\257\273\073\060\206\151\100\115\267\066\060\135\153\154\135\001"
	"\104\373\112\215\351\134\102\165\262\257\104\215\342\053\317\257"
	"\221\156\331\207\041\240\261\056\210\053\205\326\101\133\221\271"
	"\320\013\000\334\072\172\070\163\121\346\272\151\122\144\163\232"
	"\041\325\113\011\070\350\135\155\340\162\154\231\041\072\024\227"
	"\243\203\141\143\104\147\327\156\177\370\146\117\140\073\137\375"
	"\170\272\113\341\011\241\066\141\170\175\320\175\161\016\070\055"
	"\110\271\121\131\271\333\012\027\046\215\046\330\032\046\136\263"
	"\341\002\171\144\136\140\051\243\303\137\250\076\060\226\336\020"
	"\355\040\022\176\074\346\324\241\001\203\032\132\217\206\247\120"
	"\072\243\035\351\102\162\111\352\161\136\024\173\316\177\011\073"
	"\261\027\376\067\153\027\037\134\134\352\356\107\226\242\057\031"
	"\205\147\106\111\203\312\100\251\007\237\137\323\247\225\014\356"
	"\245\117\344\370\267\216\344\065\357\052\270\014\026\265\151\176"
	"\347\277\353\034\114\275\360\067\024\344\225\061\131\172\140\160"
	"\115\350\106\040\062\317\357\113\215\342\233\045\164\340\075\112"
	"\074\070\275\241\067\365\164\334\370\301\312\345\232\054\363\361"
	"\125\321\047\015\310\356\034\003\260\216\370\121\242\236\340\342"
	"\165\266\325\141\220\356\254\333\114\172\047\352\056\102\322\257"
	"\057\205\234\100\220\020\374\032\342\370\062\125\166\324\171\023"
	"\307\101\333\316\122\054\051\137\022\116\251\276\242\220\013\164"
	"\217\031\147\322\211\010\101\372\035\163\203\071\035\267\032\244"
	"\234\035\226\135\016\203\365\163\176\172\333\117\072\212\362\204"
	"\232\156\374\276\222\272\155\257\325\033\202\112\006\046\151\265"
	"\235\021\070\345\152\000\313\360\336\211\013\071\370\302\160\116"
	"\376\133\267\247\347\330\122\314\164\020\221\332\130\115\150\043"
	"\234\313\315\200\106\252\315\251\363\366\174\056\013\122\070\160"
	"\220\020\352\047\072\224\072\321\076\276\036\203\040\276\241\046"
	"\314\017\004\333\172\147\256\264\051\022\046\166\070\315\310\144"
	"\145\225\317\351\061\143\246\214\042\360\150\161\140\064\374\054"
	"\171\170\016\050\331\250\344\302\350\332\375\320\247\121\011\233"
	"\302\370\052\317\127\002\300\231\013\326\125\142\014\341\175\152"
	"\132\261\155\251\365\164\270\013\161\001\365\000\244\226\330\205"
	"\366\014\362\332\213\067\373\362\141\263\237\136\272\040\115\373"
	"\000\150\250\121\323\052\010\053\034\216\034\045\205\375\015\152"
	"\072\173\016\230\257\332\371\066\362\026\047\244\337\306\130\301"
	"\225\250\205\177\114\364\064\047\214\221\225\224\145\035\250\234"
	"\365\314\022\216\010\136\026\262\204\161\221\001\031\365\275\142"
	"\336\266\146\360\343\216\237\211\262\277\157\237\344\066\315\156"
	"\370\245\207\056\177\224\302\171\027\115\012\175\036\106\372\111"
	"\105\347\251\335\177\103\360\270\213\336\260\235\066\032\156\124"
	"\226\257\153\331\303\075\142\231\372\133\136\153\142\115\033\022"
	"\140\050\132\166\230\311\375\325\150\152\152\152\263\127\005\244"
	"\233\120\001\365\116\123\036\215\250\024\212\222\323\057\241\361"
	"\275\255\067\165\074\312\206\372\026\075\317\273\016\330\331\300"
	"\012\234\175\275\275\032\364\327\201\317\325\125\164\040\201\200"
	"\310\140\347\123\341\256\216\273\167\357\263\320\364\172\200\147"
	"\357\064\226\072\353\027\153\075\176\124\155\272\225\041\073\267"
	"\346\033\251\307\037\012\265\032\365\260\236\236\151\126\250\020"
	"\115\064\337\053\004\324\015\112\046\263\164\216\353\027\112\357"
	"\151\321\063\360\125\365\165\146\234\020\306\302\046\226\064\372"
	"\262\277\276\277\052\251\017\245\151\222\367\147\051\355\222\364"
	"\166\267\060\013\102\334\171\274\132\341\112\024\305\061\302\246"
	"\110\012\162\352\252\227\062\026\031\020\220\315\036\077\246\154"
	"\102\161\177\015\042\104\062\270\332\243\270\137\004\243\055\155"
	"\005\301\025\240\271\344\313\122\076\105\032\141\014\235\305\164"
	"\313\115\176\066\213\243\126\106\161\370\274\271\346\137\307\222"
	"\007\357\026\033\037\363\207\106\004\254\332\046\371\242\353\046"
	"\327\111\055\026\107\250\173\034\127\367\267\070\133\327\151\256"
	"\066\275\042\326\375\154\326\133\017\367\064\310\337\222\121\004"
	"\151\025\360\111\164\261\022\131\352\016\127\074\223\345\121\212"
	"\335\253\064\055\125\167\236\165\076\336\351\302\152\020\134\321"
	"\234\234\156\060\113\125\370\105\307\262\272\353\337\327\346\005"
	"\003\107\266\172\060\030\053\272\166\117\100\236\124\144\300\044"
	"\366\036\243\062\043\365\060\035\245\333\262\003\023\134\365\234"
	"\216\117\270\275\013\321\245\043\042\025\213\146\264\002\025\115"
	"\313\007\063\062\364\143\062\117\366\364\071\017\136\202\251\320"
	"\161\010\166\340\100\001\241\267\235\300\346\252\234\101\150\067"
	"\041\212\124\247\005\356\022\143\354\347\332\337\020\026\171\006"
	"\135\167\176\170\015\132\266\052\233\372\142\044\231\204\205\072"
	"\101\007\171\323\121\060\160\032\110\032\365\375\057\161\176\300"
	"\052\151\223\246\227\363\102\342\353\061\314\142\164\046\341\227"
	"\377\245\251\035\334\334\201\077\322\375\037\022\304\155\017\151"
	"\246\162\014\253\347\353\037\016\040\037\037\347\004\313\055\111"
	"\066\076\076\360\042\375\364\054\164\345\101\314\226\072\033\130"
	"\255\276\031\100\237\136\344\323\264\311\245\104\263\233\117\201"
	"\170\073\304\064\255\334\121\321\032\066\216\231\073\040\134\220"
	"\372\301\150\254\002\316\164\054\044\305\266\046\265\137\063\076"
	"\305\215\013\122\340\327\313\137\173\155\302\333\114\173\204\234"
	"\135\240\265\053\213\263\323\007\351\370\005\325\304\224\074\271"
	"\113\222\171\365\132\206\117\123\176\341\127\071\203\071\041\302"
	"\210\011\376\270\310\020\177\242\024\357\076\164\304\347\107\375"
	"\205\034\151\176\207\171\244\364\374\200\054\146\215\211\360\170"
	"\274\306\354\243\121\342\123\044\306\131\305\253\071\273\372\152"
	"\170\101\265\056\303\330\126\037\145\373\120\141\127\270\117\341"
	"\312\055\005\346\250\075\076\000\217\075\135\364\126\132\307\164"
	"\056\203\050\255\117\317\263\373\016\003\240\101\170\230\007\062"
	"\335\106\124\146\277\352\040\236\324\171\360\160\052\335\024\326"
	"\157\336\057\210\143\215\147\313\066\046\014\360\226\143\033\151"
	"\172\015\163\256\311\346\005\255\364\226\045\057\242\151\055\271"
	"\015\316\205\153\270\367\345\027\264\166\352\072\004\334\126\072"
	"\157\025\113\002\005\326\326\226\336\055\036\064\007\101\041\344"
	"\117\031\034\322\225\153\136\122\366\316\126\027\000\317\140\066"
	"\244\121\225\131\131\030\160\021\341\270\265\202\330\374\373\074"
	"\316\244\240\060\020\376\203\006\315\332\036\316\252\177\004\116"
	"\320\232\250\052\263\030\073\225\320\361\030\251\356\023\346\274"
	"\270\206\355\310\205\161\317\122\113\355\040\365\154\045\104\075"
	"\300\355\147\164\006\243\011\326\224\042\200\203\065\147\100\356"
	"\355\055\267\163\237\206\305\352\163\346\340\337\013\045\035\314"
	"\022\204\100\030\050\112\357\275\154\160\100\242\327\200\220\304"
	"\256\110\067\116\316\375\070\101\343\030\041\357\075\076\274\120"
	"\303\374\150\354\107\130\251\263\310\352\126\237\153\347\144\032"
	"\057\233\150\375\231\240\077\175\271\141\154\367\240\051\110\143"
	"\046\261\120\155\011\371\041\321\344\167\160\117\136\324\151\216"
	"\160\322\214\012\162\313\207\054\054\364\044\314\035\154\060\103"
	"\035\200\261\046\172\322\370\136\112\151\256\251\076\030\067\256"
	"\352\303\270\135\217\100\211\274\064\256\211\122\032\272\226\070"
	"\072\107\137\265\032\130\024\144\301\302\016\377\332\106\256\305"
	"\012\146\042\231\247\253\126\333\132\337\055\164\231\304\255\324"
	"\013\015\212\045\145\236\212\046\141\231\045\074\337\323\001\351"
	"\072\043\203\341\317\331\275\051\271\353\236\123\257\114\047\273"
	"\131\261\341\276\120\153\344\262\005\012\357\344\335\360\316\030"
	"\024\121\371\344\053\267\016\345\242\254\070\122\370\137\015\122"
	"\021\356\020\142\132\364\025\137\376\004\104\334\365\022\364\012"
	"\144\356\356\220\245"
#define      chk2_z	19
#define      chk2	((&data[5913]))
	"\251\255\343\307\057\060\166\204\021\070\156\110\261\342\247\077"
	"\375\225\065\241\017\232"
#define      msg2_z	19
#define      msg2	((&data[5933]))
	"\307\353\106\055\075\251\212\042\175\326\150\254\321\206\143\326"
	"\203\135\210\364\037\226"
#define      pswd_z	256
#define      pswd	((&data[5988]))
	"\371\227\120\370\234\224\325\221\246\312\233\013\270\212\233\136"
	"\207\020\246\060\276\101\323\314\351\310\354\200\315\156\161\307"
	"\006\145\352\025\110\204\017\246\370\347\073\352\223\121\352\362"
	"\142\000\120\132\332\006\007\010\141\341\050\143\013\017\367\052"
	"\165\341\077\275\146\116\144\136\065\240\111\310\362\064\272\124"
	"\064\013\257\017\021\266\030\162\227\100\326\243\120\316\315\305"
	"\257\014\203\025\133\347\163\220\210\275\131\172\361\024\317\046"
	"\037\176\065\061\064\115\244\314\216\173\157\336\111\075\243\370"
	"\112\046\016\245\016\201\066\226\077\220\021\060\244\340\126\304"
	"\137\214\365\224\331\231\140\147\024\320\105\135\015\351\126\127"
	"\017\144\375\035\346\063\263\045\303\304\126\150\245\254\054\004"
	"\070\041\230\022\273\371\172\320\311\300\055\327\251\204\056\270"
	"\350\054\325\317\140\211\364\043\116\113\214\363\367\271\370\060"
	"\332\221\103\226\212\275\146\124\175\224\053\047\030\132\337\001"
	"\206\265\320\346\076\305\012\215\020\227\200\010\120\171\071\053"
	"\012\174\301\225\072\050\351\270\274\025\337\325\157\276\326\366"
	"\164\247\335\263\154\350\100\175\177\301\205\317\072\276\373\105"
	"\073\275\332\165\345\304\055\241\331\014\166\110\313\115\077\077"
	"\364\301\300\242\125\225\063\374\137\317\010\030\131\243\166\340"
	"\264\034\021\162\136\345\077\107\255\053\307\172\231\071\101\237"
	"\372\001\101\120\226\165\115\366\104\125\016\235\370\204\176\255"
	"\241\217\040\000\165\137\107\042\212\017\234\044\110\335"
#define      opts_z	1
#define      opts	((&data[6305]))
	"\137"
#define      date_z	1
#define      date	((&data[6306]))
	"\273"
#define      tst1_z	22
#define      tst1	((&data[6312]))
	"\277\066\173\135\057\243\003\140\212\222\074\263\340\000\315\120"
	"\331\332\132\156\124\133\172\177\357\273\141\000\334"
#define      tst2_z	19
#define      tst2	((&data[6339]))
	"\374\242\341\374\170\002\373\120\221\225\000\125\053\046\232\235"
	"\126\360\133\244\076\254\133\352"
#define      lsto_z	1
#define      lsto	((&data[6360]))
	"\031"
#define      rlax_z	1
#define      rlax	((&data[6361]))
	"\034"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
