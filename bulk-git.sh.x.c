#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -H -f bulk-git.sh -o teste 
#endif

static  char data [] = 
#define      shll_z	10
#define      shll	((&data[1]))
	"\121\353\330\326\211\016\226\202\164\074\154\212\127"
#define      inlo_z	3
#define      inlo	((&data[13]))
	"\137\270\054"
#define      tst2_z	19
#define      tst2	((&data[16]))
	"\007\013\203\224\320\077\143\105\216\231\301\024\145\002\121\202"
	"\247\047\357\055"
#define      lsto_z	1
#define      lsto	((&data[36]))
	"\037"
#define      chk2_z	19
#define      chk2	((&data[41]))
	"\226\104\203\274\257\260\202\175\170\037\220\345\357\360\052\145"
	"\137\000\206\144\246\273\105\026"
#define      pswd_z	256
#define      pswd	((&data[97]))
	"\325\046\340\271\134\163\265\256\375\015\366\357\242\342\012\333"
	"\017\173\256\013\161\211\143\007\315\347\303\344\351\122\232\276"
	"\171\172\170\326\340\127\026\265\124\144\044\055\040\225\337\216"
	"\056\063\237\133\175\225\210\302\027\235\241\051\320\250\311\161"
	"\251\274\242\211\023\270\076\150\034\143\226\074\370\166\313\047"
	"\251\153\203\047\000\014\351\030\251\212\102\171\062\014\353\333"
	"\310\215\145\334\106\244\105\143\010\333\237\000\122\153\050\374"
	"\327\254\043\327\270\014\360\141\227\063\333\312\077\306\246\010"
	"\124\013\345\232\260\053\375\270\007\235\271\131\011\341\125\340"
	"\215\170\270\106\205\251\247\034\334\202\347\034\111\215\044\235"
	"\231\012\070\111\065\066\001\074\323\272\226\334\234\353\275\052"
	"\143\165\160\351\036\030\005\372\233\354\027\344\172\073\202\023"
	"\106\272\134\173\360\136\270\304\031\116\241\265\072\136\340\235"
	"\323\121\207\361\151\214\354\005\171\003\351\363\077\154\006\205"
	"\046\143\001\027\301\272\333\332\010\174\220\103\332\160\340\255"
	"\301\150\237\053\364\213\060\156\216\032\141\316\206\150\123\254"
	"\313\125\303\215\017\237\147\030\033\367\133\365\147\074\243\051"
	"\244\102\125\231\315\205\007\134\237\151\052\046\322\176\323\236"
	"\324\227\053\343\356\056\205\353\074\173\332\336\136\345\272\155"
	"\140\151\171\321\362\335\330\300\304\234\245\255\357\077\154\150"
	"\272\345\076\250\023\303\224\120\077\157\057\235\124\351\013\265"
	"\123\205"
#define      tst1_z	22
#define      tst1	((&data[400]))
	"\137\332\162\317\113\116\254\063\126\261\273\233\061\145\332\352"
	"\170\067\364\265\076\007\342\007\047"
#define      msg1_z	65
#define      msg1	((&data[435]))
	"\352\354\101\123\247\047\221\120\072\125\344\034\017\070\124\330"
	"\152\261\305\312\314\034\243\311\056\142\066\131\002\136\272\177"
	"\141\041\035\045\275\342\054\264\256\063\022\251\335\353\166\041"
	"\247\355\324\307\353\241\265\033\352\236\151\215\377\253\352\001"
	"\107\375\271\006\133\067\162\317\121\063\342\361\213\225\123\272"
	"\063\250\243\077\135\367\305\343\075\047"
#define      xecc_z	15
#define      xecc	((&data[515]))
	"\077\340\170\364\376\332\204\015\231\121\062\235\101\320\336\221"
	"\361"
#define      date_z	1
#define      date	((&data[531]))
	"\245"
#define      chk1_z	22
#define      chk1	((&data[534]))
	"\215\017\300\161\142\045\125\174\244\022\257\266\013\023\206\154"
	"\361\176\046\013\013\072\156\161\325\310\144"
#define      rlax_z	1
#define      rlax	((&data[559]))
	"\334"
#define      msg2_z	19
#define      msg2	((&data[560]))
	"\344\172\365\172\333\275\257\035\301\300\204\220\026\005\011\246"
	"\154\172\357"
#define      opts_z	1
#define      opts	((&data[579]))
	"\250"
#define      text_z	5200
#define      text	((&data[1441]))
	"\366\347\133\071\053\252\170\035\317\242\373\066\037\201\304\056"
	"\126\215\223\020\341\216\036\357\275\323\241\053\346\112\136\334"
	"\062\271\026\136\144\217\173\063\062\167\151\122\370\056\201\117"
	"\273\025\140\234\243\176\213\140\122\054\213\070\167\352\025\251"
	"\243\054\007\007\274\203\073\356\373\245\101\363\323\302\103\217"
	"\327\244\053\172\043\266\333\165\343\147\256\133\121\304\005\364"
	"\360\015\374\254\220\070\233\213\336\334\177\262\236\303\101\165"
	"\147\154\360\212\043\314\000\006\063\257\142\204\163\147\171\144"
	"\164\165\020\005\256\254\220\214\210\020\077\047\323\200\235\073"
	"\354\215\306\020\131\307\027\215\166\171\021\352\341\212\116\126"
	"\000\137\133\256\013\354\073\223\374\172\273\320\372\130\014\347"
	"\346\323\370\077\232\017\314\021\211\336\373\152\150\111\300\150"
	"\250\034\027\263\010\122\107\005\315\002\326\310\132\342\260\100"
	"\265\250\200\120\270\115\141\101\053\134\254\224\246\155\375\116"
	"\211\024\002\222\147\111\227\064\113\155\375\246\120\255\347\005"
	"\126\147\126\016\265\267\120\341\024\374\165\272\152\162\010\363"
	"\207\012\205\356\124\035\043\240\212\040\106\332\315\056\340\043"
	"\226\066\062\113\356\202\055\002\176\242\274\351\025\305\334\235"
	"\320\142\213\044\177\256\304\012\317\013\345\234\071\306\300\317"
	"\375\362\033\353\164\110\356\363\353\253\334\001\160\271\236\100"
	"\034\052\144\234\331\051\246\250\064\214\105\155\122\005\075\117"
	"\370\130\073\155\241\051\141\214\324\076\215\105\370\053\205\024"
	"\126\352\260\057\023\127\327\110\343\034\266\066\042\363\205\033"
	"\113\301\210\354\352\352\171\277\050\007\005\040\063\212\065\211"
	"\165\345\270\211\075\217\321\040\254\207\126\316\173\334\351\307"
	"\235\162\264\210\134\055\110\205\064\115\246\147\330\333\360\116"
	"\301\250\327\376\070\251\037\344\061\166\263\254\122\235\163\360"
	"\017\047\171\154\125\301\362\211\016\230\361\347\164\342\065\066"
	"\212\014\064\303\266\124\247\347\312\133\224\034\370\010\015\010"
	"\060\206\165\205\107\147\017\126\000\001\075\165\343\162\253\156"
	"\177\340\061\065\064\331\035\376\064\262\033\055\272\050\065\353"
	"\256\253\160\365\023\200\113\023\201\211\210\145\373\064\323\173"
	"\024\005\261\110\336\316\106\023\201\141\100\073\212\166\046\070"
	"\041\227\055\064\030\171\110\231\003\321\377\377\005\322\172\031"
	"\327\053\142\265\372\250\311\173\012\011\267\224\200\336\315\241"
	"\165\373\326\215\165\036\047\170\360\046\167\365\371\362\017\320"
	"\035\161\206\030\032\117\224\045\131\113\271\331\051\207\173\237"
	"\202\122\055\367\160\124\157\140\173\347\126\164\331\145\105\367"
	"\326\314\020\360\034\244\025\165\357\317\117\031\126\313\270\331"
	"\035\346\320\216\072\100\357\266\047\105\053\000\253\160\370\202"
	"\075\010\163\131\254\211\317\234\130\037\266\257\352\157\211\010"
	"\125\131\226\220\231\206\106\301\313\162\302\167\343\272\371\040"
	"\303\154\172\160\365\111\015\116\151\303\376\124\062\207\134\210"
	"\341\363\030\173\171\137\074\105\321\377\274\264\272\265\325\175"
	"\042\117\356\027\230\373\146\001\277\144\125\361\354\262\172\315"
	"\245\222\111\037\362\206\144\303\205\041\170\077\327\115\275\371"
	"\234\254\021\065\247\167\067\146\334\215\130\311\077\322\226\345"
	"\145\340\004\130\146\151\034\354\212\224\054\141\342\351\133\176"
	"\225\154\264\075\344\353\244\301\170\374\212\270\317\041\236\065"
	"\001\243\216\150\014\252\124\227\076\200\371\040\152\125\237\000"
	"\301\123\075\246\077\341\150\270\336\362\161\256\023\017\344\025"
	"\262\162\175\277\034\321\127\133\121\120\174\273\245\033\273\147"
	"\157\371\016\257\333\166\147\271\150\331\150\174\350\114\221\233"
	"\276\017\133\333\341\262\066\062\002\262\356\250\316\175\042\010"
	"\127\101\337\174\147\316\200\151\147\345\363\135\212\077\311\326"
	"\207\356\107\112\027\117\312\166\101\043\062\257\300\323\264\337"
	"\212\240\236\226\027\314\122\106\376\054\372\030\076\367\371\340"
	"\012\061\171\266\217\346\167\354\023\103\103\135\357\065\322\037"
	"\023\327\222\027\377\324\053\040\166\136\235\014\061\312\333\153"
	"\373\140\236\340\116\200\275\330\243\064\050\300\137\335\274\132"
	"\212\177\356\036\335\364\237\007\035\302\345\075\222\001\364\235"
	"\332\040\114\307\023\231\064\023\234\077\124\263\204\306\270\143"
	"\222\342\140\246\111\102\325\067\033\262\265\344\075\215\243\024"
	"\062\311\342\330\007\057\057\331\276\336\326\330\144\337\371\267"
	"\202\162\367\022\323\102\244\010\073\333\264\071\104\210\347\165"
	"\244\130\366\360\103\026\131\301\113\166\361\055\174\351\222\047"
	"\365\234\357\022\122\072\353\200\165\247\262\257\211\024\110\220"
	"\254\064\135\262\220\346\016\105\256\376\022\234\165\112\006\033"
	"\226\012\233\267\003\377\337\262\076\225\170\044\267\257\307\215"
	"\055\376\111\102\323\265\204\131\126\144\351\266\132\312\270\200"
	"\125\102\321\023\360\116\215\203\237\226\344\036\215\157\333\267"
	"\242\164\315\251\160\347\163\377\304\072\134\056\020\151\214\014"
	"\125\163\151\214\311\100\371\327\010\164\241\366\234\307\314\366"
	"\240\226\061\304\251\331\334\073\115\315\077\165\114\101\364\327"
	"\316\032\035\267\244\353\246\302\317\041\165\305\147\033\273\345"
	"\370\001\035\232\050\077\277\057\355\103\351\221\027\265\216\375"
	"\370\055\033\013\024\226\154\360\271\337\367\334\210\344\047\326"
	"\264\251\376\374\212\332\204\135\054\024\216\220\202\340\107\306"
	"\302\313\161\020\033\153\037\255\226\146\105\325\162\167\101\166"
	"\203\064\123\204\376\040\107\150\224\356\024\001\250\325\334\376"
	"\342\077\372\041\111\150\057\051\242\376\374\145\052\103\214\173"
	"\314\062\123\330\110\317\175\031\134\266\177\211\161\057\040\246"
	"\325\352\273\304\050\350\004\002\002\211\366\151\020\025\224\304"
	"\041\334\050\200\236\372\140\337\370\026\135\136\323\354\205\246"
	"\340\264\337\072\147\063\263\117\023\062\257\213\160\146\111\035"
	"\323\121\014\372\227\203\052\331\363\175\336\160\326\155\233\270"
	"\345\267\073\070\026\225\117\134\162\147\312\274\354\357\223\142"
	"\047\344\017\256\262\003\132\144\051\357\127\306\022\270\304\041"
	"\320\373\022\313\354\270\103\042\366\046\032\361\257\276\271\372"
	"\155\013\226\071\005\161\257\346\136\007\302\343\367\313\023\305"
	"\151\364\167\324\100\126\066\033\253\255\062\345\034\364\330\057"
	"\050\142\377\067\302\307\273\040\034\372\334\052\150\061\253\215"
	"\314\312\226\140\160\236\122\033\105\371\273\312\050\335\334\315"
	"\020\102\101\171\165\020\365\317\332\026\011\165\337\110\202\356"
	"\162\121\057\204\365\254\370\014\047\221\025\031\011\113\377\062"
	"\024\125\176\174\037\067\151\034\061\334\141\113\256\365\024\231"
	"\243\322\045\021\051\156\063\137\135\307\260\264\037\207\170\131"
	"\213\146\166\232\015\346\066\070\066\231\247\045\325\240\215\110"
	"\027\011\235\372\340\136\062\304\364\303\022\100\067\117\226\015"
	"\015\023\056\215\072\171\025\045\142\026\031\014\223\266\305\225"
	"\032\027\321\167\174\340\111\073\050\351\205\376\003\007\232\011"
	"\057\013\346\210\206\054\123\007\134\114\166\250\016\035\372\051"
	"\144\236\203\362\067\374\240\335\213\161\377\102\236\360\053\062"
	"\200\225\116\311\232\201\342\155\330\003\077\077\104\075\221\363"
	"\322\002\144\113\212\142\215\154\221\206\060\073\322\131\341\315"
	"\016\053\043\066\036\225\366\271\121\311\121\264\164\376\077\260"
	"\101\232\045\122\325\360\342\252\216\071\106\317\125\103\160\225"
	"\317\202\010\147\043\026\321\120\073\050\072\017\226\352\056\226"
	"\021\146\152\333\256\226\147\160\356\162\343\102\110\154\257\116"
	"\100\135\145\374\207\113\302\016\324\021\026\116\124\005\165\173"
	"\156\141\310\343\252\130\333\314\232\261\355\040\043\136\243\165"
	"\363\277\256\270\325\245\242\122\217\272\147\243\154\153\254\302"
	"\221\127\273\343\173\047\024\163\376\052\203\013\262\145\023\162"
	"\163\153\101\170\015\127\021\051\317\111\304\124\261\326\217\375"
	"\321\155\022\207\021\160\347\226\106\243\304\153\164\116\331\020"
	"\300\146\347\312\330\100\133\264\200\373\254\266\061\130\321\353"
	"\137\177\046\042\270\274\252\361\045\352\140\211\046\132\002\075"
	"\003\047\237\304\037\137\316\327\235\001\372\355\222\261\175\340"
	"\010\163\313\134\123\331\346\141\252\054\070\203\144\077\334\272"
	"\071\170\147\306\345\223\360\342\124\373\073\214\325\264\276\166"
	"\020\062\175\323\303\364\145\217\234\211\101\332\205\161\342\052"
	"\172\146\047\254\113\205\011\350\131\313\251\267\051\026\240\234"
	"\352\315\166\327\301\245\164\004\347\036\035\040\215\171\300\356"
	"\043\347\341\115\202\132\257\233\200\143\003\306\313\143\005\043"
	"\365\115\364\373\346\276\071\070\200\151\011\332\356\312\213\001"
	"\363\163\135\270\373\315\146\075\267\022\325\300\372\321\006\247"
	"\215\172\206\114\353\264\141\251\345\327\072\100\321\017\076\346"
	"\230\315\204\374\111\060\123\372\011\211\066\366\356\040\037\241"
	"\151\115\203\354\072\147\047\006\151\017\217\333\101\262\305\344"
	"\255\157\313\131\116\227\226\221\107\215\345\204\157\244\011\227"
	"\334\212\255\246\203\311\107\134\201\014\327\267\265\010\114\363"
	"\273\044\270\150\072\261\356\030\147\134\245\324\162\054\204\004"
	"\041\251\312\222\112\142\244\210\171\202\314\217\303\066\342\365"
	"\355\115\266\005\315\266\046\202\355\215\375\235\166\000\371\173"
	"\017\137\354\254\024\247\104\143\341\040\376\333\267\107\067\106"
	"\256\006\274\227\160\372\074\237\032\174\132\337\107\114\040\175"
	"\315\164\211\040\045\121\027\155\121\111\327\375\103\063\142\343"
	"\361\323\134\227\077\302\126\373\270\017\223\207\012\050\347\173"
	"\370\051\077\201\336\375\163\030\064\347\234\217\205\301\210\203"
	"\307\177\160\327\123\253\264\246\252\313\145\057\341\174\321\237"
	"\065\202\155\342\130\317\010\124\041\334\317\155\303\072\250\134"
	"\156\227\010\054\054\013\136\153\333\223\214\225\100\205\321\335"
	"\107\330\350\077\354\334\156\010\072\321\041\025\225\213\223\060"
	"\332\012\016\041\212\063\215\026\273\264\300\004\165\262\123\151"
	"\076\223\024\150\143\330\063\113\313\326\012\172\037\041\136\064"
	"\072\304\014\164\142\114\370\330\272\264\011\232\345\134\254\274"
	"\303\035\213\356\040\104\341\054\026\272\155\132\363\262\170\121"
	"\253\322\315\003\042\172\357\063\162\234\037\377\020\220\105\247"
	"\013\202\051\024\123\030\253\040\242\247\115\165\025\034\064\237"
	"\336\174\035\263\042\176\077\237\246\141\136\237\146\215\101\232"
	"\223\157\250\014\250\127\204\160\176\331\046\117\265\111\336\312"
	"\115\111\134\251\365\204\120\126\307\255\002\043\102\213\055\353"
	"\227\226\210\142\110\047\351\001\264\175\234\077\211\320\323\133"
	"\176\366\037\003\365\335\364\146\253\364\303\077\354\242\270\227"
	"\225\205\217\122\065\106\100\316\351\020\300\270\344\067\332\361"
	"\272\330\206\323\262\114\347\321\002\241\116\300\333\343\374\104"
	"\315\061\113\227\371\216\155\033\276\305\120\350\214\034\133\056"
	"\371\043\335\062\261\147\014\203\106\113\176\034\165\211\102\271"
	"\161\350\147\134\234\222\274\106\216\152\111\277\173\277\307\172"
	"\374\005\033\025\153\167\350\043\207\262\144\151\325\113\314\027"
	"\073\251\177\075\256\020\164\354\060\042\206\012\307\305\151\057"
	"\334\364\200\226\014\240\307\072\046\361\050\330\044\107\057\235"
	"\206\216\032\225\026\160\344\154\256\342\362\012\267\253\201\256"
	"\334\105\025\127\257\143\112\220\016\063\154\260\356\235\037\311"
	"\301\320\060\337\144\326\140\021\024\055\230\033\074\364\213\106"
	"\351\156\136\061\000\107\003\262\067\264\171\034\343\044\022\350"
	"\170\117\121\216\031\120\102\117\137\330\013\111\101\212\363\122"
	"\012\242\300\275\144\202\241\233\043\312\311\327\067\350\301\367"
	"\051\260\021\044\325\100\147\217\231\226\256\225\214\240\332\027"
	"\302\331\071\203\015\307\041\033\275\231\272\305\111\365\343\265"
	"\364\220\272\277\262\166\344\171\326\027\145\001\132\060\054\143"
	"\055\113\275\074\210\052\011\051\143\036\246\360\376\025\146\322"
	"\177\013\052\133\006\202\303\276\222\250\042\306\237\252\071\121"
	"\020\312\115\036\170\310\117\027\152\271\256\054\002\231\102\312"
	"\007\324\176\117\005\034\203\340\002\365\270\371\242\233\326\067"
	"\343\133\345\103\230\174\250\051\312\165\350\064\037\074\250\262"
	"\137\135\241\204\244\234\124\263\120\307\367\255\120\047\261\371"
	"\135\227\206\042\022\230\360\176\351\242\024\267\174\106\314\377"
	"\131\352\200\164\371\366\071\156\002\321\271\317\201\316\161\371"
	"\311\354\044\016\351\364\376\146\215\172\136\115\274\316\005\034"
	"\157\175\330\247\024\370\142\033\224\107\204\371\125\165\102\002"
	"\300\344\013\247\120\153\002\331\350\227\144\266\155\134\371\202"
	"\211\235\141\277\051\305\223\003\121\366\247\103\215\225\324\267"
	"\115\175\071\034\302\137\055\103\222\200\266\240\003\230\124\256"
	"\326\054\244\216\252\372\021\010\160\216\270\021\031\031\340\232"
	"\232\261\247\225\314\222\142\027\360\011\062\070\044\112\237\175"
	"\210\335\215\354\154\155\176\275\351\167\030\361\117\206\006\140"
	"\256\113\337\301\372\004\222\170\040\041\061\227\271\156\125\100"
	"\217\155\265\045\166\015\103\043\247\134\327\377\254\274\007\301"
	"\071\147\263\045\350\032\305\134\303\361\105\233\164\075\320\351"
	"\117\025\305\042\075\272\307\253\131\010\041\333\071\223\002\114"
	"\154\117\105\157\227\351\047\374\013\116\345\041\255\212\345\360"
	"\312\032\245\263\143\247\202\214\222\357\221\245\346\315\042\007"
	"\347\333\223\357\166\365\303\103\013\225\011\123\114\366\232\323"
	"\234\001\331\000\214\313\036\342\067\217\173\051\252\361\367\135"
	"\043\033\142\103\203\072\100\016\252\171\233\136\230\120\324\342"
	"\062\007\067\257\357\161\163\160\235\303\054\151\321\032\256\231"
	"\177\173\011\154\002\264\351\245\256\310\153\131\217\275\363\331"
	"\170\174\014\044\062\041\337\337\044\044\377\262\214\160\233\155"
	"\306\125\362\256\002\331\112\056\030\135\144\227\036\065\265\273"
	"\367\051\151\002\055\235\236\165\235\162\305\306\123\271\020\371"
	"\342\374\313\313\333\134\214\343\350\377\002\147\315\367\201\245"
	"\204\376\360\124\341\011\141\302\015\337\141\127\333\316\272\352"
	"\165\051\375\041\202\240\364\375\101\243\251\377\114\262\346\371"
	"\116\176\310\245\170\034\166\226\042\203\050\047\340\131\031\341"
	"\364\113\071\123\037\067\121\243\351\003\273\063\255\044\310\145"
	"\334\202\230\065\302\072\337\130\207\337\205\303\031\205\170\076"
	"\206\260\316\325\337\020\024\060\162\101\342\223\257\274\345\227"
	"\360\007\043\024\046\036\270\003\324\333\042\335\004\116\052\322"
	"\043\140\235\276\214\062\213\023\115\373\055\026\316\343\146\174"
	"\376\121\353\215\171\031\221\356\137\171\126\152\103\253\375\234"
	"\372\307\113\326\103\046\154\055\100\307\255\277\044\012\017\266"
	"\057\105\144\111\325\133\074\244\031\013\200\214\202\302\126\255"
	"\326\300\062\247\227\056\323\333\104\071\103\147\207\071\261\072"
	"\021\374\064\316\314\143\131\377\074\250\372\027\355\075\155\142"
	"\370\207\141\016\272\052\241\026\027\060\031\010\222\374\152\237"
	"\255\030\242\377\135\320\144\102\153\070\002\265\072\335\250\100"
	"\333\326\154\077\217\235\343\127\021\351\130\215\162\060\323\242"
	"\052\342\041\353\367\246\150\161\231\137\067\237\341\114\264\246"
	"\235\151\113\241\310\331\041\152\037\127\021\224\060\117\212\211"
	"\115\044\335\302\331\252\334\357\056\325\104\147\264\175\205\144"
	"\072\126\011\273\130\061\363\056\233\101\067\137\211\035\354\141"
	"\115\011\107\365\160\205\051\231\240\232\077\153\345\126\256\370"
	"\263\117\213\073\207\001\266\071\221\321\107\110\057\033\053\075"
	"\257\001\230\307\175\300\263\230\027\315\264\173\012\343\212\176"
	"\273\017\101\034\377\011\171\350\200\226\075\202\310\351\207\124"
	"\227\353\243\377\103\100\266\074\366\225\311\055\156\201\201\227"
	"\273\350\327\220\316\353\351\162\372\000\306\204\136\305\166\050"
	"\004\074\112\035\233\360\223\326\027\057\345\004\323\162\372\261"
	"\166\016\225\070\276\024\011\046\266\034\303\242\327\333\002\267"
	"\235\221\201\252\204\334\206\035\102\324\234\370\303\044\171\020"
	"\101\332\304\207\030\333\052\157\256\040\235\343\152\023\216\340"
	"\200\273\157\325\370\351\012\251\050\133\017\010\255\113\321\377"
	"\230\123\130\175\051\317\274\204\303\374\021\230\123\024\316\113"
	"\053\240\023\275\063\322\373\345\352\273\214\005\121\146\024\203"
	"\027\056\016\323\046\053\063\365\047\260\351\031\055\233\114\057"
	"\107\140\312\242\271\216\373\250\026\004\351\265\075\110\270\317"
	"\152\021\360\256\040\251\337\246\235\223\107\077\141\077\320\202"
	"\300\017\227\375\174\322\157\143\024\146\133\153\352\242\355\104"
	"\121\033\166\276\151\335\003\372\322\132\234\360\254\157\345\041"
	"\056\375\361\226\271\222\264\014\120\354\156\110\134\103\257\111"
	"\114\126\034\361\354\362\265\313\263\062\062\006\240\275\316\174"
	"\313\100\236\177\236\014\023\144\032\266\212\317\240\330\342\355"
	"\320\103\323\337\135\135\312\344\116\206\224\301\231\200\261\116"
	"\226\077\140\366\231\015\032\227\263\367\145\071\100\043\314\172"
	"\241\050\216\251\215\044\270\360\023\256\317\304\372\317\077\223"
	"\124\251\304\234\341\215\305\315\012\364\245\035\125\252\341\274"
	"\032\340\104\327\236\203\071\367\104\317\021\211\377\320\201\122"
	"\041\267\003\214\015\116\064\235\140\001\247\344\306\377\115\305"
	"\135\100\005\256\261\024\261\305\054\234\055\252\343\316\322\301"
	"\366\216\326\051\015\105\040\072\213\072\374\254\100\374\160\251"
	"\035\124\164\173\127\042\020\105\364\230\171\053\131\216\372\027"
	"\066\073\036\353\215\254\124\321\302\060\065\100\106\126\222\373"
	"\207\276\351\166\333\136\133\032\077\244\276\134\106\106\060\035"
	"\152\323\160\013\254\112\057\272\074\240\024\363\370\146\054\250"
	"\314\232\104\346\234\064\205\105\145\041\354\237\113\061\131\342"
	"\241\347\352\112\147\264\101\266\300\260\263\310\362\036\133\146"
	"\036\045\171\372\037\050\311\366\145\324\116\356\060\246\022\150"
	"\156\231\342\163\064\347\375\265\336\135\274\315\147\204\237\002"
	"\204\127\062\265\130\234\335\266\061\263\217\174\301\235\367\146"
	"\013\322\366\262\125\053\006\365\244\022\233\016\303\112\043\011"
	"\130\021\114\125\215\050\012\141\006\267\215\000\122\212\272\054"
	"\114\274\112\164\360\232\023\372\021\026\344\340\344\333\176\214"
	"\157\362\173\377\215\314\314\111\042\060\352\207\352\077\212\005"
	"\377\324\234\061\174\300\021\203\221\231\154\116\347\356\067\127"
	"\064\325\110\011\241\204\377\274\253\377\103\313\164\057\362\366"
	"\311\203\106\101\214\312\333\031\131\350\302\123\000\036\237\160"
	"\241\204\251\151\274\030\077\332\146\375\354\031\377\161\161\000"
	"\311\072\365\340\377\110\141\222\055\332\060\212\061\167\065\376"
	"\367\162\037\373\127\235\260\040\076\324\136\010\351\346\321\133"
	"\103\377\035\076\125\337\274\050\052\332\330\326\157\343\074\015"
	"\145\040\370\151\326\344\120\271\177\341\140\331\027\341\243\372"
	"\241\357\060\052\014\246\134\346\372\127\362\106\021\320\333\167"
	"\272\140\315\061\304\307\277\342\220\141\375\077\216\353\212\350"
	"\021\033\306\126\223\144\372\373\377\144\030\124\251\257\272\120"
	"\207\024\173\223\373\274\220\117\011\163\031\172\042\044\161\124"
	"\220\032\171\327\123\214\010\214\252\263\361\247\375\214\324\215"
	"\167\140\321\245\121\226\044\143\102\110\124\244\314\063\224\300"
	"\050\113\215\015\103\233\026\247\374\012\120\270\064\125\133\136"
	"\115\036\232\122\345\300\313\140\355\263\013\037\126\230\251\350"
	"\050\212\067\033\067\032\303\307\301\052\213\157\343\102\343\301"
	"\332\061\126\320\201\002\107\042\255\050\076\313\274\125\305\316"
	"\233\376\073\226\237\007\347\126\216\111\251\111\117\265\213\340"
	"\126\105\345\142\171\371\174\211\303\176\337\105\127\374\371\352"
	"\336\355\337\057\173\043\303\153\271\316\043\017\332\360\202\103"
	"\242\163\116\065\123\065\375\266\003\234\006\212\375\321\266\301"
	"\371\226\057\154\134\107\152\364\006\373\157\102\356\056\377\120"
	"\351\300\351\146\351\045\276\261\334\333\366\076\230\121\340\173"
	"\176\002\224\342\177\230\216\313\025\205\222\120\212\343\064\011"
	"\263\016\236\277\223\132\151\217\134\377\252\244\107\136\170\376"
	"\275\061\153\335\311\355\265\270\314\020\361\041\212\201\264\305"
	"\041\045\006\055\212\235\101\150\015\214\321\111\200\264\137\072"
	"\011\306\047\055\162\271\133\232\020\346\077\034\137\243\333\107"
	"\162\215\256\271\111\357\236\332\101\165\025\017\332\010\104\232"
	"\363\062\050\104\045\170\261\125\377\114\244\157\261\155\110\211"
	"\000\004\245\255\224\322\146\351\106\001\073\050\041\113\223\206"
	"\366\040\011\207\130\364\266\321\314\041\004\264\106\374\254\370"
	"\102\045\127\000\347\026\263\137\044\300\173\060\261\075\236\113"
	"\316\322\106\331\321\137\256\041\103\075\272\223\212\102\255\275"
	"\225\306\136\356\167\157\272\334\126\017\031\114\010\213\332\216"
	"\233\127\022\263\126\201\010\345\166\167\313\222\010\010\120\111"
	"\351\375\336\311\053\143\255\101\166\227\321\207\277\307\275\260"
	"\062\021\017\141\116\105\203\322\111\074\147\320\246\240\104\000"
	"\345\265\325\247\232\227\222\245\060\143\120\262\236\361\302\161"
	"\211\112\106\055\111\347\314\144\167\040\344\275\141\056\227\326"
	"\246\327\146\004\045\115\221\226\104\072\144\223\157\022\327\036"
	"\303\335\035\234\260\253\373\372\244\064\141\110\142\137\104\270"
	"\057\111\231\321\036\044\176\065\220\011\235\027\340\127\054\166"
	"\112\075\116\152\235\022\054\060\324\243\240\321\344\350\212\262"
	"\217\013\237\330\333\310\315\315\171\132\141\361\137\120\165\306"
	"\175\336\052\162\330\056\121\173\102\317\252\127\114\341\353\143"
	"\320\243\072\132\356\224\336\046\004\310\332\327\260\111\060\003"
	"\227\233\066\241\342\001\015\070\316\352\211\251\074\231\127\056"
	"\142\076\360\216\016\144\147\311\314\152\200\155\367\042\375\115"
	"\276\065\155\251\140\257\112\043\377\351\120\315\053\250\336\265"
	"\137\022\116\347\216\363\163\170\255\361\026\000\332\047\224\172"
	"\011\331\034\020\176\037\150\330\235\172\070\072\133\234\327\273"
	"\005\005\235\200\322\202\200\363\250\262\053\143\111\330\140\014"
	"\004\223\342\030\332\100\332\046\252\133\057\005\360\313\205\223"
	"\045\236\362\026\342\032\364\150\032\106\340\241\376\141\057\331"
	"\300\210\107\201\052\315\052\363\212\015\061\132\176\352\161\225"
	"\147\306\055\126\176\355\365\133\032\362\017\143\312\277\075\352"
	"\033\251\030\037\177\373\177\206\053\202\242\366\373\301\346\356"
	"\376\205\075\165\063\053\267\043\171\054\001\247\317\040\221\165"
	"\142\317\004\316\141\342\240\227\057\130\365\353\264\334\300\121"
	"\060\340\211\175\130\002\321\356\002\121\076\361\207\342\054\264"
	"\220\365\126\214\342\220\175\307\217\206\104\221\201\227\116\050"
	"\362\322\067\271\373\307\046\353\171\136\116\300\324\033\112\351"
	"\206\322\363\215\052\062\067\042\353\003\171\133\166\363\240\162"
	"\142\314\372\257\171\236\343\155\227\230\307\311\276\202\273\327"
	"\131\157\313\325\260\201\003\230\155\157\152\054\376\111\042\046"
	"\253\070\217\220\206\013\350\270\130\326\146\346\065\270\325\107"
	"\175\064\352\161\251\152\007\211\362\246\337\072\040\367\317\041"
	"\152\051\007\234\263\310\214\026\137\250\361\273\243\024\227\037"
	"\014\110\373\136\210\227\177\150\057\335\142\355\347\004\115\244"
	"\040\155\241\345\131\266\017\134\375\132\136\136\316\113\032\041"
	"\370\014\332\154\074\053\026\151\113\036\340\270\363\201\315\365"
	"\237\244\216\122\250\147\050\012\036\003\207\161\177\363\323\074"
	"\055\123\300\335\250\340\174\163\114\353\371\007\141\030\155\070"
	"\320\215\350\034\232\320\017\360\046\241\223\201\233\134\312\276"
	"\107\035\205\133\240\175\103\325\012\042\205\314\173\302\202\354"
	"\236\212\375\371\154\062\346\133\050\306\254\201\316\062\004\275"
	"\143\323\035\243\257\371\307\302\316\352\112\063\172\101\060\351"
	"\146\374\073\203\117\110\305\026\321\207\171\334\015\122\315\070"
	"\204\252\114\263\227\246\145\047\145\225\313\144\144\232\003\211"
	"\034\031\271\344\035\376\340\334\040\174\043\253\220\312\023\114"
	"\373\257\001\340\167\134\075\261\350\216\243\225\323\164\223\254"
	"\245\007\053\337\303\170\212\323\227\240\362\331\032\357\366\365"
	"\076\017\137\252\160\214\021\357\001\251\310\350\127\372\067\351"
	"\343\001\364\137\341\020\166\161\035\371\074\173\347\311\022\350"
	"\033\074\057\115\173\072\263\002\076\235\250\173\266\104\001\140"
	"\375\156\356\244\343\004\211\035\065\253\362\134\154\325\334\071"
	"\215\325\204\364\350\072\017\323\375\341\257\111\311\323\021\153"
	"\305\210\121\215\101\007\315\112\066\174\200\146\072\353\102\245"
	"\272\340\250\115\344\075\172\034\276\004\346\311\232\134\273\140"
	"\254\002\057\271\304\012\213\027\375\172\172\074\304\133\322\017"
	"\377\027\144\163\105\336\112\277\373\362\307\350\243\261\350\105"
	"\321\033\116\266\030\262\064\111\135\233\152\067\351\004\014\115"
	"\001\371\253\254\137\214\234\264\056\226\303\330\205\361\320\034"
	"\124\146\175\364\015\170\240\055\267\072\072\121\020\374\047\075"
	"\123\157\011\120\360\164\054\176\002\003\301\216\221\001\167\117"
	"\113\113\076\223\106\335\166\013\275\021\031\176\216\221\335\051"
	"\255\302\117\233\225\122\321\152\201\242\046\370\015\376\032\070"
	"\365\200\243\012\260\227\330\275\022\325\025\155\145\126\323\047"
	"\356\056\254\031\070\207\106\363\136\345\316\276\145\254\243\106"
	"\353\201\327\350\337\070\203\215\007\221\065\340\034\140\063\006"
	"\163\342\131\243\250\303\176\137\366\243\020\251\033\135\366\060"
	"\142\323\122\244\170\370\133\111\200\245\317\230\075\152\314\153"
	"\310\064\171\041\333\034\341\174\306\031\315\040\364\134\067\050"
	"\061\201\265\176\326\000\303\220\375\036\040\167\031\161\352\341"
	"\127\334\155\161\350\211\304\337\144\216\311\202\052\034\031\336"
	"\107\223\242\354\331\115\346\160\136\063\305\233\366\312\023\102"
	"\350\006\040\200\130\346\314\074\352\126\124\236\006\006\262\217"
	"\160\116\035\360\202\222\242\054\235\320\044\014\267\366\170\005"
	"\100\346\311\121\302\247\355\127\054\364\034\106\021\252\017\216"
	"\041\205\301\033\300\140\376\127\142\147\357\153\142\141\350\326"
	"\015\157\045\104\167\140\167\043\252\145\251\144\175\031\000\325"
	"\351\127\057\347\243\226\107\203\120\006\114\113\250\112\165\376"
	"\071\052\167\026\176\131\320\163\022\365\014\320\252\252\020\075"
	"\244\036\355\177\224\125\071\375\056\241\172\026\356\014\262\254"
	"\033\015\207\374\277\276\057\302\160\036\152\076\311\172\174\155"
	"\231\151\354\056\276\045\053\354\307\245\003\265\262\265\142\315"
	"\302\352\312\202\250\372\104\031\030\257\127\341\052\324\116\303"
	"\076\073\361\375\141\035\352\050\302\355\336\164\243\100\102\146"
	"\052\015\350\323\007\055\354\037\334\104\001\007\031\120\312\127"
	"\213\273\124\355\330\077\025\233\055\363\020\320\064\123\067\137"
	"\140\040\062\147\115\037\207\052\143\211\061\174\331\374\324\145"
	"\267\051\122\220\150\150\054\225\134\074\146\221\217\235\360\360"
	"\276\043\127\013\102\337\066\246\150\150\043\102\144\367\250\033"
	"\041\373\254\211\143\330\037\300\025\205\121\245\043\102\225\341"
	"\145\355\355\250\315\044\116\065\214\162\170\360\152\040\014\213"
	"\034\271\025\177\221\064\100\246\272\221\114\335\323\341\277\071"
	"\316\255\341\233\321\060\321\135\242\112\116\014\153\133\227\207"
	"\024\255\007\245\341\107\114\233\331\230\171\255\172\071\346\111"
	"\346\310\345\270\370\266\026\233\001\144\247\154\277\077\363\324"
	"\354"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	1	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
