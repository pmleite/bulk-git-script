#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -r -f bulk-git.sh -o teste 
#endif

static  char data [] = 
#define      date_z	1
#define      date	((&data[0]))
	"\044"
#define      text_z	5200
#define      text	((&data[180]))
	"\254\030\166\351\325\071\235\116\114\127\314\126\202\117\111\235"
	"\022\046\137\307\315\062\224\177\236\271\226\125\220\271\070\075"
	"\321\256\046\247\350\303\365\065\033\302\214\235\021\325\072\044"
	"\373\231\353\311\314\177\110\152\071\336\277\312\230\370\007\152"
	"\247\056\021\217\362\007\305\015\311\121\252\333\046\345\377\042"
	"\177\353\353\113\153\063\266\244\022\166\157\252\156\167\024\025"
	"\246\046\245\230\055\152\245\367\273\120\322\342\065\322\005\264"
	"\276\360\000\051\044\266\316\066\055\076\341\233\265\366\261\133"
	"\034\126\364\111\301\231\101\175\351\024\137\037\347\144\324\245"
	"\125\324\316\172\213\235\260\270\333\222\124\221\210\005\355\244"
	"\133\341\356\035\173\057\232\145\103\372\204\053\137\131\320\264"
	"\055\237\056\227\270\271\210\044\014\271\011\006\304\177\144\005"
	"\227\307\314\206\375\105\123\354\273\345\062\277\061\260\150\247"
	"\047\041\356\024\264\201\203\351\005\321\056\070\341\251\160\316"
	"\020\165\235\201\222\105\170\160\303\231\170\341\262\141\065\110"
	"\260\366\253\221\026\252\206\057\136\152\076\353\066\125\230\023"
	"\227\126\070\057\124\111\123\353\021\021\356\302\305\202\035\103"
	"\161\132\004\352\075\351\021\177\152\034\076\327\101\152\341\364"
	"\356\100\140\211\333\362\226\331\371\222\235\013\326\115\024\275"
	"\115\341\257\317\272\201\074\212\334\017\303\057\141\376\320\325"
	"\034\217\155\350\210\143\150\155\013\235\063\045\130\142\351\216"
	"\134\022\171\254\260\242\337\220\000\203\302\246\143\322\033\344"
	"\241\057\344\267\370\173\125\212\377\345\145\172\061\065\354\060"
	"\000\335\374\064\203\263\342\246\041\366\006\163\253\320\273\316"
	"\201\062\251\034\351\007\375\300\131\004\270\336\016\232\265\273"
	"\233\342\217\074\162\336\003\375\114\005\057\117\326\174\205\100"
	"\127\213\121\237\202\240\204\047\116\002\317\032\351\361\046\011"
	"\140\274\222\226\272\336\124\363\064\104\177\314\216\035\344\274"
	"\033\332\136\017\146\043\214\040\234\054\336\107\332\207\316\025"
	"\117\265\334\373\054\030\214\174\214\305\374\214\055\316\022\015"
	"\147\366\315\057\024\014\163\176\354\257\220\114\135\067\305\320"
	"\232\270\031\001\007\053\347\307\051\026\137\166\142\010\012\020"
	"\141\023\013\350\231\171\073\302\250\115\034\346\236\234\070\321"
	"\337\144\167\224\170\076\221\234\115\007\236\211\104\275\142\067"
	"\215\236\154\056\353\051\115\173\232\305\300\374\340\241\146\033"
	"\266\112\344\211\167\020\235\345\313\371\227\301\223\271\036\316"
	"\252\276\306\242\226\374\172\372\033\301\154\011\040\255\220\367"
	"\312\140\253\047\122\032\141\275\110\051\054\235\052\066\245\343"
	"\117\267\354\321\303\254\242\131\011\014\245\003\076\207\307\056"
	"\362\163\121\215\301\233\312\040\024\115\317\011\367\152\353\140"
	"\040\305\342\136\061\116\256\040\300\264\220\262\360\353\154\146"
	"\307\045\001\040\345\262\323\270\370\041\343\335\136\135\175\151"
	"\153\013\330\245\342\362\262\261\103\106\067\215\205\012\371\277"
	"\144\362\210\266\240\240\074\163\277\262\375\261\166\275\130\351"
	"\164\325\226\253\261\227\110\121\223\353\117\346\006\325\122\065"
	"\345\073\340\365\041\323\372\254\155\241\166\324\334\372\054\212"
	"\032\236\135\210\370\212\046\050\244\303\013\323\066\375\343\163"
	"\123\036\055\062\222\042\101\060\362\006\072\064\172\011\163\051"
	"\160\361\210\363\332\030\374\112\046\116\176\207\033\206\212\346"
	"\276\263\167\161\017\344\060\224\203\247\000\111\252\322\103\254"
	"\230\366\277\251\120\250\145\037\123\007\230\034\063\372\347\355"
	"\337\025\053\016\265\002\042\140\175\060\047\227\006\150\017\237"
	"\100\345\117\323\041\110\121\014\367\324\010\161\315\161\167\252"
	"\207\331\156\314\163\022\001\223\257\025\011\010\106\367\136\350"
	"\232\130\046\200\202\044\133\122\021\130\047\130\161\007\106\043"
	"\230\105\105\147\043\054\330\250\230\354\355\024\115\246\021\143"
	"\075\066\375\071\310\306\133\204\317\034\322\331\350\013\210\175"
	"\122\243\342\237\255\113\114\126\374\012\364\144\160\221\132\001"
	"\147\111\161\006\356\137\002\171\375\322\234\310\074\247\223\214"
	"\205\244\276\261\275\020\316\070\316\367\121\365\127\067\375\342"
	"\351\122\161\316\004\142\274\043\100\127\262\263\056\275\236\040"
	"\062\263\303\352\006\232\261\055\147\273\067\327\047\165\277\177"
	"\056\252\214\047\130\026\015\057\110\252\030\135\116\175\326\244"
	"\355\364\156\244\303\324\324\076\263\312\026\046\310\331\213\242"
	"\022\123\364\060\372\025\016\201\241\202\005\103\370\000\344\136"
	"\106\144\264\367\220\300\072\106\054\263\203\310\272\135\334\167"
	"\162\337\063\070\142\266\134\060\270\053\144\204\147\171\306\114"
	"\272\323\316\111\216\175\122\007\027\246\047\122\253\076\370\135"
	"\043\153\353\057\016\360\230\205\316\323\233\241\035\163\266\144"
	"\151\160\345\037\166\204\034\047\247\232\145\346\114\237\004\314"
	"\226\301\211\162\343\126\254\135\046\367\342\206\151\357\233\116"
	"\231\000\044\170\104\153\040\270\016\341\244\300\070\305\034\054"
	"\145\316\011\265\232\327\224\012\020\237\315\323\054\211\367\161"
	"\307\072\326\335\022\323\257\251\125\161\156\247\020\322\014\177"
	"\264\216\051\111\133\041\160\350\176\243\064\237\305\220\003\121"
	"\322\324\331\246\122\320\207\124\107\360\362\050\152\303\172\222"
	"\361\237\174\322\322\304\165\004\066\220\141\150\364\036\017\022"
	"\272\350\373\046\131\113\222\153\135\225\257\337\210\117\075\072"
	"\333\110\066\016\263\035\102\122\325\107\215\010\042\054\303\016"
	"\352\274\350\263\250\330\025\043\367\113\372\233\363\337\064\242"
	"\137\155\047\245\125\260\055\315\041\365\256\113\115\132\016\350"
	"\010\261\263\071\015\127\326\350\104\053\254\375\331\156\124\205"
	"\077\330\115\267\232\137\263\362\102\244\242\000\236\250\276\140"
	"\132\046\174\213\106\242\130\264\042\276\346\005\205\212\014\245"
	"\043\317\353\231\122\035\357\006\140\112\041\242\043\006\036\022"
	"\322\244\327\277\132\335\007\003\337\300\221\056\237\025\076\365"
	"\250\051\221\134\210\244\266\077\060\010\345\306\075\037\326\263"
	"\022\142\342\157\143\057\322\226\033\023\370\132\245\373\013\363"
	"\052\313\030\107\312\072\016\332\045\165\037\326\031\233\150\326"
	"\170\131\101\376\121\277\364\116\033\153\014\007\002\363\056\302"
	"\214\376\377\321\375\146\260\200\117\114\306\361\032\022\113\063"
	"\052\006\372\030\333\270\044\061\342\254\206\222\043\154\126\263"
	"\152\364\174\104\153\204\110\121\070\113\064\030\222\100\065\103"
	"\257\133\116\061\051\271\034\150\245\130\026\355\133\205\330\053"
	"\314\125\375\111\166\176\153\063\037\141\034\221\103\350\101\310"
	"\257\137\061\210\364\061\324\152\050\205\163\340\146\350\204\170"
	"\343\237\061\151\033\141\211\022\114\170\110\022\062\071\325\210"
	"\160\225\324\346\013\101\320\350\323\006\066\232\330\263\107\265"
	"\336\266\150\375\147\143\354\266\234\214\220\302\262\055\205\276"
	"\356\132\210\231\166\322\147\114\133\112\323\343\130\205\061\177"
	"\323\225\350\074\136\333\205\024\273\371\007\160\244\351\210\310"
	"\235\047\223\027\255\333\314\107\375\220\250\334\275\210\041\312"
	"\331\022\016\217\062\374\305\311\315\100\154\275\142\051\215\047"
	"\143\330\314\336\275\357\041\320\350\345\006\363\100\371\370\207"
	"\236\310\315\124\347\340\133\150\201\131\140\360\062\333\106\140"
	"\307\013\057\147\106\134\046\046\303\065\055\340\173\062\273\160"
	"\203\263\266\376\320\023\162\040\313\150\024\337\105\271\122\301"
	"\211\100\224\213\157\132\160\154\065\215\003\267\261\356\031\342"
	"\277\150\021\046\114\122\041\304\132\043\134\014\271\075\027\052"
	"\375\316\334\371\250\062\260\373\145\326\243\260\216\163\347\330"
	"\035\017\166\327\324\054\242\222\211\035\317\067\240\323\142\126"
	"\201\242\256\310\143\265\016\331\150\164\037\324\041\021\343\041"
	"\004\273\034\140\022\155\141\076\104\107\023\163\172\304\142\112"
	"\176\327\112\232\373\155\237\053\160\040\233\377\322\017\004\367"
	"\300\141\213\024\163\264\027\032\211\223\316\343\156\220\135\207"
	"\011\277\255\310\247\035\070\210\232\024\325\123\015\016\265\110"
	"\152\244\363\001\344\070\161\125\215\345\106\241\040\031\270\215"
	"\050\017\366\310\014\316\074\122\034\056\062\377\340\065\163\323"
	"\007\150\263\316\036\242\077\212\200\353\016\070\176\063\067\017"
	"\312\276\321\060\240\123\211\215\252\234\301\113\216\006\057\232"
	"\204\364\374\205\106\057\267\207\233\140\026\120\270\340\051\303"
	"\157\176\230\330\375\144\145\202\372\145\246\242\233\073\001\300"
	"\113\174\056\166\211\257\116\003\176\021\147\216\054\010\377\072"
	"\321\354\150\143\326\124\206\306\024\100\127\215\275\237\125\241"
	"\012\361\064\013\226\066\000\361\365\127\005\346\051\026\340\360"
	"\321\202\313\027\251\161\162\026\222\023\264\234\344\100\117\020"
	"\367\021\372\132\154\225\254\120\072\366\367\320\026\151\232\002"
	"\233\005\103\150\011\056\246\307\170\346\365\100\301\172\276\361"
	"\363\027\213\034\310\047\255\233\322\052\175\071\123\037\237\140"
	"\225\106\323\064\170\233\073\141\227\113\165\007\273\052\240\307"
	"\104\262\104\260\076\153\372\240\150\320\227\063\177\124\261\342"
	"\364\374\212\012\010\054\135\105\166\242\157\262\026\360\355\074"
	"\054\124\362\376\261\256\347\156\216\161\174\064\276\114\225\120"
	"\033\373\060\210\101\351\205\167\127\343\010\175\061\060\020\102"
	"\145\034\036\213\265\352\327\110\067\015\145\350\317\243\142\337"
	"\312\203\324\347\343\262\337\104\211\172\365\044\247\215\011\134"
	"\103\313\013\115\223\125\042\126\313\365\005\051\027\361\311\176"
	"\352\075\140\070\223\124\037\257\364\121\255\171\124\023\122\000"
	"\013\045\075\253\124\131\331\102\322\335\315\370\063\331\113\355"
	"\231\021\265\143\270\122\243\267\315\036\306\375\221\143\232\245"
	"\175\344\105\076\042\006\034\060\234\047\315\032\065\313\224\236"
	"\334\370\011\375\022\055\142\351\372\341\150\003\265\221\074\353"
	"\076\337\337\211\365\025\153\257\115\221\062\007\005\026\253\022"
	"\326\252\060\306\017\144\114\024\211\365\154\054\024\012\162\166"
	"\141\355\141\217\037\277\123\225\131\347\343\207\135\053\322\073"
	"\161\114\024\246\103\234\042\270\060\330\061\061\100\263\021\102"
	"\315\103\100\266\033\065\102\136\176\127\332\275\006\337\242\227"
	"\165\276\000\121\046\011\054\360\357\023\344\326\324\013\032\362"
	"\312\005\343\221\073\272\357\123\132\315\307\301\073\021\166\354"
	"\361\042\241\146\111\162\016\024\066\372\104\202\237\325\255\000"
	"\102\016\211\043\363\156\067\301\065\162\332\042\002\370\202\315"
	"\210\357\277\254\142\255\267\165\243\370\150\120\123\271\224\236"
	"\252\126\073\271\202\067\041\224\275\021\246\333\367\121\230\137"
	"\131\225\366\065\034\304\017\377\126\277\104\045\106\177\034\054"
	"\105\117\256\257\352\254\021\312\060\132\324\271\203\005\330\213"
	"\037\065\053\243\356\244\352\231\174\054\201\350\303\062\324\354"
	"\012\010\341\002\017\174\211\161\142\361\023\342\164\360\336\046"
	"\165\347\267\217\175\217\304\026\223\154\024\071\204\223\127\154"
	"\107\156\232\043\003\172\034\036\211\306\124\230\116\360\071\353"
	"\276\320\360\016\335\360\211\036\011\302\027\202\021\323\155\372"
	"\147\373\144\320\341\347\176\100\361\064\301\341\276\234\254\033"
	"\375\157\221\250\202\122\241\106\145\324\322\345\301\323\256\012"
	"\071\146\052\255\130\210\041\377\244\023\000\271\101\022\046\013"
	"\160\166\040\221\260\265\347\063\132\144\346\170\222\220\322\051"
	"\033\014\324\366\217\074\125\223\227\026\256\141\212\216\017\305"
	"\024\355\103\150\012\217\161\024\375\341\303\056\355\342\342\156"
	"\207\001\263\057\255\377\273\265\304\310\007\241\315\002\077\111"
	"\372\113\104\222\112\012\162\323\162\015\174\113\146\215\211\040"
	"\002\364\031\272\064\035\322\113\344\210\331\122\244\204\077\224"
	"\001\122\330\236\032\332\270\205\134\010\152\021\062\137\030\063"
	"\201\057\003\166\152\114\233\247\334\125\124\236\351\372\011\145"
	"\064\031\005\011\372\316\230\210\171\370\220\376\033\323\311\117"
	"\205\235\125\046\243\313\037\364\000\374\315\163\170\133\045\366"
	"\014\000\244\047\032\224\264\225\107\136\213\133\227\316\020\275"
	"\312\237\343\271\342\214\030\007\120\224\330\344\305\354\330\225"
	"\122\372\257\144\317\020\046\020\062\115\365\157\220\235\132\335"
	"\111\215\216\044\332\371\200\010\002\276\362\330\344\046\110\306"
	"\011\130\227\045\175\365\373\237\323\332\354\310\052\346\175\216"
	"\102\157\137\062\062\124\260\354\044\330\157\156\105\023\334\000"
	"\005\240\042\346\104\352\037\065\225\100\131\172\212\307\151\241"
	"\105\342\365\077\066\332\110\304\101\364\333\040\071\130\172\251"
	"\056\206\260\170\315\024\367\356\015\050\260\064\375\275\344\172"
	"\035\026\037\276\025\301\051\015\376\215\070\365\101\337\241\206"
	"\235\036\002\366\155\341\032\354\110\376\005\336\026\274\063\064"
	"\035\314\003\202\022\154\054\004\062\360\073\116\310\355\327\203"
	"\254\232\114\114\177\034\147\061\035\174\264\341\336\314\226\101"
	"\007\342\310\042\021\355\314\211\365\172\207\365\261\221\022\020"
	"\110\035\230\345\312\000\022\145\137\072\104\214\355\276\171\173"
	"\266\106\035\030\347\111\252\005\306\042\255\253\227\013\303\131"
	"\060\222\305\337\350\046\107\327\276\243\344\324\205\356\210\202"
	"\337\155\211\351\355\166\217\266\110\236\361\003\246\150\113\267"
	"\060\012\346\141\256\325\065\200\220\203\043\250\125\340\261\044"
	"\366\035\367\043\225\340\047\005\320\131\004\234\357\166\070\316"
	"\301\040\253\260\170\046\223\107\144\366\324\113\334\043\114\271"
	"\141\224\267\054\347\262\203\331\115\066\005\273\164\170\331\374"
	"\035\173\201\023\046\214\121\312\126\237\366\045\027\236\371\011"
	"\116\267\215\342\224\256\146\104\372\043\003\355\011\376\365\156"
	"\334\226\373\314\324\352\160\154\331\365\005\032\340\176\122\217"
	"\363\034\011\356\225\353\047\135\030\157\307\347\334\074\216\371"
	"\306\300\316\076\057\066\204\143\217\062\332\062\273\374\233\225"
	"\317\114\244\270\010\272\233\225\107\145\037\062\162\065\023\115"
	"\271\022\052\144\266\055\240\262\175\130\330\320\165\356\316\330"
	"\006\156\264\270\105\122\064\371\204\177\167\360\330\371\131\257"
	"\306\275\064\147\271\301\167\211\030\333\116\020\251\220\213\015"
	"\246\165\022\250\370\136\130\146\215\272\014\327\162\251\214\052"
	"\150\205\026\200\202\260\207\332\177\015\011\064\241\121\254\032"
	"\157\222\311\130\034\355\217\107\036\167\270\271\100\062\047\157"
	"\177\154\032\133\161\364\130\201\013\023\275\370\242\133\265\364"
	"\307\112\333\017\112\125\023\133\363\215\002\135\241\003\316\370"
	"\360\336\256\010\031\360\041\250\300\133\337\114\223\352\174\332"
	"\341\116\243\306\372\345\123\052\107\321\135\377\246\337\130\357"
	"\027\015\231\376\213\237\312\342\353\171\054\276\307\305\362\235"
	"\070\206\001\326\300\103\015\141\241\211\227\360\237\247\126\127"
	"\215\223\344\012\133\304\116\231\367\313\215\277\214\226\300\252"
	"\332\245\340\353\276\042\315\056\040\125\215\052\364\331\072\300"
	"\363\034\045\175\165\171\001\275\114\316\216\372\061\310\063\021"
	"\104\222\231\042\037\053\134\100\165\101\215\164\137\142\332\001"
	"\365\340\161\033\301\103\117\201\022\346\155\075\355\207\172\224"
	"\060\267\163\275\326\112\255\237\375\146\130\332\157\222\122\163"
	"\320\050\024\272\375\324\145\202\142\166\343\144\251\102\364\335"
	"\066\151\016\004\107\217\234\163\330\141\346\040\311\027\113\277"
	"\355\163\357\253\142\140\217\140\256\034\227\054\213\313\171\112"
	"\155\305\250\126\132\035\265\073\261\135\235\040\270\343\073\343"
	"\014\372\371\103\065\120\275\222\305\126\046\073\131\110\334\332"
	"\350\157\032\347\331\135\064\237\367\144\054\046\034\223\226\125"
	"\220\360\006\275\117\301\345\202\024\162\041\043\170\234\074\320"
	"\230\177\002\114\266\003\067\370\130\050\363\177\072\027\144\077"
	"\333\363\266\252\054\160\052\126\052\004\200\356\230\353\337\175"
	"\170\172\154\041\357\177\214\310\320\312\364\263\070\134\147\130"
	"\317\041\064\244\323\045\124\241\107\213\060\215\007\073\353\224"
	"\262\233\362\340\146\243\301\300\251\357\170\151\141\370\034\113"
	"\251\202\012\025\243\206\215\060\352\113\072\013\150\207\135\035"
	"\315\155\210\370\201\012\312\025\104\022\224\331\022\124\314\335"
	"\144\356\262\230\356\234\043\246\225\211\227\316\143\306\070\117"
	"\266\361\347\352\024\212\200\106\252\363\017\173\266\013\160\004"
	"\010\174\353\200\213\265\172\346\327\234\341\223\107\155\337\262"
	"\013\370\373\127\024\123\104\233\004\210\374\031\302\310\163\227"
	"\226\061\264\117\300\356\201\265\332\312\031\002\077\170\320\120"
	"\106\041\123\001\272\314\317\144\377\103\320\147\115\102\001\336"
	"\377\222\215\310\075\207\171\063\346\352\141\062\174\011\075\216"
	"\210\204\237\102\135\303\243\102\104\327\317\166\143\146\015\100"
	"\156\265\061\027\006\332\071\327\254\323\112\145\150\351\260\310"
	"\334\216\066\112\315\245\102\066\017\113\035\366\223\350\232\246"
	"\272\035\271\260\141\232\220\247\105\222\210\054\377\332\345\103"
	"\307\061\104\056\036\066\167\170\036\371\270\006\026\165\243\320"
	"\327\372\075\012\046\102\303\127\356\161\004\264\260\027\104\256"
	"\360\312\375\324\076\237\050\334\277\120\254\117\151\274\221\142"
	"\342\075\212\236\206\173\004\343\210\227\020\065\362\005\232\336"
	"\223\224\212\372\130\272\257\160\206\142\220\334\206\221\133\100"
	"\367\027\217\176\265\342\233\327\035\316\177\311\372\247\241\153"
	"\240\263\017\154\172\062\064\051\013\131\260\047\215\320\066\163"
	"\101\074\004\234\265\156\305\141\022\300\212\161\043\151\217\230"
	"\251\131\242\025\353\152\117\321\117\004\171\160\233\206\355\034"
	"\215\043\156\256\123\245\050\206\356\130\242\204\133\045\321\363"
	"\073\131\242\014\002\142\031\013\357\332\214\330\155\112\167\162"
	"\234\271\031\336\332\205\163\146\117\205\164\155\002\156\146\060"
	"\013\357\355\302\353\117\361\273\001\256\013\012\354\321\376\273"
	"\234\317\224\014\361\202\073\357\266\050\274\335\051\325\003\331"
	"\341\037\170\323\161\173\174\354\052\167\164\130\163\376\131\022"
	"\207\211\004\274\144\041\313\277\226\245\152\235\311\367\157\162"
	"\200\150\003\135\335\027\351\354\165\303\303\237\045\333\001\250"
	"\001\017\006\302\007\177\257\274\003\210\126\154\253\030\061\133"
	"\217\016\366\052\241\364\025\071\054\153\247\230\113\064\044\322"
	"\106\270\315\021\365\216\041\363\265\135\314\333\241\010\174\175"
	"\322\023\374\120\317\124\274\224\047\147\224\355\366\213\304\347"
	"\307\252\365\153\126\315\143\304\212\357\376\077\311\103\236\312"
	"\117\047\033\040\210\253\170\357\205\046\135\126\336\075\300\110"
	"\360\202\227\031\200\043\001\236\217\165\167\203\336\075\365\316"
	"\047\073\107\112\176\373\213\244\376\056\127\064\352\264\252\361"
	"\260\241\233\101\123\176\231\334\257\076\304\302\314\170\204\132"
	"\162\365\023\366\025\321\374\001\030\322\156\061\065\316\377\224"
	"\014\037\321\200\243\220\154\044\241\141\062\147\241\066\313\067"
	"\216\154\346\022\201\056\360\216\263\150\104\340\227\216\372\266"
	"\024\165\301\044\140\141\312\201\333\032\204\127\303\351\000\252"
	"\331\206\266\220\014\131\067\020\055\226\056\022\175\052\130\253"
	"\342\004\012\221\265\376\156\101\004\135\127\103\105\031\111\216"
	"\166\301\311\362\131\171\245\000\156\347\212\151\132\024\320\243"
	"\307\372\132\362\332\327\346\262\155\235\207\345\024\064\310\325"
	"\210\101\163\217\077\012\162\201\064\210\041\223\304\315\361\066"
	"\042\060\156\005\320\324\024\036\256\011\224\313\264\231\336\063"
	"\275\170\361\333\105\164\315\320\013\122\326\215\147\073\346\354"
	"\232\146\363\277\332\237\022\252\014\066\172\021\042\052\346\322"
	"\062\056\144\162\053\375\311\115\152\062\165\015\303\327\367\370"
	"\224\302\340\153\151\355\075\151\127\331\330\274\011\050\126\362"
	"\305\161\345\337\104\050\134\045\071\005\244\240\153\141\324\042"
	"\315\352\317\113\333\165\153\256\240\203\016\213\337\211\063\252"
	"\015\217\072\327\036\317\163\101\347\177\001\310\263\024\005\026"
	"\322\355\170\276\250\261\167\151\342\350\140\375\047\343\210\214"
	"\147\125\377\334\164\125\077\200\203\252\027\036\017\204\350\213"
	"\373\116\266\027\276\060\323\171\267\362\073\130\134\276\271\114"
	"\035\250\243\367\127\057\045\075\314\205\277\343\266\064\124\164"
	"\171\336\237\000\323\225\040\332\310\104\246\142\355\166\276\351"
	"\335\342\107\047\276\344\364\140\150\337\062\125\121\327\046\125"
	"\315\241\153\050\377\322\175\172\204\276\064\310\120\134\257\357"
	"\143\052\016\313\374\055\237\367\071\010\232\306\237\223\233\265"
	"\257\337\075\131\146\241\160\166\166\322\306\162\374\177\333\014"
	"\237\013\242\337\345\100\340\132\151\136\033\232\117\025\311\052"
	"\077\174\320\060\274\123\150\245\260\371\222\326\252\307\125\137"
	"\277\173\302\133\375\312\154\235\134\027\267\044\213\055\116\154"
	"\175\012\264\071\356\242\050\235\036\070\145\062\377\330\331\125"
	"\155\023\366\242\127\167\265\264\267\142\346\337\320\072\015\271"
	"\055\377\263\006\377\232\022\161\144\156\301\221\045\163\252\133"
	"\050\232\337\012\355\052\254\101\257\304\324\323\115\224\165\000"
	"\237\040\317\224\246\160\304\137\205\210\161\133\272\331\056\342"
	"\170\031\353\362\154\260\364\152\135\171\151\347\003\065\275\135"
	"\261\163\072\235\371\123\020\007\073\164\154\201\210\176\207\122"
	"\367\202\351\246\002\210\231\347\166\370\107\313\013\146\056\311"
	"\304\151\272\342\133\040\211\207\323\307\345\371\065\331\346\337"
	"\103\054\133\204\012\267\017\231\254\327\001\353\166\332\334\202"
	"\177\106\177\103\102\357\076\366\263\310\014\236\157\014\062\350"
	"\331\134\270\353\267\036\201\122\240\113\110\357\065\227\124\133"
	"\367\130\214\170\124\122\221\226\040\121\177\165\317\233\211\044"
	"\301\040\004\205\065\127\321\333\047\271\176\161\045\165\061\230"
	"\017\161\067\100\045\213\016\276\303\102\000\154\176\153\007\271"
	"\331\144\363\070\136\221\145\210\237\010\226\210\361\133\127\171"
	"\251\222\151\333\000\225\243\335\111\173\134\047\135\332\361\015"
	"\317\050\212\175\004\351\223\034\127\347\247\063\245\160\262\222"
	"\344\070\333\130\102\135\134\325\344\206\256\170\266\331\133\244"
	"\035\205\015\240\257\111\336\053\067\101\360\335\226\116\026\253"
	"\376\117\347\131\111\144\253\213\076\300\356\340\175\122\210\223"
	"\125\301\375\356\353\354\077\320\002\061\075\213\320\243\327\327"
	"\061\213\042\302\111\011\207\121\336\031\054\045\226\152\334\272"
	"\024\260\036\115\311\265\234\226\052\360\025\116\236\264\317\231"
	"\134\167\015\272\125\015\151\130\037\366\025\077\206\261\274\362"
	"\253\013\014\367\166\022\022\124\025\265\216\352\307\241\145\242"
	"\225\243\241\227\110\322\247\340\234\154\231\114\155\347\240\113"
	"\300\154\263\046\253\237\202\144\142\317\345\053\310\205\242\171"
	"\330\333\312\304\376\276\220\166\112\132\114\047\163\335\024\007"
	"\271\302\120\141\160\374\103\264\111\115\321\220\205\314\076\012"
	"\305\006\072\075\303\320\131\271\311\255\021\241\146\334\305\243"
	"\264\273\107\334\056\031\236\154\127\247\057\102\274\364\020\220"
	"\131\113\371\302\333\242\321\307\172\256\016\326\003\255\022\171"
	"\030\037\177\047\355\120\071\272\145\311\247\373\101\342\126\242"
	"\255\040\345\344\156\260\305\044\026\051\102\053\123\140\015\327"
	"\340\314\173\321\222\042\122\265\343\317\122\355\352\250\100\006"
	"\224\352\234\034\146\042\323\211\165\143\236\154\113\053\365\347"
	"\357\343\357\271\075\337\162\030\161\306\251\371\314\227\235\050"
	"\170\214\105\363\273\337\130\377\331\335\052\070\066\373\355\144"
	"\233\034\036\330\373\220\360\155\127\232\147\043\062\004\113\252"
	"\221\221\236\114\161\367\114\112\324\167\203\012\163\161\157\016"
	"\215\215\346\211\036\327\367\165\162\136\231\244\143\345\117\364"
	"\166\355\101\347\344\216\062\271\005\266\304\170\047\063\207\265"
	"\301\155\077\337\105\066\124\267\224\355\134\367\322\253\354\111"
	"\230\055\060\175\273\143\066\301\031\373\072\101\056\301\366\357"
	"\057\065\316\164\154\043\053\001\020\210\371\343\063\345\055\313"
	"\022\136\111\316\301\177\217\332\172\311\033\251\212\022\231\271"
	"\107\150\056\264\213\132\265\234\342\256\200\025\223\255\341\246"
	"\013\052\165\314\251\004\247\044\316\302\316\131\324\147\023\034"
	"\320\101\321\133\233\206\367\175\065\170\223\311\045\164\157\061"
	"\236\345\375\110\351\245\155\270\147\073\021\074\243\044\131\163"
	"\146\053\317\001\261\307\177\347\077\022\260\144\206\040\226\045"
	"\005\223\155\357\071\332\247\241\026\270\336\271\335\067\055\103"
	"\142\374\105\024\304\305\374\003\327\254\150\136\314\376\203\321"
	"\222\361\300\313\313\150\154\342\041\112\233\377\202\311\102\345"
	"\306\210\372\212\115\366\215\045\242\365\204\157\364\010\101\206"
	"\371\002\121\305\152\276\247\213\010\103\212\213\014\315\160\323"
	"\126\153\136\244\141\353\311\004\341\116\163\326\126\264\134\117"
	"\266\256\025\040\154\274\254\165\377\067\001\014\004\161\340\133"
	"\334\076\377\076\052\310\102\014\026\265\342\155\152\076\275\040"
	"\355\322\101\132\216\356\317\216\045\320\232\052\102\173\205\037"
	"\271\204\136\343\115\240\357\144\126\322\321\300\021\216\341\376"
	"\141\043\130\357\021\050\175\067\371\030\141\074\223\347\133\115"
	"\154\271\060\271\132\040\036\260\362\360\161\003\176\123\002\337"
	"\166\133\317\210\203\115\277\174\146\041\270\372\011\024\107\165"
	"\316\170\057\050\231\115\331\213\075\113\217\274\236\222\234\024"
	"\355\154\235\160\271\134\355\040\176\246\032\207\273\142\375\211"
	"\332\054\262\163\172\214\377\267\327\217\164\166\041\021\213\016"
	"\175\050\177\067\205\155\127\003\023\161\212\316\324\210\127\256"
	"\264\012\042\056\226\041\346\155\260\133\344\322\154\157\341\351"
	"\227\140\040\034\315\170\037\340\352\252\257\276\062\007\154\347"
	"\021\217\026\247\260\375\025\141\130\372\064\304\151\025\256\000"
	"\165\316\034\103\107\074\044\061\346\323\357\031\332\134\001\354"
	"\353\027\224\234\024\252\376\154\244\062\061\015\110\337\015\276"
	"\256\052\001\365\146\045\046\115\371\026\147\323\162\150\300\136"
	"\200\124\372\224\376\371\001\243\054\062\260\164\022\276\062\300"
	"\350\063\265\117\131\334\234\122\362\004\046\145\154\346\303\354"
	"\073\276\201\071\267\202\335\344\265\215\130\307\113\213\207\064"
	"\277\075\203\030\032\040\153\015\044\221\162\220\170\066\175\263"
	"\365\377\355\254\201\312\221\067\130\351\376\244\164\206\330\064"
	"\303\133\114\336\173\267\353\240\111\136\061\302\224\256\165\211"
	"\255\143\066\057\055\307\146\206\261\144\052\046\352\002\132\256"
	"\136\247\215\332\137\170\172\250\326\253\153\153\132\340\365\010"
	"\104\054\067\162\364\235\370\245\002\042\314\355\045\046\234\204"
	"\315\051\136\054\242\331\325\171\205\100\345\337\041\332\347\145"
	"\006\037\327\372\275\317\240\277\362\154\255\030\223\112\234\140"
	"\164\373\215\026\324\143\217\131\244\164\071\305\117\041\053\126"
	"\100\002\120\375\322\361\275\304\135\153\334\360\265\171\121\051"
	"\164\337\100\110\102\317\242\346\104\333\254\224\375\327\352\075"
	"\331\073\073\253\054\371\160\212\144\115\172\032\306\314\103\072"
	"\253\204\203\355\124\046\324\230\001\200\055\377\127\027\074\060"
	"\122\170\334\177\161\115\011\326\232\204\360\141\120\064\234\373"
	"\270\037\351\014\105\275\245\107\076\322\106\225\351\203\306\074"
	"\373\242\273\155\357\304\103\212\110\064\353\231\150\207\225\041"
	"\247\176\055\354\074\322\064\172\245\173\017\216\376\326\313\372"
	"\170\206\150\150\113\254\363\224\340\336\055\111\146\302\152\016"
	"\101\227\372\175\152\057\370\017\252\010\236\251\336\152\243\127"
	"\360\014\277\074\270\262\320\230\221\376\341\370\300\113\006\001"
	"\343\001\177\116\060\170\135\333\200\374\204\137\146\050\266\127"
	"\064\166\223\354\050\144\205\272\142\146\263\042\262\271\044\226"
	"\273\244\344\354\034\102\307\235\076\114\374\245\164\262\374\251"
	"\051\220\225\122\364\032\014\126\201\277\171\063\171\236\311\064"
	"\103\256\040\137\360\350\375\056\064\372\323\251\255\320\122\326"
	"\140\347\050\124\002\064\253\203\364\045\267\156\304\200\243\007"
	"\056\303\147\036\254\144\115\340\136\041\211\013\361\333\341\121"
	"\303\012\246\305\076\122\110\063\167\377\242\074\200\105\103\257"
	"\011\252\316\265\016\034\226\155\075\040\171\056\373\132\200\277"
	"\145\046\204\243\171\315\327\361\315\171\055\116\277\160\375\310"
	"\032\314\176\051\350\024\227\046\064\020\124\060\153\324\357\320"
	"\373\164\164\164\101\114"
#define      xecc_z	15
#define      xecc	((&data[6535]))
	"\227\216\123\062\230\155\277\206\345\167\000\030\227\203\355\222"
	"\134\205"
#define      pswd_z	256
#define      pswd	((&data[6576]))
	"\036\047\314\107\020\340\336\066\025\357\213\106\132\137\065\052"
	"\133\251\236\320\353\352\065\311\313\240\151\256\133\040\241\314"
	"\104\033\207\271\144\155\205\153\107\127\126\264\175\027\126\367"
	"\241\161\135\121\372\301\033\305\141\204\164\275\244\025\211\351"
	"\060\021\242\224\177\047\000\306\176\126\173\374\156\321\363\020"
	"\103\121\141\075\023\175\003\165\001\167\063\246\214\275\217\275"
	"\316\062\122\115\131\122\023\330\251\217\325\030\140\311\050\244"
	"\033\212\342\056\007\345\244\010\134\327\257\351\225\076\246\143"
	"\160\370\261\312\113\305\243\364\124\170\015\264\102\065\131\135"
	"\277\073\214\306\041\060\317\175\010\176\147\235\275\016\001\056"
	"\006\262\370\122\167\233\107\313\024\124\200\126\211\332\263\111"
	"\025\100\017\066\160\337\264\171\136\034\027\034\052\030\112\061"
	"\313\103\203\103\336\312\017\363\036\217\112\250\151\375\361\177"
	"\076\001\266\256\340\153\050\077\207\077\133\261\130\246\342\044"
	"\351\146\147\310\060\166\273\117\006\005\367\160\003\350\360\101"
	"\351\246\360\312\021\030\012\230\130\145\112\261\013\054\325\365"
	"\222\074\275\303\263\170\022\272\176\012\052\202\362\033\303\334"
	"\301\264\247\323\315\261\154\371\260\310\126\066\314\261\204\352"
	"\330\120\061\350\061\020\036\107\377\251"
#define      chk1_z	22
#define      chk1	((&data[6853]))
	"\303\204\376\101\060\266\264\122\306\177\016\030\224\133\045\033"
	"\037\126\305\104\034\341\314\365"
#define      lsto_z	1
#define      lsto	((&data[6875]))
	"\320"
#define      shll_z	10
#define      shll	((&data[6877]))
	"\153\211\017\105\270\234\024\343\075\022\300"
#define      inlo_z	3
#define      inlo	((&data[6887]))
	"\054\277\106"
#define      msg2_z	19
#define      msg2	((&data[6894]))
	"\131\172\352\062\117\110\374\352\164\375\373\136\336\016\072\065"
	"\226\027\004\342\212\141\266"
#define      opts_z	1
#define      opts	((&data[6913]))
	"\057"
#define      chk2_z	19
#define      chk2	((&data[6914]))
	"\213\152\340\266\005\272\222\364\313\341\004\023\206\013\346\213"
	"\052\135\365\104"
#define      tst1_z	22
#define      tst1	((&data[6939]))
	"\207\355\225\014\122\264\360\060\311\124\210\265\030\023\205\277"
	"\120\210\035\031\104\351\003\154\042\307\354\002\057\210\132"
#define      rlax_z	1
#define      rlax	((&data[6965]))
	"\220"
#define      msg1_z	65
#define      msg1	((&data[6968]))
	"\364\051\257\321\363\367\315\013\166\356\167\017\222\165\167\151"
	"\100\364\013\035\261\320\061\015\356\272\170\352\206\224\210\260"
	"\267\214\017\236\005\075\234\324\154\010\320\261\046\342\367\276"
	"\100\235\231\207\062\204\061\274\230\056\242\313\127\260\007\340"
	"\225\062\115\257\156\023\341\071"
#define      tst2_z	19
#define      tst2	((&data[7042]))
	"\135\065\172\212\025\262\373\234\374\323\357\015\101\050\210\066"
	"\016\103\226\030\136\305\253\031"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
