#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f bulk-git.sh 
#endif

static  char data [] = 
#define      shll_z	10
#define      shll	((&data[2]))
	"\374\361\354\313\106\264\274\316\277\374\066\153\154\160"
#define      tst1_z	22
#define      tst1	((&data[14]))
	"\125\260\004\110\065\272\120\054\245\107\345\303\251\157\015\166"
	"\355\137\222\130\014\307\230\041"
#define      tst2_z	19
#define      tst2	((&data[40]))
	"\035\305\215\120\260\042\062\272\312\107\205\230\164\144\263\113"
	"\071\303\111\177\200\263\040"
#define      opts_z	1
#define      opts	((&data[61]))
	"\320"
#define      chk1_z	22
#define      chk1	((&data[63]))
	"\277\070\174\165\205\143\361\137\157\047\052\213\254\033\316\332"
	"\212\332\323\261\372\212\254\227\230\216"
#define      msg2_z	19
#define      msg2	((&data[88]))
	"\255\223\176\321\055\206\341\000\236\226\061\206\206\357\367\232"
	"\104\234\242\074\025\317\055"
#define      rlax_z	1
#define      rlax	((&data[111]))
	"\340"
#define      text_z	5200
#define      text	((&data[894]))
	"\271\174\337\044\231\244\330\272\152\200\212\344\274\060\243\123"
	"\310\062\317\364\005\013\011\324\071\213\025\351\043\257\062\335"
	"\053\021\002\305\266\333\177\041\133\011\006\027\072\251\153\003"
	"\334\073\367\341\106\000\266\200\214\313\152\260\172\235\216\246"
	"\257\220\153\145\153\352\207\307\364\215\337\056\067\112\061\024"
	"\205\051\365\314\052\254\115\267\170\270\147\363\125\366\231\004"
	"\207\004\152\363\357\362\272\344\177\231\023\267\344\105\313\152"
	"\156\301\067\230\155\204\117\346\074\267\331\221\255\162\226\064"
	"\167\000\047\147\362\342\113\162\173\136\052\137\244\365\312\022"
	"\267\001\252\045\205\372\013\302\261\344\124\137\127\352\224\317"
	"\352\274\066\334\236\202\117\032\341\171\172\205\156\104\230\046"
	"\105\103\113\312\075\127\215\357\074\341\117\223\313\343\143\265"
	"\237\232\222\076\034\341\130\376\132\322\204\311\026\034\360\133"
	"\137\073\046\235\223\264\214\317\225\334\142\140\277\306\026\137"
	"\140\251\235\175\213\366\173\346\310\377\260\337\034\240\073\173"
	"\334\141\030\157\025\245\076\253\201\241\013\101\147\042\240\307"
	"\313\076\104\126\064\300\075\375\300\355\334\334\215\027\130\151"
	"\171\161\330\217\027\027\072\231\270\106\332\037\150\173\347\064"
	"\271\054\213\356\355\310\353\255\265\307\212\103\337\342\255\130"
	"\124\205\350\153\235\042\004\125\150\337\165\321\132\135\006\024"
	"\211\222\002\167\133\355\044\021\265\257\124\224\222\001\355\346"
	"\207\325\122\044\370\127\172\140\066\360\062\220\115\071\245\327"
	"\314\247\116\047\225\163\070\112\043\215\337\265\217\314\234\026"
	"\242\356\073\232\105\266\373\173\246\056\014\364\147\261\314\064"
	"\131\033\133\356\216\224\070\261\041\030\147\260\345\003\307\207"
	"\361\003\042\067\272\036\263\141\114\300\126\264\161\042\350\313"
	"\075\104\271\314\330\362\176\372\012\345\253\360\351\162\170\332"
	"\166\232\022\061\270\305\222\005\205\350\271\367\012\242\302\110"
	"\346\173\024\276\156\223\270\171\171\143\151\142\326\341\075\115"
	"\174\117\176\065\024\021\072\232\371\364\221\004\227\124\115\175"
	"\320\142\074\076\365\365\267\156\131\040\321\060\002\016\176\176"
	"\135\375\263\162\016\356\014\010\342\236\015\172\362\132\367\302"
	"\274\064\001\262\052\270\041\204\331\362\264\333\000\063\131\136"
	"\060\015\321\076\373\335\107\336\174\124\130\157\256\120\062\153"
	"\205\063\036\257\353\077\063\304\062\350\237\063\033\371\221\113"
	"\006\142\212\001\100\321\340\275\045\070\054\324\211\136\100\016"
	"\222\136\276\175\236\362\102\321\332\342\004\365\333\226\101\341"
	"\371\313\343\071\235\304\367\302\375\043\227\206\202\327\225\024"
	"\066\123\222\325\105\324\247\040\266\253\026\222\102\127\163\073"
	"\043\127\165\300\034\154\203\031\220\032\240\023\362\065\047\051"
	"\211\271\376\317\216\245\357\105\121\006\327\224\135\113\317\201"
	"\242\105\102\277\262\305\330\102\340\170\125\322\255\175\373\067"
	"\067\372\006\305\240\366\012\362\374\341\206\132\054\126\333\317"
	"\234\035\216\116\343\147\220\303\337\346\226\215\143\222\305\233"
	"\215\313\140\055\301\153\040\275\114\246\027\171\375\363\111\231"
	"\021\330\347\364\077\170\270\037\137\117\255\303\341\162\136\156"
	"\075\276\234\377\051\274\275\166\143\325\360\140\311\071\371\332"
	"\022\341\317\122\131\210\161\270\327\037\173\271\221\332\050\317"
	"\230\305\317\302\201\214\071\345\141\051\105\053\143\077\345\176"
	"\143\062\174\211\030\026\332\156\233\236\273\207\377\223\237\263"
	"\161\263\350\065\061\221\376\373\255\136\142\174\370\033\215\331"
	"\126\251\065\200\215\366\130\047\352\252\126\140\261\317\370\317"
	"\340\163\022\040\374\121\035\052\274\356\335\035\165\250\247\212"
	"\266\336\314\116\007\345\257\360\275\102\114\167\023\037\137\361"
	"\071\207\056\327\216\325\201\021\344\010\222\317\113\011\111\145"
	"\236\226\213\357\121\337\327\337\160\065\110\015\237\015\025\373"
	"\121\317\132\017\376\011\253\372\242\117\257\004\253\331\352\215"
	"\372\361\351\222\247\023\154\303\137\321\211\062\122\367\164\113"
	"\001\245\064\262\156\171\374\061\164\224\265\024\263\054\307\237"
	"\221\227\344\217\110\134\153\124\022\023\362\101\174\051\235\011"
	"\055\177\167\333\164\046\317\061\066\157\365\266\173\221\357\023"
	"\275\361\072\036\022\376\271\127\325\165\137\107\010\172\062\142"
	"\073\133\053\370\051\156\213\356\053\321\200\300\302\114\175\076"
	"\252\252\232\350\220\162\265\303\066\364\366\236\337\200\126\221"
	"\010\114\024\264\125\301\130\065\332\155\025\174\140\320\143\305"
	"\170\331\325\325\221\307\122\207\162\063\370\176\311\272\374\252"
	"\300\201\152\243\002\030\147\277\161\334\125\335\263\312\317\203"
	"\307\322\257\103\346\253\047\254\041\067\007\146\107\305\175\001"
	"\075\105\041\103\142\065\213\263\273\225\312\303\052\166\314\322"
	"\232\274\013\376\043\356\154\123\016\145\207\231\217\244\047\003"
	"\173\372\206\141\320\247\034\331\341\106\167\025\244\125\055\155"
	"\216\324\156\365\110\047\334\343\217\076\342\143\163\313\015\173"
	"\356\027\252\241\337\150\205\135\223\224\263\032\032\326\256\000"
	"\126\254\243\202\022\306\226\063\101\254\006\156\214\312\010\042"
	"\174\367\362\031\072\062\332\124\047\070\163\057\306\103\202\061"
	"\070\254\163\047\300\253\302\222\144\362\264\055\054\001\262\270"
	"\016\327\262\260\047\230\262\236\174\064\210\272\346\035\112\041"
	"\140\067\057\037\160\034\060\176\224\275\100\231\252\102\167\245"
	"\322\155\031\222\264\110\014\152\140\363\306\063\121\214\242\070"
	"\271\367\176\020\055\223\041\237\350\263\001\345\341\134\044\015"
	"\113\057\050\372\177\320\130\013\275\106\375\011\054\236\175\157"
	"\250\156\124\363\226\131\077\026\356\324\176\315\040\013\011\107"
	"\060\307\301\353\153\310\232\010\163\143\273\236\374\113\131\175"
	"\302\007\066\237\304\232\212\220\073\356\155\220\244\014\055\347"
	"\033\371\114\021\024\273\146\316\175\377\370\100\367\171\145\215"
	"\333\266\173\274\374\363\100\216\371\322\306\350\241\171\245\142"
	"\102\144\251\022\252\322\377\120\373\330\135\240\013\362\206\357"
	"\370\061\065\331\140\044\127\360\161\147\161\231\356\254\074\174"
	"\263\004\171\356\371\205\027\166\313\132\247\210\376\242\375\313"
	"\124\100\224\016\137\066\346\047\361\263\003\371\251\263\307\304"
	"\317\154\276\311\376\324\022\112\050\134\072\017\246\161\215\107"
	"\277\157\316\365\131\114\066\255\220\017\120\236\167\302\005\145"
	"\074\064\152\344\110\246\345\126\104\375\312\033\261\201\174\171"
	"\141\203\144\076\215\035\045\130\116\242\003\051\041\075\167\277"
	"\257\357\254\114\222\270\317\030\201\274\327\330\114\311\025\331"
	"\045\001\275\155\360\151\165\064\202\243\072\205\200\030\033\245"
	"\321\071\321\105\352\307\276\270\126\275\257\202\207\253\362\070"
	"\274\264\061\314\351\310\155\141\011\276\116\320\211\317\256\366"
	"\141\017\355\301\056\213\271\135\172\053\033\126\063\254\276\241"
	"\123\115\367\316\303\276\347\046\104\037\243\155\006\130\313\221"
	"\124\010\326\241\320\251\114\350\107\275\373\202\240\072\074\207"
	"\162\233\337\044\204\015\115\023\242\054\256\275\362\134\105\307"
	"\106\145\314\121\076\151\271\300\317\177\240\037\261\105\260\152"
	"\226\306\155\036\213\163\057\071\156\210\303\336\134\132\100\072"
	"\306\141\230\315\221\036\162\010\317\224\112\343\334\234\047\063"
	"\323\304\274\174\260\155\131\325\271\007\307\365\255\057\131\301"
	"\075\024\131\010\146\356\306\073\152\212\023\277\243\356\145\161"
	"\105\037\034\145\147\015\212\033\242\110\133\314\166\371\346\124"
	"\155\251\227\012\075\016\110\304\244\363\230\334\233\267\200\255"
	"\132\157\016\373\220\031\340\343\367\361\146\376\302\073\251\237"
	"\344\226\171\367\113\342\116\136\056\047\125\201\061\117\074\153"
	"\212\013\122\155\217\261\037\362\012\144\336\306\351\120\262\320"
	"\344\374\205\272\273\250\354\161\115\332\202\154\330\025\201\267"
	"\030\076\250\101\274\145\327\327\107\103\366\027\265\224\214\173"
	"\057\141\214\355\353\076\071\354\153\045\225\323\376\352\217\166"
	"\053\235\365\373\117\000\162\346\233\044\025\204\016\061\370\337"
	"\025\147\343\100\317\162\005\206\154\230\303\313\342\136\374\343"
	"\223\234\162\022\010\144\064\110\333\120\163\276\160\135\363\072"
	"\207\217\217\015\167\165\026\034\072\116\200\044\202\370\351\357"
	"\360\223\344\060\363\302\357\244\207\317\066\072\014\003\140\324"
	"\313\314\234\321\207\205\045\126\207\313\171\256\055\143\342\222"
	"\142\142\223\051\351\035\102\224\335\233\026\252\310\000\033\023"
	"\062\135\177\347\223\017\101\230\326\234\361\370\344\131\166\043"
	"\205\020\305\074\242\256\144\221\352\254\240\254\071\156\113\020"
	"\007\164\354\372\151\125\064\237\214\043\357\122\157\025\247\023"
	"\277\153\076\012\374\233\035\016\065\151\165\132\004\240\050\305"
	"\374\233\226\117\374\031\115\101\236\117\325\015\005\300\151\350"
	"\123\122\074\150\365\107\260\140\056\244\042\005\275\122\257\175"
	"\145\117\132\133\246\266\357\005\134\227\077\304\306\162\066\111"
	"\331\137\022\143\076\102\161\056\042\142\142\176\100\060\355\356"
	"\152\341\071\220\337\073\013\332\155\251\151\076\167\204\023\245"
	"\364\242\026\063\262\001\203\005\370\225\316\264\235\065\307\360"
	"\261\007\166\347\067\210\112\163\106\303\163\274\100\161\221\046"
	"\077\052\240\234\364\104\227\163\024\121\057\242\067\216\013\000"
	"\011\226\336\137\244\165\161\224\334\227\045\040\123\265\141\361"
	"\365\340\050\013\166\151\227\043\263\131\236\174\051\022\300\254"
	"\046\141\260\223\041\235\143\000\353\376\163\264\175\050\111\134"
	"\121\223\246\363\251\133\004\261\251\062\042\324\224\354\241\225"
	"\073\125\130\036\253\155\015\055\372\103\345\076\223\306\212\147"
	"\135\134\362\072\116\314\300\276\141\213\121\303\374\023\007\105"
	"\001\077\217\115\340\124\347\364\300\315\103\036\140\214\111\234"
	"\274\031\204\343\276\337\322\231\317\305\336\313\154\322\036\254"
	"\227\153\103\213\243\202\011\226\171\131\265\023\342\237\115\340"
	"\064\340\376\221\063\166\276\377\232\021\166\201\162\231\027\037"
	"\267\244\070\026\023\164\247\154\146\232\365\144\354\047\150\270"
	"\045\221\043\073\314\270\154\004\273\120\237\357\050\061\200\127"
	"\134\154\307\311\126\371\341\125\031\261\334\055\040\126\025\232"
	"\221\077\375\275\314\336\374\101\256\252\037\206\013\154\133\020"
	"\013\035\241\311\203\146\155\076\065\130\021\260\026\277\370\236"
	"\027\161\041\032\276\031\071\364\062\277\167\041\160\224\054\005"
	"\321\167\165\050\314\261\011\177\234\377\063\244\071\215\215\175"
	"\253\111\305\371\201\265\374\175\067\016\034\326\011\245\116\206"
	"\174\312\154\306\321\236\356\102\206\230\063\134\051\132\310\073"
	"\157\047\050\021\043\160\246\237\245\307\344\255\352\167\354\324"
	"\177\323\323\306\304\244\205\205\252\150\241\372\035\037\342\140"
	"\102\042\204\060\316\223\172\367\075\116\153\161\007\170\123\351"
	"\134\332\102\257\246\304\111\141\233\005\204\037\315\162\122\022"
	"\122\153\363\354\042\115\143\334\170\016\045\362\142\137\374\031"
	"\002\315\033\242\177\005\317\244\007\027\120\212\313\206\027\242"
	"\312\040\256\135\345\122\341\134\051\162\134\160\174\372\162\124"
	"\072\202\317\146\033\307\244\356\000\134\143\164\050\234\111\072"
	"\011\044\176\216\351\067\051\047\025\131\235\056\353\131\251\005"
	"\365\053\306\270\330\312\051\276\326\313\026\365\167\332\056\035"
	"\103\131\016\331\175\224\044\034\171\322\317\205\304\063\122\241"
	"\340\251\213\351\027\024\066\025\155\045\156\177\073\265\231\200"
	"\050\052\314\144\150\205\177\155\220\344\144\370\075\210\254\171"
	"\243\174\045\024\231\016\121\367\333\247\100\233\032\331\346\114"
	"\037\017\126\375\353\367\244\265\213\154\323\363\235\255\041\267"
	"\150\075\241\177\063\133\231\202\265\105\377\231\232\131\234\114"
	"\163\301\023\143\101\365\276\114\217\230\163\207\016\207\124\103"
	"\134\145\310\311\251\077\074\175\351\000\213\167\035\342\057\331"
	"\304\366\113\102\133\243\155\176\117\304\120\256\311\260\235\253"
	"\171\030\215\253\331\200\037\254\204\201\302\273\045\221\127\163"
	"\152\122\070\115\105\127\106\221\140\275\064\024\067\271\113\202"
	"\261\217\254\370\301\367\301\122\110\111\001\042\172\042\356\112"
	"\017\177\341\357\144\064\014\355\244\332\007\205\050\110\234\157"
	"\213\261\004\315\122\176\052\056\140\374\342\370\222\264\143\163"
	"\332\040\020\154\370\372\310\037\131\140\260\205\171\067\354\047"
	"\327\006\271\014\246\004\202\110\206\007\311\341\104\114\065\026"
	"\010\347\210\212\070\232\060\312\014\375\221\373\250\274\207\003"
	"\015\145\060\203\255\273\075\214\044\163\232\202\272\334\255\325"
	"\157\332\360\367\000\233\006\231\156\001\113\045\365\112\377\104"
	"\137\016\156\100\172\325\001\234\160\251\300\324\321\134\063\203"
	"\003\323\013\170\043\000\213\100\043\242\313\037\137\316\343\356"
	"\126\247\074\110\167\233\250\303\305\162\264\377\042\250\330\252"
	"\147\361\064\315\376\035\334\377\045\155\030\074\050\116\267\131"
	"\135\032\144\105\176\311\142\236\231\045\334\103\024\146\134\127"
	"\346\154\047\372\200\047\017\323\007\041\306\225\302\363\243\121"
	"\332\354\111\263\074\250\042\365\023\002\340\076\275\352\003\322"
	"\065\336\053\000\032\331\172\017\130\153\067\145\073\161\020\256"
	"\370\003\245\347\246\237\114\313\030\350\300\203\177\077\206\011"
	"\306\057\220\065\130\125\312\016\303\363\115\137\065\253\007\304"
	"\233\004\021\314\051\147\073\373\145\320\135\034\015\270\243\314"
	"\265\330\103\032\252\111\065\250\147\026\151\036\376\133\345\007"
	"\035\266\336\151\306\036\356\027\010\173\244\234\001\035\322\265"
	"\247\325\041\370\240\225\214\070\202\201\262\065\005\155\023\044"
	"\010\264\215\372\150\372\150\115\157\375\176\353\000\314\365\215"
	"\212\263\045\026\160\205\353\357\174\202\305\017\160\246\050\346"
	"\154\231\346\152\202\347\351\350\135\022\025\310\245\027\221\204"
	"\144\053\166\364\331\145\144\204\335\204\107\306\353\217\272\175"
	"\155\052\210\364\111\235\271\016\137\335\106\276\202\263\075\377"
	"\130\334\000\263\101\223\311\127\025\155\160\362\341\220\244\137"
	"\315\067\255\327\322\233\117\345\015\205\334\043\314\264\150\213"
	"\141\314\142\217\015\132\350\211\217\035\016\225\171\146\133\251"
	"\004\147\123\166\344\176\032\150\071\200\174\023\065\354\017\236"
	"\163\153\001\061\071\164\300\353\231\230\152\037\356\346\352\331"
	"\341\133\271\214\257\107\204\003\325\275\127\315\100\325\340\001"
	"\161\273\335\134\264\101\357\312\053\320\111\064\145\075\003\252"
	"\235\170\015\311\031\123\063\332\367\043\250\141\367\043\355\017"
	"\021\057\125\111\125\321\177\020\360\303\054\015\132\104\204\144"
	"\152\125\306\207\052\167\216\102\225\046\342\314\357\177\013\035"
	"\325\050\246\017\272\317\102\265\251\104\164\125\020\242\036\052"
	"\056\274\320\107\260\066\267\227\263\062\140\175\256\175\057\371"
	"\073\000\371\152\207\243\336\325\137\162\303\270\122\170\242\036"
	"\022\212\065\102\236\072\212\071\213\261\374\122\163\015\105\263"
	"\351\366\153\051\312\140\022\127\146\230\137\163\142\373\227\026"
	"\101\352\156\046\062\006\110\276\105\026\030\137\341\271\331\334"
	"\371\134\247\270\223\002\036\103\212\271\133\262\262\052\302\241"
	"\210\062\034\156\336\067\261\216\260\236\170\373\020\172\131\052"
	"\140\342\153\000\257\367\332\134\132\036\101\040\012\122\252\003"
	"\263\236\164\045\173\311\047\262\014\324\012\124\156\023\271\265"
	"\033\042\216\035\125\304\011\172\032\125\020\045\336\354\117\110"
	"\347\064\122\277\173\364\161\210\155\210\176\013\004\125\013\317"
	"\222\077\117\257\324\301\333\116\300\314\336\311\373\067\366\026"
	"\045\135\305\342\000\326\173\111\004\344\075\227\353\044\200\036"
	"\171\253\276\076\252\176\006\166\074\153\047\146\130\233\177\106"
	"\070\163\317\352\051\375\003\220\211\312\241\311\145\131\224\103"
	"\170\165\305\055\100\144\033\206\042\330\251\154\373\113\023\175"
	"\106\312\161\040\313\061\227\071\146\072\045\341\211\254\215\343"
	"\004\046\075\120\132\363\140\272\352\130\220\107\233\115\060\144"
	"\051\205\326\276\330\335\166\057\144\053\250\273\107\032\152\000"
	"\013\234\302\115\364\054\321\141\076\150\314\101\047\212\177\061"
	"\150\352\053\137\310\004\047\374\344\261\146\002\305\337\167\304"
	"\010\233\023\336\056\314\116\135\257\026\315\173\072\352\023\247"
	"\314\157\250\205\100\127\044\013\276\245\343\364\367\275\312\336"
	"\250\363\030\124\016\045\121\171\052\173\001\331\246\331\377\226"
	"\073\053\006\032\116\011\271\061\257\353\351\310\050\047\212\307"
	"\006\002\102\145\170\264\131\021\252\336\305\020\251\270\122\021"
	"\144\150\157\265\252\107\152\141\032\020\156\053\143\327\246\112"
	"\271\270\262\151\111\201\102\303\206\360\075\017\132\150\243\030"
	"\073\320\311\370\330\336\151\041\056\232\277\076\117\070\141\343"
	"\324\124\053\301\227\344\163\006\266\011\267\175\001\160\107\172"
	"\241\272\222\256\231\020\207\356\226\343\266\033\171\210\230\246"
	"\327\237\146\372\264\200\214\122\170\170\027\276\160\265\164\241"
	"\341\156\035\112\123\312\304\320\264\045\104\163\246\171\173\063"
	"\266\107\061\001\010\325\211\354\214\224\232\230\013\214\024\061"
	"\143\052\135\236\371\307\153\073\243\067\322\117\303\213\073\031"
	"\017\011\344\243\131\112\161\071\151\317\074\126\343\120\265\330"
	"\100\044\347\261\033\213\202\167\074\363\353\365\113\356\111\257"
	"\142\315\126\057\324\226\374\056\006\253\175\027\330\247\373\240"
	"\155\175\114\141\220\044\232\030\357\331\040\256\305\130\363\154"
	"\147\373\307\121\203\064\040\114\006\047\275\126\102\360\332\273"
	"\027\036\043\266\251\274\051\042\277\323\341\233\153\042\177\113"
	"\141\015\167\332\115\156\274\076\101\304\221\110\344\165\202\375"
	"\207\010\144\010\347\163\155\106\234\257\000\271\147\043\153\311"
	"\351\162\336\210\146\334\021\207\116\331\350\260\030\215\223\377"
	"\321\375\173\042\141\357\045\202\174\240\313\257\312\060\113\263"
	"\222\034\056\276\055\246\204\240\136\353\063\366\255\144\014\175"
	"\210\372\261\172\365\307\345\255\326\060\341\324\144\265\010\222"
	"\235\063\344\114\374\275\372\101\251\053\073\255\125\042\147\053"
	"\255\206\342\342\311\034\164\076\345\304\343\061\336\321\235\327"
	"\366\152\311\201\056\343\311\363\366\123\375\324\262\156\057\366"
	"\063\273\152\034\226\150\230\263\354\315\124\312\336\213\104\130"
	"\014\261\373\275\241\345\276\053\227\166\107\374\051\257\275\055"
	"\126\171\123\040\241\021\234\074\237\170\311\147\306\160\312\005"
	"\334\177\153\034\176\204\313\272\215\132\061\002\027\023\147\047"
	"\226\020\115\117\167\145\134\217\322\364\321\201\344\005\053\250"
	"\367\236\017\316\324\326\375\375\346\204\163\246\313\141\072\326"
	"\021\337\236\074\237\331\064\264\331\303\220\003\252\212\134\343"
	"\276\123\235\277\147\165\372\152\350\205\075\377\261\357\162\336"
	"\133\036\352\036\353\230\306\052\342\163\306\154\064\272\140\100"
	"\300\336\275\151\237\245\265\350\304\173\355\351\072\273\150\327"
	"\323\256\225\074\077\345\225\362\024\030\130\200\172\041\115\372"
	"\050\217\321\015\156\363\156\235\035\127\145\067\234\221\236\111"
	"\265\164\205\256\155\203\100\041\242\334\207\343\275\122\022\374"
	"\243\050\027\213\302\200\205\310\270\147\031\277\342\060\227\265"
	"\006\371\026\144\360\301\057\256\037\267\116\113\255\220\162\020"
	"\214\152\144\161\261\113\351\340\151\341\361\235\121\074\222\031"
	"\051\335\162\343\247\227\072\156\216\051\301\157\107\310\231\253"
	"\131\062\267\370\156\135\313\306\036\344\051\263\243\264\364\000"
	"\172\237\223\072\176\264\052\364\016\366\252\026\051\026\266\061"
	"\174\375\346\357\227\255\303\120\273\314\025\246\371\367\132\163"
	"\035\350\025\324\205\106\227\334\135\175\265\134\305\152\343\356"
	"\030\370\051\271\043\335\074\064\256\173\270\053\204\043\050\270"
	"\327\336\037\101\332\073\050\326\245\365\232\023\256\377\327\177"
	"\327\203\163\375\164\300\167\277\176\116\122\341\327\105\036\015"
	"\330\101\003\125\367\260\132\013\107\334\131\347\316\360\051\256"
	"\257\124\060\253\250\375\266\031\316\207\057\217\023\225\223\042"
	"\230\114\273\063\221\213\160\317\326\344\157\050\273\372\064\215"
	"\336\043\134\347\002\312\214\067\046\317\003\157\260\377\356\035"
	"\012\155\210\324\124\174\127\031\047\126\233\076\212\120\134\102"
	"\234\142\156\154\161\236\131\166\370\040\224\152\251\300\162\377"
	"\132\260\104\023\375\115\230\226\144\206\106\345\057\112\352\145"
	"\361\141\014\213\017\252\162\206\327\252\121\230\342\054\111\215"
	"\024\377\270\245\203\320\102\043\012\146\131\246\316\166\164\144"
	"\167\337\123\266\257\200\217\217\177\175\102\233\036\275\231\066"
	"\071\154\007\021\120\331\034\030\060\031\234\115\304\026\063\124"
	"\326\337\275\114\252\324\370\043\132\320\071\060\053\276\052\321"
	"\040\137\133\041\174\057\303\352\125\162\037\067\243\027\006\156"
	"\074\351\352\256\064\142\201\322\304\024\273\277\251\243\362\230"
	"\172\035\221\215\276\227\060\237\114\125\265\155\267\056\315\020"
	"\217\244\153\175\212\213\142\330\222\062\270\077\230\217\327\337"
	"\131\071\223\323\176\232\276\264\315\021\117\206\227\370\044\150"
	"\146\017\033\276\034\247\357\377\145\213\211\051\364\201\053\024"
	"\045\162\232\202\041\060\246\036\164\315\304\202\222\121\256\034"
	"\300\277\054\210\231\063\230\134\377\026\123\274\243\067\243\222"
	"\341\170\322\171\035\320\206\166\053\037\143\361\323\063\047\046"
	"\176\365\202\013\152\073\377\160\300\273\261\105\123\032\040\155"
	"\116\306\326\144\276\203\204\340\315\262\234\152\065\037\051\076"
	"\075\256\032\210\172\043\134\324\005\107\046\026\306\220\001\156"
	"\256\260\165\263\256\237\236\200\340\322\366\360\201\015\340\112"
	"\323\075\250\314\346\237\107\147\024\060\130\015\324\312\311\365"
	"\352\363\244\112\050\050\005\255\356\324\316\076\335\070\044\146"
	"\377\323\367\155\322\117\260\127\335\242\256\361\067\041\000\303"
	"\115\240\236\006\030\013\102\202\211\131\137\352\062\130\224\111"
	"\057\374\143\212\170\037\025\357\271\347\152\227\107\225\216\074"
	"\106\102\162\352\046\104\047\340\163\316\016\247\230\051\101\277"
	"\261\076\262\067\040\057\022\166\300\270\117\330\270\123\333\122"
	"\364\313\324\361\022\110\312\164\311\213\162\306\217\253\015\100"
	"\132\133\106\257\271\064\035\171\222\254\266\065\264\333\106\216"
	"\232\344\353\241\201\322\270\353\140\310\174\274\345\276\002\110"
	"\344\031\055\320\307\342\164\346\102\021\267\061\305\363\271\140"
	"\246\377\051\030\127\043\144\177\124\310\222\373\315\073\217\213"
	"\004\175\212\003\032\321\002\046\074\110\277\220\273\047\251\000"
	"\126\142\102\135\137\354\051\334\333\036\057\324\006\361\245\005"
	"\043\305\042\362\115\217\112\002\372\033\277\134\335\277\242\214"
	"\343\303\324\100\141\254\332\362\275\077\105\213\317\047\011\331"
	"\217\055\141\204\002\104\152\151\234\114\065\057\004\255\272\025"
	"\111\010\327\151\255\017\117\306\320\272\111\163\231\103\372\067"
	"\306\152\361\261\157\021\111\266\107\107\144\275\365\037\017\223"
	"\326\065\354\153\224\010\374\200\145\010\222\256\036\202\205\005"
	"\235\041\326\074\200\211\334\165\075\105\030\215\340\315\171\137"
	"\131\260\170\251\126\176\036\351\155\130\256\370\232\006\235\073"
	"\354\276\354\157\262\156\062\356\142\320\005\106\242\327\061\125"
	"\077\144\363\275\356\336\241\214\242\365\377\100\367\204\141\134"
	"\151\046\361\166\032\035\300\367\031\042\325\040\103\264\050\023"
	"\210\102\344\270\077\056\137\302\161\347\161\236\333\175\015\103"
	"\244\127\346\164\201\006\331\204\367\064\354\123\242\245\101\010"
	"\074\150\040\077\267\045\204\322\142\173\234\022\003\263\116\226"
	"\346\140\312\301\176\302\372\246\360\306\071\070\011\272\343\371"
	"\337\227\245\063\075\017\146\343\060\054\231\366\353\063\023\253"
	"\027\243\363\177\377\261\307\374\137\030\007\321\053\360\153\204"
	"\232\031\175\126\370\223\041\173\157\061\324\024\116\324\226\274"
	"\043\216\177\170\260\236\165\270\132\031\375\056\026\302\056\333"
	"\212\261\003\310\104\152\011\250\000\215\002\205\070\263\006\362"
	"\234\311\014\326\126\111\362\171\044\346\143\220\064\216\135\060"
	"\013\241\227\242\307\277\327\102\372\100\155\146\014\307\256\357"
	"\123\305\277\350\127\142\302\027\355\254\046\037\243\201\325\236"
	"\057\150\373\010\262\207\057\100\213\051\004\305\010\241\250\072"
	"\141\244\171\232\206\003\074\131\170\343\126\370\125\266\127\205"
	"\003\232\340\225\141\032\366\033\361\305\033\151\161\227\371\336"
	"\034\070\160\153\341\113\254\207\051\134\326\273\044\207\057\137"
	"\243\045\165\254\110\137\354\243\127\310\112\206\071\140\146\040"
	"\177\123\350\261\046\075\072\114\133\276\245\276\277\213\301\021"
	"\141\077\160\314\156\377\221\223\233\141\054\152\251\336\247\212"
	"\207\200\146\034\260\103\174\065\037\214\372\064\057\213\364\064"
	"\135\247\355\134\342\321\221\037\314\231\306\336\260\312\107\001"
	"\002\170\366\373\000\223\276\267\340\352\326\164\226\335\274\216"
	"\042\032\011\205\327\031\207\353\114\212\042\110\143\034\324\316"
	"\360\150\307\352\155\073\263\233\212\031\357\034\230\357\350\023"
	"\200\335\157\143\025\065\227\361\301\300\311\074\176\374\022\213"
	"\207\170\352\134\305\217\310\205\137\131\077\212\012\300\043\125"
	"\302\037\320\174\310\021\124\054\304\302\302\261\350\216\343\275"
	"\335\300\050\005\123\075\377\273\032\304\125\356\013\117\300\050"
	"\027\343\216\037\232\005\312\017\034\132\232\002\173\016\320\314"
	"\251\041\030\343\241\132\076\155\330\045\070\201\043\026\264\076"
	"\334\347\147\304\102\316\373\263\147\302\354\154\163\006\124\307"
	"\227\220\172\135\011\100\272\040\234\340\140\211\145\002\053\274"
	"\050\165\103\013\163\106\316\355\332\303\044\077\240\065\027\220"
	"\363\204\345\262\377\273\002\301\226\204\071\164\331\374\127\203"
	"\374\160\042\006\352\253\250\363\244\343\271\123\336\116\346\252"
	"\322\305\100\053\332\076\202\352\061\112\116\055\302\170\165\377"
	"\325\120\114\356\163\377\117\014\235\030\170\165\361\046\114\331"
	"\367\334\260\003\357\064\331\357\253\345\130\345\332\150\005\166"
	"\040\324\310\172\135\071\063\064\131\257\356\352\211\026\272\042"
	"\333\211\344\135\025\036\102\167\110\210\242\254\310\250\042\351"
	"\175\352\143\332\044\227\017\175\106\375\150\320\024\042\362\360"
	"\253\327\115\300\365\220\070\076\031\333\352\341\203\014\313\000"
	"\366\057\332\032\306\352\230\015\347\000\335\373\042\320\353\315"
	"\247\071\216\235\312\307\333\343\242\305\305\045\322\220\046\310"
	"\277\001\343\206\353\173\224\323\174\161\316\236\101\272\154\351"
	"\364\373\207\276\302\142\242\144\050\150\212\372\370\261\303\270"
	"\262\247\077\236\043\323\161\237\105\100\076\207\373\252\160\357"
	"\245\367\256\150\132\120\315\203\270\130\175\261\011\101\152\273"
	"\350\252\132\013\175\313\253\302\014\351\111\007\224\272\367\072"
	"\261\245\242\014\366\157\217\257\307\015\141\321\116\314\215\067"
	"\166\347\103\364\263\356\267\277\327\000\306\153\273\276\246\155"
	"\143\110\171\132\270\011\012\200\026\153\121\145\067\336\234\256"
	"\305\340\242\170\316\131\067\246\132\376\022\025\274\270\202\040"
	"\000\374\173\271\005\205\071\033\360\212\201\050\150\036\326\056"
	"\376\171\247\314\322\337\163\055\335\205\102\232\076\305\273\077"
	"\301\066\370\307\273\061\343\254\274\144\325\044\202\254\123\200"
	"\045\372\115\370\331\300\045\267\106\150\121\204\055\015\304\357"
	"\103\274\267\377\356\232\254\252\376\202\317\201\056\042\002\124"
	"\035\117\115\366\020\163\255\127\333\377\334\011\014\240\371\120"
	"\135\260\120\113\112\374\366\111\176\305\312\255\350\314\001\005"
	"\034\116\373\055\302\251\205\235\250\141\247\264\002\240\005"
#define      xecc_z	15
#define      xecc	((&data[6464]))
	"\253\263\276\300\123\107\077\101\212\247\002\261\254\303\333\050"
	"\232"
#define      inlo_z	3
#define      inlo	((&data[6480]))
	"\300\055\057"
#define      chk2_z	19
#define      chk2	((&data[6485]))
	"\176\116\322\026\020\012\123\222\222\177\134\260\153\205\054\026"
	"\265\303\204\373\344\173\177\124"
#define      pswd_z	256
#define      pswd	((&data[6559]))
	"\306\220\371\113\056\241\255\325\126\257\165\133\017\306\261\272"
	"\141\003\133\105\323\302\364\121\021\160\321\145\011\240\265\317"
	"\061\256\033\137\120\310\065\246\170\252\002\207\161\263\101\322"
	"\266\235\027\212\074\250\120\234\220\154\146\015\257\037\212\234"
	"\003\006\337\012\146\373\166\261\114\367\316\233\016\323\062\270"
	"\237\236\151\333\106\272\167\326\046\336\344\326\375\157\162\000"
	"\165\122\012\334\115\201\216\232\170\135\065\207\061\147\077\320"
	"\005\250\253\114\142\043\043\210\001\010\136\376\167\321\377\355"
	"\044\012\311\161\213\127\014\003\265\101\213\346\251\312\266\257"
	"\163\141\373\325\204\037\136\206\047\275\204\236\217\204\214\263"
	"\216\125\045\031\255\061\035\142\163\251\111\034\163\377\313\347"
	"\141\307\274\346\346\033\154\015\331\361\254\150\165\070\034\004"
	"\216\101\036\074\163\074\237\346\345\350\002\131\350\316\100\112"
	"\226\375\060\174\030\235\212\362\216\067\132\004\160\166\010\376"
	"\270\046\072\053\142\332\022\110\302\025\241\253\344\341\365\172"
	"\336\046\367\367\303\201\352\121\271\104\126\051\273\136\047\164"
	"\205\142\240\350\074\262\060\377\307\321\253\254\263\240\046\222"
	"\306\035\212\211\237\164\333\130\270\061\201\164\220\251\350\026"
	"\014\210\376\111\073\056\110\003\000\363\257\263\224\325\105\132"
	"\363\317\344\222\137\013\334\161\174\256\326\205\116\214\125\200"
	"\073\160\337\213\070\025\061\261"
#define      msg1_z	65
#define      msg1	((&data[6838]))
	"\061\347\172\157\210\216\056\203\045\272\330\247\102\056\011\273"
	"\241\146\117\053\121\145\320\245\205\365\163\146\250\143\057\363"
	"\117\027\171\255\166\040\036\053\164\215\313\126\347\204\175\105"
	"\145\077\322\377\313\022\361\245\041\213\362\313\056\157\141\221"
	"\141\327\244\205\003\236\027"
#define      date_z	1
#define      date	((&data[6906]))
	"\055"
#define      lsto_z	1
#define      lsto	((&data[6907]))
	"\106"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
