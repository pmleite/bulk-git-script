#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -f bulk-git.sh 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\004"
#define      tst2_z	19
#define      tst2	((&data[4]))
	"\014\276\347\155\253\236\156\343\312\165\227\364\016\164\010\201"
	"\263\304\367\150\267\167\115\175\032\233"
#define      opts_z	1
#define      opts	((&data[27]))
	"\213"
#define      chk2_z	19
#define      chk2	((&data[28]))
	"\262\146\336\276\270\212\256\315\106\152\147\244\221\321\351\122"
	"\203\017\350\340\255"
#define      msg1_z	65
#define      msg1	((&data[51]))
	"\023\152\360\107\052\055\077\041\172\264\036\174\121\170\231\071"
	"\201\253\311\333\137\160\062\072\037\156\341\076\343\227\300\346"
	"\351\054\270\204\122\343\113\203\012\233\000\334\070\200\221\042"
	"\264\305\171\013\345\133\170\220\306\276\057\216\257\017\122\034"
	"\064\261\071\336\235\005\233\152\166\275\175\127\206\171\143\104"
	"\140\261\301"
#define      tst1_z	22
#define      tst1	((&data[133]))
	"\311\046\033\101\224\016\323\221\246\022\243\340\152\153\330\274"
	"\053\127\111\014\054\263\261\344\166\367"
#define      chk1_z	22
#define      chk1	((&data[160]))
	"\236\166\271\300\200\013\224\276\251\171\275\110\273\272\161\211"
	"\105\234\056\244\333\264\314\045\236\262\340"
#define      msg2_z	19
#define      msg2	((&data[186]))
	"\031\364\045\052\131\344\347\227\011\042\267\277\351\166\153\111"
	"\337\104\014\153\272\135\326\067"
#define      rlax_z	1
#define      rlax	((&data[209]))
	"\234"
#define      date_z	1
#define      date	((&data[210]))
	"\075"
#define      text_z	5218
#define      text	((&data[719]))
	"\025\344\127\371\132\117\165\261\363\024\050\222\306\011\020\026"
	"\357\051\320\114\377\010\001\134\272\031\376\314\342\142\132\367"
	"\106\262\360\241\002\146\122\366\173\173\210\101\204\230\130\163"
	"\302\051\300\302\061\301\037\354\332\035\270\274\177\023\264\306"
	"\306\245\147\310\013\272\276\207\065\107\311\271\340\041\055\243"
	"\112\355\145\174\257\204\150\212\242\041\107\041\065\373\350\374"
	"\240\117\304\254\012\203\063\077\313\374\371\254\035\046\117\150"
	"\024\264\344\304\071\115\116\333\156\225\375\244\220\345\240\060"
	"\065\145\334\077\351\020\177\264\014\170\141\052\237\260\223\263"
	"\145\167\167\236\305\306\171\064\133\166\330\354\134\170\035\221"
	"\335\372\320\306\012\117\173\027\310\334\102\147\214\325\033\362"
	"\115\223\220\022\131\012\106\265\201\036\242\335\226\277\157\164"
	"\271\100\072\304\217\265\333\130\221\035\277\036\363\332\020\100"
	"\155\241\122\307\253\231\175\054\267\037\012\116\336\171\302\230"
	"\271\375\134\111\262\070\241\104\126\140\142\111\073\163\211\251"
	"\024\334\161\277\165\356\353\055\015\365\174\353\156\076\203\050"
	"\074\340\161\356\030\022\063\156\163\225\267\257\010\100\131\034"
	"\034\312\334\222\270\307\277\305\275\073\261\054\172\065\124\266"
	"\025\306\245\055\330\330\233\114\156\123\373\167\223\124\223\260"
	"\036\160\103\327\070\002\234\365\076\116\042\270\203\167\157\230"
	"\075\024\306\026\355\142\142\133\265\136\323\111\262\147\371\321"
	"\327\074\250\017\077\105\005\175\223\047\066\027\237\245\257\335"
	"\272\166\364\250\330\126\004\215\265\327\326\147\076\320\070\025"
	"\015\341\044\114\046\051\312\272\121\000\321\361\246\200\317\141"
	"\366\303\011\317\032\015\134\317\344\062\067\042\003\160\070\020"
	"\121\134\134\167\206\047\061\330\047\003\312\316\204\231\057\173"
	"\134\070\112\167\105\246\107\052\331\176\115\334\356\205\354\077"
	"\342\111\267\150\160\351\101\230\354\013\147\160\244\226\353\001"
	"\317\065\171\024\333\300\077\264\076\214\221\055\021\175\154\364"
	"\307\043\135\067\015\236\320\371\252\067\151\116\315\124\120\235"
	"\212\311\261\145\212\361\032\310\175\254\365\217\052\142\203\361"
	"\206\341\051\223\177\371\214\051\061\366\170\377\107\340\333\211"
	"\312\065\032\010\127\072\063\277\064\067\112\045\125\213\141\231"
	"\153\014\377\233\041\054\266\162\251\000\035\027\014\372\012\126"
	"\127\206\220\055\300\045\117\355\014\234\140\141\151\052\306\351"
	"\314\365\311\050\346\365\134\126\305\240\053\140\103\137\133\342"
	"\365\063\265\324\240\317\103\237\106\000\064\270\306\154\370\041"
	"\257\333\023\320\271\017\253\053\237\203\015\134\115\051\252\346"
	"\310\067\127\237\201\307\064\066\076\374\070\031\313\327\237\132"
	"\330\335\351\250\273\007\107\061\114\053\015\045\006\364\035\167"
	"\065\204\017\050\006\144\004\165\002\172\121\364\306\225\131\014"
	"\231\211\372\373\263\212\074\025\216\140\017\137\255\264\352\204"
	"\301\201\176\150\272\366\062\153\360\146\366\013\264\306\013\040"
	"\055\327\272\003\036\025\201\077\007\131\305\136\160\302\330\002"
	"\154\154\206\336\367\004\312\004\351\252\230\016\127\360\336\034"
	"\175\367\310\306\261\125\302\100\320\304\235\246\141\325\064\321"
	"\253\232\336\363\036\253\237\136\204\150\046\034\300\377\037\165"
	"\112\044\246\147\336\160\313\141\321\117\217\253\113\300\116\150"
	"\257\023\210\356\216\055\124\300\277\356\241\323\310\144\263\000"
	"\247\076\337\205\117\155\271\246\131\066\353\152\327\034\045\153"
	"\025\234\034\115\330\002\336\261\171\024\067\170\215\363\137\113"
	"\237\235\153\335\137\126\134\176\012\177\261\130\277\152\260\314"
	"\242\335\031\253\202\314\357\062\342\170\347\375\051\301\122\024"
	"\242\042\267\220\050\317\271\222\150\302\363\324\322\213\375\347"
	"\237\136\146\147\356\203\277\172\206\136\333\146\144\155\014\144"
	"\330\126\174\064\130\074\016\141\302\145\232\332\160\040\212\045"
	"\211\276\077\127\133\124\160\066\352\205\022\167\221\031\005\104"
	"\067\275\233\272\066\372\132\217\232\364\330\154\205\233\031\020"
	"\051\333\322\310\037\215\012\201\101\127\175\170\216\053\312\210"
	"\223\371\266\275\045\340\303\256\351\370\233\221\064\030\363\200"
	"\233\137\034\220\243\060\052\027\342\344\144\030\321\043\174\354"
	"\057\051\132\106\363\301\242\121\257\070\150\040\331\121\164\331"
	"\101\055\366\264\314\306\267\321\011\221\002\347\302\006\004\232"
	"\240\205\314\274\377\100\013\164\053\015\051\034\363\071\066\261"
	"\050\104\075\225\100\177\127\313\301\363\152\261\251\300\275\355"
	"\227\175\061\245\175\145\171\321\334\156\121\170\017\100\343\052"
	"\017\167\101\327\230\036\243\124\210\353\150\155\301\232\257\230"
	"\052\376\153\074\106\014\327\055\351\017\200\115\107\025\331\377"
	"\340\360\207\141\140\365\262\300\362\321\127\203\273\025\013\130"
	"\276\252\064\177\201\033\130\050\256\257\074\344\301\125\351\336"
	"\074\243\224\041\014\157\201\072\357\343\104\310\261\004\023\122"
	"\055\143\066\216\313\350\160\323\167\214\142\021\026\154\024\356"
	"\274\223\220\243\326\225\373\175\235\125\021\352\223\112\112\134"
	"\251\342\271\051\370\362\215\122\051\360\306\052\357\334\305\027"
	"\335\035\172\335\103\351\355\015\257\006\276\202\300\151\242\303"
	"\325\205\152\064\207\351\130\346\107\303\272\233\036\232\007\174"
	"\151\346\301\130\060\337\343\111\364\325\122\120\161\162\052\125"
	"\265\324\127\026\171\310\050\335\233\110\044\262\120\330\131\234"
	"\263\144\174\376\013\216\222\162\062\152\115\176\340\257\237\325"
	"\042\354\126\221\044\273\232\163\242\000\144\110\345\076\062\131"
	"\101\242\067\246\234\372\160\145\103\007\252\037\232\221\252\073"
	"\105\144\027\130\155\360\364\326\215\003\161\252\334\135\225\112"
	"\200\151\271\045\220\011\203\006\065\266\342\103\036\046\003\046"
	"\025\206\011\347\220\140\173\157\166\054\326\141\333\226\325\134"
	"\034\123\347\330\252\375\357\225\222\321\352\234\106\110\301\120"
	"\055\047\272\100\342\065\141\306\105\035\143\150\322\174\336\233"
	"\170\377\322\041\001\054\225\111\066\344\247\062\275\366\101\142"
	"\320\171\366\362\363\154\322\141\354\107\006\014\321\323\053\237"
	"\121\100\306\244\141\164\327\117\023\172\111\121\113\064\361\322"
	"\203\302\157\303\275\010\146\265\266\241\000\056\301\145\263\054"
	"\031\102\301\013\256\314\307\206\110\246\165\103\375\162\332\251"
	"\036\146\134\174\003\257\072\270\274\101\334\373\203\005\367\050"
	"\055\267\122\073\250\272\176\053\270\063\000\376\151\345\136\162"
	"\177\043\303\325\124\127\074\331\222\147\133\324\353\177\165\263"
	"\016\357\267\351\124\335\273\315\216\105\020\144\022\214\367\030"
	"\103\030\210\377\377\133\027\151\322\040\120\301\241\055\143\365"
	"\006\256\260\055\324\245\156\024\103\210\302\035\024\311\354\355"
	"\124\152\050\341\220\025\105\160\257\362\346\105\311\272\266\134"
	"\112\034\015\363\143\220\274\042\040\352\215\165\055\071\347\062"
	"\045\237\127\267\032\047\164\330\041\332\101\221\336\054\227\202"
	"\101\064\211\277\223\063\357\101\056\110\142\314\304\315\121\277"
	"\133\036\166\116\242\021\277\067\131\234\216\107\313\347\071\245"
	"\057\133\055\327\362\364\040\104\210\174\051\175\334\061\011\025"
	"\053\017\077\117\276\001\372\135\241\127\370\017\355\254\274\134"
	"\011\003\043\211\324\200\153\253\050\232\110\363\132\271\326\007"
	"\320\024\214\161\037\367\242\047\060\322\236\134\142\141\023\167"
	"\327\006\147\137\350\264\260\335\011\304\225\343\240\300\157\252"
	"\166\025\231\062\331\007\305\325\233\246\166\245\021\356\222\013"
	"\232\046\124\330\262\361\365\163\163\304\232\176\352\176\036\266"
	"\200\107\342\172\267\073\271\166\003\046\031\252\337\337\322\310"
	"\177\351\344\326\020\126\375\135\307\215\051\120\226\003\340\174"
	"\270\206\362\004\017\321\342\262\357\244\344\163\221\102\004\113"
	"\336\206\326\141\070\072\171\034\141\320\164\266\325\113\077\305"
	"\230\230\265\203\076\045\155\222\156\157\202\104\053\012\042\030"
	"\301\156\107\326\333\041\362\346\026\277\100\246\374\337\253\015"
	"\235\336\027\315\077\125\316\376\044\373\316\136\253\204\224\172"
	"\112\115\122\277\004\306\227\133\337\230\104\143\314\057\305\134"
	"\126\342\071\274\164\164\311\165\273\133\044\014\304\050\066\340"
	"\026\375\171\234\257\311\012\123\254\103\226\335\162\305\005\306"
	"\004\361\036\330\134\140\223\344\035\360\053\024\311\025\376\242"
	"\134\037\114\134\267\151\226\034\037\332\162\226\201\114\250\055"
	"\331\023\353\222\301\172\226\124\371\336\250\120\133\217\276\271"
	"\073\137\153\235\215\042\335\330\051\352\203\100\335\373\222\220"
	"\002\070\102\172\112\323\061\022\064\353\022\241\136\221\154\123"
	"\053\104\352\104\265\141\154\270\211\041\203\141\172\320\165\163"
	"\020\123\311\261\215\051\316\250\276\051\175\276\227\061\353\004"
	"\130\335\235\303\232\143\032\002\071\362\246\312\236\371\246\146"
	"\341\144\171\315\264\363\361\115\244\006\215\314\140\061\011\225"
	"\132\077\354\030\166\003\230\377\051\052\221\367\167\007\117\257"
	"\172\016\060\133\237\220\341\301\210\021\061\011\177\035\277\003"
	"\341\155\051\066\204\372\202\336\274\225\165\061\240\376\110\051"
	"\101\017\173\117\334\017\146\220\234\065\324\102\014\344\210\025"
	"\104\152\115\270\237\372\122\132\371\130\021\223\173\057\202\347"
	"\213\327\241\222\275\244\120\301\030\336\212\005\120\065\172\236"
	"\163\322\242\364\113\100\344\365\365\233\007\173\064\021\344\302"
	"\042\362\352\020\237\276\257\322\314\156\205\363\232\065\032\324"
	"\054\205\315\240\305\375\026\100\074\005\074\363\044\250\167\135"
	"\202\201\270\240\205\140\354\136\030\244\171\044\330\001\014\126"
	"\310\160\350\144\134\036\157\365\305\342\142\347\323\321\045\150"
	"\362\316\016\345\202\140\317\270\003\053\066\263\122\053\224\361"
	"\310\137\151\055\255\007\316\106\010\044\252\112\121\343\165\137"
	"\263\126\370\324\331\071\117\233\216\133\216\016\150\172\147\176"
	"\077\246\324\021\253\010\132\215\221\004\343\326\102\134\113\212"
	"\371\116\174\072\345\112\300\214\120\153\011\141\333\052\122\230"
	"\120\307\114\163\343\347\312\220\223\101\265\077\130\264\352\230"
	"\332\254\053\012\040\051\230\044\012\001\124\153\322\166\125\041"
	"\063\301\204\355\060\321\143\042\116\045\207\234\326\205\341\006"
	"\114\324\347\316\347\313\115\315\173\232\156\076\265\150\317\163"
	"\373\021\067\115\070\101\162\135\363\200\130\357\275\166\201\354"
	"\201\261\200\163\155\117\270\072\132\213\353\253\364\254\144\324"
	"\312\255\112\111\363\174\163\007\303\336\075\314\107\353\032\215"
	"\362\154\034\112\243\175\043\371\051\061\371\141\140\044\355\171"
	"\322\365\103\323\127\365\004\150\150\264\327\203\213\310\055\054"
	"\344\201\217\305\056\377\105\036\321\060\020\232\022\277\200\150"
	"\261\042\042\056\211\101\126\231\057\360\336\270\176\217\160\260"
	"\251\235\173\073\374\137\365\063\311\205\242\352\310\135\374\017"
	"\233\017\372\055\160\202\361\167\255\042\173\134\251\210\053\316"
	"\312\252\077\166\353\076\123\207\067\042\257\156\120\053\350\101"
	"\246\340\365\347\366\222\307\176\121\342\067\340\275\200\160\154"
	"\352\143\310\054\025\151\205\320\264\030\110\146\306\342\344\365"
	"\175\075\241\071\056\345\360\042\300\231\020\331\050\217\370\222"
	"\351\257\051\151\340\215\325\126\242\104\250\207\174\344\004\115"
	"\021\355\154\055\145\225\143\347\164\177\067\044\373\305\254\035"
	"\015\157\172\216\233\330\301\131\012\140\264\134\171\036\017\173"
	"\046\166\204\216\372\131\271\246\202\336\241\343\370\313\256\240"
	"\163\053\210\067\125\327\362\016\235\103\076\131\025\063\266\016"
	"\241\043\272\156\342\144\077\006\220\270\146\267\107\064\365\271"
	"\275\255\324\345\104\157\347\147\067\026\365\065\334\262\032\365"
	"\060\220\014\157\117\277\374\264\311\241\173\200\354\307\121\164"
	"\251\171\262\017\225\077\202\347\151\343\161\215\144\207\251\360"
	"\234\033\142\354\157\350\321\142\027\060\166\355\073\133\250\232"
	"\175\004\216\204\146\150\041\134\357\036\015\365\003\222\041\007"
	"\366\005\370\226\063\134\233\231\346\263\334\036\236\300\334\031"
	"\102\046\335\110\000\155\145\051\124\223\106\040\244\062\140\151"
	"\003\042\045\207\240\304\304\333\347\165\170\235\251\211\024\266"
	"\360\213\321\143\116\313\207\237\324\346\042\203\202\151\150\207"
	"\262\247\367\037\234\065\065\126\274\113\126\034\146\375\066\036"
	"\356\363\313\336\015\044\055\176\104\023\265\356\036\343\077\160"
	"\166\021\335\047\253\353\165\006\214\352\134\063\132\243\234\057"
	"\311\104\074\177\232\154\373\166\167\117\074\110\276\277\351\025"
	"\374\357\330\022\331\141\260\377\062\153\112\362\070\211\233\067"
	"\301\224\055\316\061\330\362\013\244\022\360\315\163\031\150\210"
	"\113\107\165\007\235\273\061\111\322\354\026\111\251\130\366\106"
	"\216\163\116\164\053\366\307\245\063\357\361\046\074\331\116\210"
	"\027\146\341\160\164\112\013\245\367\312\165\102\262\345\223\275"
	"\247\217\044\336\271\157\250\376\305\043\272\110\272\274\362\171"
	"\200\035\272\364\307\203\240\302\365\267\350\266\222\315\234\023"
	"\064\330\012\323\076\067\036\312\166\372\047\345\334\115\000\035"
	"\174\251\220\130\035\346\153\114\223\164\250\131\222\125\042\344"
	"\162\267\154\076\217\224\156\335\244\300\330\007\167\332\071\232"
	"\136\233\237\274\204\225\346\061\110\103\071\014\341\016\222\006"
	"\174\050\073\361\120\027\252\216\107\373\101\312\345\375\004\215"
	"\146\045\122\042\112\303\210\056\006\354\210\361\050\243\125\024"
	"\106\171\235\127\003\131\007\216\241\321\152\345\026\177\066\306"
	"\061\371\041\011\012\005\036\100\155\232\120\367\143\130\341\201"
	"\367\170\150\000\122\276\125\110\065\272\107\343\315\271\225\137"
	"\226\061\137\273\150\052\347\115\151\344\226\330\175\163\057\037"
	"\007\335\375\355\037\026\336\127\353\304\201\136\253\177\017\270"
	"\136\142\207\321\216\275\361\354\223\121\115\006\056\356\326\166"
	"\124\007\364\164\371\205\077\264\055\312\166\002\152\306\214\007"
	"\140\265\351\112\210\214\143\321\203\130\134\337\371\350\062\147"
	"\002\201\322\202\316\111\057\310\341\156\134\315\214\032\006\176"
	"\022\173\255\033\036\340\045\301\337\275\166\023\022\324\062\347"
	"\033\031\012\144\317\260\021\003\232\007\136\034\023\017\330\006"
	"\164\266\012\357\207\105\245\126\226\362\357\171\311\334\113\301"
	"\063\221\163\310\336\326\114\214\324\166\310\313\322\066\163\267"
	"\334\240\050\270\035\354\346\232\223\056\000\167\000\127\057\215"
	"\212\274\100\037\052\263\070\064\316\152\326\337\042\157\223\251"
	"\262\347\050\372\333\032\213\117\233\364\042\370\241\075\110\064"
	"\273\336\243\163\112\253\331\175\156\034\037\242\266\105\002\026"
	"\014\135\075\132\137\157\252\072\030\203\031\045\211\255\264\077"
	"\323\133\243\250\266\117\166\140\343\260\255\336\354\372\004\234"
	"\323\036\017\313\077\127\001\274\100\323\252\300\363\077\333\340"
	"\264\345\366\312\276\355\027\266\327\041\073\364\345\230\322\106"
	"\364\000\307\277\123\145\163\017\062\151\104\315\024\374\023\340"
	"\325\255\111\053\125\071\152\136\256\215\076\251\306\213\171\266"
	"\076\206\131\350\055\365\106\062\162\105\120\330\104\135\150\321"
	"\341\234\161\070\301\246\257\203\252\200\266\200\272\201\052\026"
	"\201\270\024\143\323\146\111\355\021\271\331\356\135\372\367\254"
	"\314\106\227\225\330\045\067\152\010\001\333\032\371\155\376\021"
	"\306\263\173\156\004\214\341\371\350\117\141\343\357\331\052\057"
	"\052\372\321\042\166\076\337\150\067\027\175\235\301\377\132\363"
	"\160\021\217\264\000\276\026\303\367\161\017\124\316\110\002\050"
	"\234\352\266\057\177\226\111\161\376\341\027\112\073\023\164\314"
	"\204\124\320\000\323\253\024\047\362\334\113\302\154\257\027\266"
	"\244\232\230\046\016\033\173\025\253\255\174\311\306\127\261\266"
	"\120\342\110\173\176\352\340\063\223\321\175\147\344\011\041\334"
	"\366\064\110\045\101\273\000\300\311\000\233\324\362\246\045\264"
	"\062\242\345\200\256\373\010\167\301\233\226\357\257\130\274\350"
	"\326\005\145\121\261\036\367\114\201\141\032\216\214\314\073\132"
	"\103\275\020\244\267\310\174\200\235\251\340\007\005\043\256\264"
	"\336\203\177\271\004\355\006\052\371\323\342\236\343\033\013\324"
	"\075\040\331\125\220\124\101\267\207\111\165\171\074\170\135\356"
	"\275\035\001\156\164\340\261\213\145\214\076\143\317\355\350\334"
	"\256\261\201\062\024\005\101\307\302\227\146\262\141\030\255\157"
	"\101\015\177\357\250\306\302\266\011\020\060\247\031\127\247\331"
	"\163\222\001\150\336\315\056\135\121\271\327\373\352\013\132\313"
	"\121\013\321\011\264\375\221\135\225\346\077\273\217\117\241\125"
	"\166\111\270\210\253\301\267\265\035\167\235\230\105\314\255\341"
	"\034\266\077\164\202\152\135\367\251\253\204\222\252\156\245\313"
	"\003\347\313\252\211\213\001\040\304\327\153\067\350\070\310\160"
	"\114\000\352\360\307\006\043\030\226\105\361\321\005\003\071\211"
	"\243\250\351\264\216\117\255\026\032\343\174\327\224\053\135\216"
	"\063\176\150\177\201\266\025\334\111\153\162\263\330\152\133\152"
	"\171\212\273\045\367\063\142\234\322\266\024\152\346\357\244\265"
	"\100\225\133\060\071\122\107\006\267\013\373\143\226\155\156\305"
	"\323\130\050\370\264\067\216\316\231\206\342\127\216\127\305\031"
	"\241\163\060\042\045\040\212\275\333\123\301\021\144\212\106\177"
	"\313\177\074\145\056\245\025\063\113\236\104\035\375\173\144\116"
	"\026\360\117\066\334\040\223\236\215\023\003\002\137\254\265\154"
	"\005\053\052\216\374\246\002\002\340\106\311\250\106\323\125\365"
	"\217\106\376\311\263\375\305\021\167\372\360\173\342\237\021\270"
	"\367\255\230\323\262\153\146\363\137\357\065\200\355\007\054\173"
	"\106\367\233\232\025\176\116\234\231\201\341\144\204\106\345\060"
	"\037\271\367\142\370\323\141\202\045\204\022\363\310\003\161\242"
	"\203\346\050\367\111\216\006\330\315\012\006\222\241\075\110\014"
	"\332\030\372\166\146\367\022\043\277\103\125\371\121\304\025\044"
	"\142\114\223\106\036\371\176\033\136\261\224\064\102\370\244\221"
	"\274\110\255\271\302\222\052\120\010\376\351\337\324\222\164\222"
	"\007\202\001\051\047\350\307\206\274\063\116\230\140\067\034\171"
	"\243\016\050\326\112\250\252\125\115\040\222\334\127\122\133\122"
	"\376\065\104\024\164\235\236\107\071\322\365\022\114\174\347\324"
	"\164\371\012\210\302\154\130\210\355\215\226\076\322\154\117\150"
	"\127\111\166\077\207\055\177\274\175\313\034\235\174\035\330\133"
	"\355\364\227\217\063\211\300\301\015\066\210\054\041\111\337\215"
	"\326\127\262\326\366\017\312\061\354\033\174\065\004\036\070\054"
	"\337\114\365\147\224\046\334\342\166\270\035\344\166\146\147\260"
	"\225\334\011\371\125\030\232\327\265\342\311\126\106\073\002\274"
	"\252\070\034\244\114\243\157\305\175\073\130\103\360\254\320\350"
	"\266\077\205\060\067\230\341\312\330\233\050\011\327\113\156\056"
	"\036\276\243\233\310\114\227\020\177\156\141\056\235\032\242\046"
	"\262\240\224\367\150\365\307\261\143\307\004\172\352\141\223\217"
	"\227\012\177\327\104\364\277\134\147\035\172\264\041\215\241\357"
	"\254\254\320\264\035\027\004\061\350\216\075\002\113\140\060\133"
	"\022\073\174\075\211\370\264\201\250\013\255\203\276\025\203\353"
	"\316\007\247\155\030\141\267\211\345\331\047\361\104\340\356\265"
	"\334\257\036\062\227\364\321\156\246\316\023\365\161\057\327\126"
	"\073\277\224\233\043\357\255\063\222\177\305\144\131\105\041\076"
	"\346\144\174\150\105\223\163\301\231\115\036\073\262\061\047\263"
	"\016\335\255\233\024\253\177\151\213\110\324\103\077\062\047\131"
	"\207\124\134\040\105\131\150\024\125\045\145\346\000\252\324\251"
	"\175\374\141\112\217\172\342\242\346\131\303\261\330\051\273\274"
	"\060\040\277\273\313\023\057\354\067\220\073\121\013\123\073\244"
	"\262\111\057\306\303\062\365\025\276\272\036\252\166\054\033\263"
	"\262\336\074\152\247\001\046\305\041\055\175\006\123\045\146\153"
	"\314\111\262\042\362\243\110\000\363\037\343\154\155\062\267\015"
	"\231\160\270\071\217\375\352\361\073\201\356\361\032\251\323\363"
	"\316\360\207\224\115\154\150\106\355\100\214\356\042\226\363\165"
	"\142\307\036\070\005\100\152\103\322\106\143\146\062\312\105\144"
	"\353\027\322\364\144\115\031\216\263\060\035\160\047\005\261\041"
	"\202\004\006\350\354\261\150\360\314\266\072\061\103\275\000\223"
	"\336\003\135\316\351\116\115\070\201\174\202\364\053\161\047\105"
	"\225\132\317\200\244\301\357\052\016\042\043\337\152\313\311\271"
	"\200\305\357\320\101\331\303\214\122\165\132\154\133\337\032\163"
	"\137\034\305\324\256\122\244\247\232\151\012\234\010\065\307\052"
	"\347\331\223\030\355\232\351\320\301\324\127\124\325\072\342\335"
	"\057\174\041\345\317\312\250\245\160\376\173\154\150\343\153\145"
	"\170\307\042\035\014\052\362\062\354\214\034\275\001\113\071\236"
	"\205\105\061\022\034\146\346\203\163\240\170\217\217\024\336\201"
	"\203\126\251\215\033\244\050\120\354\020\074\350\331\177\207\011"
	"\155\342\256\106\245\156\250\046\150\250\104\120\164\366\214\007"
	"\136\167\231\237\260\364\131\241\361\134\367\072\104\122\036\357"
	"\371\313\001\044\353\155\240\054\061\263\125\174\160\024\162\270"
	"\046\363\244\204\015\007\371\104\101\021\302\366\225\325\107\030"
	"\031\346\254\055\250\241\365\063\235\102\164\026\130\356\075\216"
	"\005\366\230\012\003\074\317\170\272\267\333\023\255\157\371\315"
	"\062\005\213\146\263\260\164\336\341\044\315\373\252\142\200\343"
	"\077\145\271\204\037\020\053\341\327\356\324\360\041\020\252\340"
	"\063\207\162\137\216\310\063\334\033\107\013\347\332\112\052\336"
	"\171\354\167\362\055\205\024\075\144\341\376\364\024\242\360\074"
	"\113\371\221\225\040\245\327\230\166\230\205\027\275\363\004\167"
	"\215\323\111\033\332\135\215\073\363\120\303\013\204\216\174\017"
	"\006\341\376\107\333\156\267\103\346\276\361\371\067\344\217\007"
	"\351\116\306\016\330\212\041\210\072\254\127\076\053\120\010\322"
	"\337\277\341\102\015\107\117\157\263\222\204\307\001\313\261\060"
	"\264\377\000\365\005\340\222\246\326\307\253\327\135\340\330\002"
	"\011\234\320\032\311\001\134\072\130\206\065\227\331\363\340\227"
	"\261\074\203\055\105\222\024\066\244\110\124\317\360\226\017\050"
	"\376\131\331\132\120\200\172\102\176\051\210\210\305\232\364\342"
	"\335\216\336\055\230\112\341\206\013\253\222\216\014\110\007\316"
	"\131\066\233\052\103\114\126\322\024\057\052\107\155\004\157\237"
	"\325\254\252\254\020\175\104\242\221\302\110\074\056\126\256\034"
	"\216\173\116\276\347\304\033\216\142\263\042\173\314\266\031\366"
	"\243\251\033\351\346\066\045\164\163\261\303\344\360\101\103\071"
	"\206\253\060\275\013\135\165\067\063\072\160\355\252\357\231\126"
	"\340\311\067\035\002\042\331\062\253\005\343\227\332\025\256\164"
	"\244\154\324\213\216\036\041\136\362\007\366\074\251\303\264\042"
	"\141\313\012\206\306\201\323\163\304\250\134\206\041\250\026\152"
	"\131\204\143\214\243\206\205\300\124\363\044\003\072\204\270\260"
	"\304\351\056\217\177\267\156\155\064\337\302\013\172\200\277\170"
	"\041\070\126\377\041\120\223\325\234\143\042\057\156\060\120\326"
	"\311\240\153\262\263\157\074\327\206\343\166\122\105\175\157\260"
	"\231\035\064\166\313\003\116\016\312\020\024\156\301\173\263\157"
	"\121\314\315\110\212\376\374\107\102\056\272\014\247\332\322\163"
	"\343\036\237\210\224\146\260\240\376\313\033\340\233\337\142\071"
	"\114\205\072\330\337\054\254\164\033\001\222\200\357\317\061\177"
	"\133\277\261\122\117\065\202\357\264\165\013\001\225\122\315\266"
	"\164\131\364\325\067\036\170\362\120\123\124\031\221\146\346\001"
	"\312\074\076\307\030\212\204\357\327\064\300\051\264\067\245\175"
	"\166\036\277\147\023\115\252\171\125\372\012\262\176\057\212\355"
	"\110\231\273\211\044\074\361\154\032\135\006\020\102\102\045\033"
	"\124\312\247\341\062\106\054\111\101\043\223\261\330\376\100\326"
	"\045\024\222\362\222\006\176\002\357\276\243\134\102\257\113\017"
	"\317\123\271\040\073\265\215\375\327\026\310\126\207\360\114\204"
	"\040\040\137\377\301\315\113\171\332\354\174\346\202\304\163\104"
	"\254\256\376\163\023\067\337\224\277\311\160\114\021\160\135\344"
	"\240\305\245\073\361\365\324\107\347\012\326\005\315\063\224\276"
	"\062\367\025\035\371\323\160\245\221\160\204\316\051\352\070\146"
	"\042\036\226\020\141\276\245\007\047\242\177\107\145\233\245\273"
	"\301\042\015\251\343\137\103\151\046\056\045\030\013\064\350\033"
	"\117\317\047\324\160\173\350\116\346\075\123\207\016\337\336\102"
	"\226\277\025\211\352\146\041\000\326\313\266\161\105\012\075\277"
	"\272\376\340\026\152\354\033\066\146\206\115\356\101\207\031\007"
	"\341\375\342\231\177\246\150\153\323\375\041\332\253\032\117\124"
	"\131\123\251\074\160\303\025\214\244\165\256\015\004\024\206\075"
	"\062\262\000\374\047\360\233\344\103\071\315\234\200\257\262\301"
	"\143\235\254\257\045\142\202\220\214\355\211\343\355\316\071\253"
	"\027\012\300\355\377\364\150\037\154\154\015\102\307\025\113\311"
	"\234\325\223\116\073\035\077\126\346\275\002\334\114\054\076\320"
	"\035\304\261\107\130\061\100\345\133\161\333\323\160\046\235\015"
	"\374\060\133\067\115\232\215\064\127\220\020\244\275\116\165\332"
	"\023\047\041\154\130\142\121\263\324\054\207\105\123\045\122\117"
	"\125\255\207\243\110\024\327\237\245\347\104\142\066\271\075\112"
	"\340\137\266\071\302\007\355\226\064\164\333\207\232\056\327\357"
	"\333\136\222\044\163\152\303\030\122\010\172\210\301\270\322\242"
	"\027\210\333\331\220\310\160\304\075\114\114\327\172\043\307\126"
	"\201\132\172\364\304\076\015\026\106\210\237\010\100\161\252\130"
	"\372\206\062\213\116\242\117\214\357\234\143\151\277\052\300\101"
	"\204\073\066\111\172\103\140\300\313\377\311\014\161\164\145\153"
	"\372\227\367\111\072\107\325\051\343\071\223\242\144\124\344\351"
	"\217\032\062\011\136\222\312\051\221\223\066\003\007\233\156\002"
	"\063\146\113\155\255\040\227\220\132\052\063\276\177\027\247\016"
	"\062\332\030\220\155\342\272\377\166\360\002\176\214\161\200\277"
	"\327\313\054\204\354\304\025\106\356\110\004\155\140\254\174\223"
	"\206\224\043\363\167\336\362\356\317\364\154\133\146\354\033\075"
	"\270\110\301\244\014\326\353\372\037\360\150\200\234\345\023\043"
	"\172\066\026\361\025\011\337\344\376\114\077\144\071\132\241\361"
	"\242\143\226\256\072\202\251\132\162\022\332\016\367\355\061\161"
	"\044\110\143\071\121\103\035\117\220\135\264\311\267\126\273\132"
	"\271\122\011\364\324\262\116\106\305\050\124\274\026\205\056\073"
	"\316\222\164\037\325\222\157\145\357\044\057\247\172\352\001\063"
	"\074\013\047\020\275\165\126\203\236\253\077\265\061\156\360\377"
	"\001\145\037\327\367\216\074\347\262\154\216\054\127\220\140\223"
	"\234\210\244\131\376\373\334\234\247\034\122\330\213\102\327\214"
	"\247\367\143\237\205\240\206\070\015\025\145\144\246\305\367\102"
	"\115\234\234\114\230\171\350\077\225\072\027\041\175\357\256\044"
	"\346\021\303\154\262\112\244\277\137\012\043\005\320\033\107\036"
	"\270\344\152\120\135\123\217\363\216\246\024\013\226\302\060\174"
	"\324\364\350\207\076\215\106\235\227\152\243\147\205\353\205\076"
	"\317\360\216\054\103\035\037\321\304\064\334\132\366\014\327\313"
	"\000\300\122\077\115\231\334\345\003\200\115\211\153\323\307\073"
	"\303\125\147\006\163\207\327\067\273\264\222\262\301\151\176\302"
	"\051\321\001\167\152\336\134\156\136\252\370\312\175\277\005\100"
	"\025\155\107\211\364\037\300\260\323\123\142\225\275\341\127\346"
	"\262\130\136\034\066\273\213\224\145\203\136\343\102\143\044\130"
	"\321\153\341\305\212\242\165\136\365\330\363\262\271\112\231\153"
	"\243\367\210\331\263\023\156\030\226\314\373\331\060\037\061\001"
	"\213\023\307\026\265\075\164\253\025\150\135\317\263\367\072\126"
	"\357\303\057\242\327\235\272\155\152\266\106\233\326\170\234\141"
	"\213\144\167\101\241\354\354\266\124\112\205\007\101\300\135\060"
	"\204\215\323\133\053\216\311\225\104\020\060\032\210\315\174\024"
	"\061\364\125\322\340\102\210\065\214\016\075\316\317\232\377\124"
	"\050\322\257\123\140\170\350\245\210\031\300\021\346\074\045\027"
	"\060\173"
#define      pswd_z	256
#define      pswd	((&data[6665]))
	"\162\106\112\201\217\064\035\064\263\061\016\325\224\132\055\134"
	"\243\005\121\166\012\276\154\146\131\116\010\053\307\332\332\071"
	"\123\112\231\342\177\266\027\062\347\045\010\174\200\066\331\044"
	"\073\052\232\105\351\007\254\103\125\264\156\035\216\110\126\341"
	"\223\357\303\023\246\333\105\216\001\115\012\201\204\343\245\277"
	"\016\100\005\367\110\261\072\235\145\251\273\364\361\021\325\205"
	"\001\231\230\247\164\336\066\166\054\101\367\260\045\235\157\063"
	"\336\165\053\047\046\146\304\214\017\200\200\001\221\126\206\223"
	"\357\037\073\144\375\161\332\051\262\322\332\327\157\111\013\116"
	"\277\067\165\346\235\072\162\255\272\363\256\114\111\065\337\070"
	"\125\032\234\122\214\167\174\076\111\126\026\271\240\041\010\137"
	"\131\175\105\366\270\270\243\162\253\122\277\364\210\236\055\335"
	"\271\312\057\105\101\254\203\212\002\232\104\242\274\114\002\025"
	"\312\110\014\202\000\257\365\253\002\264\240\212\123\315\147\014"
	"\227\227\121\330\103\325\143\106\157\250\350\053\364\353\101\276"
	"\063\115\101\063\375\066\337\377\353\177\212\076\114\361\112\344"
	"\211\233\275\315\203\031\121\036\031\245\106\353\124\232\114\315"
	"\203\362\125\234\262\146\203\356\214\232\037\010\204\060\306\367"
	"\167\021\171\372\052\312\031\103\160\137\057\304\372\174\222\175"
	"\156\347\032\040"
#define      inlo_z	3
#define      inlo	((&data[6969]))
	"\175\266\037"
#define      shll_z	10
#define      shll	((&data[6972]))
	"\141\010\004\044\157\360\024\341\247\226"
#define      xecc_z	15
#define      xecc	((&data[6984]))
	"\251\264\067\374\074\132\366\117\117\105\074\014\052\172\262\271"
	"\250\327"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	1	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
