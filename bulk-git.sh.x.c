#if 0
	shc Version 4.0.3, Generic Shell Script Compiler
	GNU GPL Version 3 Md Jahidul Hamid <jahidulhamid@yahoo.com>

	shc -U -f bulk-git.sh -o teste 
#endif

static  char data [] = 
#define      lsto_z	1
#define      lsto	((&data[0]))
	"\013"
#define      tst2_z	19
#define      tst2	((&data[3]))
	"\116\060\146\103\166\136\227\014\246\007\253\320\033\127\215\077"
	"\262\367\145\301\120\044\104"
#define      opts_z	1
#define      opts	((&data[24]))
	"\325"
#define      inlo_z	3
#define      inlo	((&data[25]))
	"\320\122\342"
#define      text_z	5200
#define      text	((&data[929]))
	"\151\051\163\363\014\021\031\160\007\024\113\060\210\204\243\153"
	"\023\022\271\103\067\375\000\306\276\125\135\320\025\016\251\176"
	"\067\035\162\104\056\214\264\066\241\000\146\051\204\011\224\230"
	"\033\115\333\123\113\334\031\012\062\167\332\107\205\203\306\275"
	"\241\070\001\317\305\266\005\146\266\154\217\073\165\044\323\221"
	"\162\257\345\276\213\376\310\276\165\242\005\373\046\314\271\307"
	"\005\273\227\312\161\235\060\050\011\300\144\177\344\067\021\126"
	"\346\366\024\162\365\335\060\153\200\066\147\246\003\040\156\010"
	"\333\006\323\115\244\003\166\255\304\332\055\251\022\077\377\371"
	"\066\024\153\053\362\234\227\162\322\376\031\325\036\207\336\372"
	"\216\261\107\062\265\276\340\171\230\016\042\252\115\042\243\203"
	"\067\017\257\051\253\106\233\176\105\264\124\143\074\063\136\313"
	"\344\245\375\232\144\336\024\374\354\066\247\072\131\113\276\220"
	"\133\155\272\007\264\126\205\371\012\332\135\107\015\273\022\362"
	"\141\020\215\305\356\241\302\333\327\151\025\061\265\323\302\020"
	"\100\174\027\365\322\235\356\335\167\114\045\205\007\070\170\150"
	"\110\005\056\067\246\360\022\176\131\047\257\016\372\162\037\073"
	"\356\066\061\301\323\037\237\113\154\304\320\163\374\111\334\104"
	"\116\012\174\365\373\216\164\124\265\044\143\260\226\202\353\204"
	"\270\034\106\214\074\345\327\251\252\250\034\246\361\371\353\100"
	"\004\147\066\377\365\252\124\253\316\270\133\144\072\107\351\363"
	"\144\060\200\241\025\127\112\277\000\146\146\361\140\121\062\144"
	"\271\150\144\256\022\270\132\341\160\265\105\253\374\057\237\140"
	"\137\040\001\165\167\113\065\167\262\233\151\023\355\233\167\246"
	"\004\334\125\027\225\257\370\005\144\076\261\141\155\121\301\315"
	"\162\303\102\352\017\167\141\302\022\313\325\377\147\115\246\153"
	"\051\373\202\276\252\173\304\017\271\166\160\047\310\062\364\072"
	"\365\066\044\005\256\206\307\301\122\234\301\271\351\147\045\023"
	"\142\250\321\014\043\226\033\335\014\214\004\325\276\371\017\264"
	"\060\064\271\336\272\200\237\014\035\140\306\007\307\353\032\052"
	"\224\354\067\270\203\123\225\217\337\232\145\235\223\165\122\303"
	"\251\013\242\144\214\102\160\252\242\067\261\152\043\314\224\267"
	"\270\313\157\073\037\005\313\376\237\061\234\063\246\356\366\117"
	"\372\230\263\206\332\044\061\175\133\342\350\176\256\175\066\147"
	"\111\245\243\150\253\156\146\112\237\002\175\105\361\164\225\353"
	"\015\110\162\347\154\243\145\310\205\115\107\064\313\175\233\024"
	"\043\076\174\316\255\343\030\115\346\226\223\327\012\050\303\027"
	"\161\065\377\336\331\145\246\137\263\356\223\176\153\057\222\216"
	"\156\017\134\034\363\165\151\331\013\375\261\026\046\164\055\227"
	"\252\055\166\204\222\034\343\105\013\167\303\166\246\126\004\025"
	"\146\141\061\131\326\233\063\342\230\345\370\276\131\046\126\004"
	"\123\314\210\346\351\154\053\364\343\357\152\212\106\157\237\254"
	"\320\320\006\247\153\072\212\004\037\202\302\171\251\030\176\374"
	"\345\006\343\316\163\016\302\126\376\055\340\104\234\177\361\155"
	"\120\370\024\274\062\237\300\122\041\203\313\312\234\111\307\201"
	"\120\252\120\303\271\022\031\270\100\372\374\334\172\356\112\312"
	"\347\137\206\031\376\107\153\037\312\066\352\147\200\262\350\320"
	"\135\070\224\027\113\255\317\213\250\314\150\042\272\262\354\241"
	"\021\163\273\017\273\047\057\206\136\031\355\336\314\326\257\051"
	"\017\103\100\132\361\017\346\231\333\117\273\226\001\250\070\023"
	"\033\363\042\327\032\121\135\170\153\112\127\070\040\006\141\060"
	"\111\242\213\072\261\161\323\215\300\217\044\302\067\134\325\123"
	"\120\370\052\152\111\207\343\265\321\072\355\362\100\117\042\212"
	"\361\255\304\243\037\230\061\340\047\125\243\136\262\170\261\002"
	"\160\333\155\272\143\120\160\065\213\135\047\314\255\112\126\236"
	"\370\033\101\030\263\162\371\332\310\234\070\172\025\352\174\205"
	"\306\352\100\051\072\104\121\144\237\231\242\135\330\105\230\151"
	"\002\260\176\276\341\315\215\340\321\271\070\234\052\155\027\352"
	"\235\357\163\375\267\077\351\315\137\114\045\171\006\161\375\046"
	"\212\316\062\370\350\112\010\246\356\221\342\350\305\375\264\251"
	"\110\044\334\177\120\010\001\303\202\345\024\037\036\175\240\030"
	"\007\010\210\372\340\236\071\134\367\064\313\151\036\217\210\303"
	"\325\001\206\125\074\224\236\102\135\223\366\152\267\273\105\216"
	"\153\377\143\223\214\021\316\073\167\057\027\015\227\003\351\027"
	"\071\004\103\122\031\225\015\102\347\056\235\154\052\237\271\204"
	"\370\023\126\101\136\360\241\377\373\005\033\231\306\345\062\216"
	"\301\357\275\127\155\122\236\370\347\267\027\276\322\047\024\147"
	"\326\306\146\060\146\124\341\121\306\351\276\036\145\062\352\221"
	"\330\372\172\056\154\152\211\116\146\350\164\354\122\273\323\200"
	"\222\366\077\347\050\200\025\066\046\266\337\131\047\231\001\221"
	"\210\155\375\063\337\137\156\322\377\341\165\234\017\373\366\020"
	"\316\260\200\221\166\262\205\031\043\133\247\204\350\000\241\324"
	"\320\251\103\157\034\116\150\062\037\026\335\210\202\145\003\320"
	"\272\253\242\030\340\010\304\164\325\041\032\012\270\026\040\004"
	"\307\050\367\025\220\116\062\351\336\340\063\334\021\042\005\030"
	"\337\116\313\026\063\065\336\264\162\344\220\256\213\342\333\252"
	"\256\016\243\353\356\201\201\113\341\346\213\172\244\303\237\005"
	"\353\215\266\000\275\252\137\215\056\343\344\123\070\272\254\120"
	"\165\254\062\360\044\113\074\300\014\174\043\233\327\326\021\377"
	"\212\024\350\017\263\230\317\145\064\163\052\310\207\317\160\361"
	"\142\355\262\134\106\114\117\323\256\002\107\247\123\364\116\010"
	"\342\100\213\260\034\050\162\110\207\200\004\123\272\304\224\005"
	"\125\157\121\114\143\146\227\116\142\054\100\271\304\071\111\136"
	"\175\250\324\304\167\272\173\260\021\002\304\076\374\052\074\367"
	"\352\066\260\333\352\274\360\365\310\106\205\057\065\172\170\023"
	"\057\324\165\245\143\110\255\053\345\142\212\032\005\262\162\204"
	"\163\101\056\327\066\255\114\201\200\353\230\137\102\031\145\160"
	"\025\151\353\221\214\213\037\057\341\021\322\323\106\022\162\146"
	"\327\056\114\047\170\232\357\036\074\116\257\201\026\031\027\042"
	"\140\371\065\104\054\270\305\047\201\005\123\076\047\143\137\376"
	"\322\332\250\100\137\351\156\164\124\177\033\044\016\105\103\361"
	"\267\303\045\253\307\157\013\046\233\225\255\217\205\066\003\133"
	"\015\002\156\012\154\140\017\303\245\010\110\036\351\306\105\343"
	"\201\260\127\147\035\346\246\200\371\215\367\070\016\325\061\247"
	"\032\065\127\110\210\051\065\067\306\213\357\051\241\036\073\242"
	"\353\325\156\012\204\146\110\261\134\003\231\175\330\101\163\222"
	"\302\011\261\174\274\152\256\161\304\027\143\343\311\260\173\066"
	"\165\371\141\242\230\337\306\046\125\060\245\302\232\116\264\351"
	"\111\332\174\343\206\347\174\201\362\045\320\143\173\101\051\320"
	"\340\324\224\036\002\337\313\171\030\070\157\150\341\062\114\121"
	"\300\047\214\361\147\114\377\311\304\062\351\350\370\217\251\270"
	"\165\000\356\136\021\175\265\354\107\067\152\330\240\152\076\361"
	"\141\317\065\332\042\220\351\343\331\234\205\377\041\200\027\252"
	"\104\240\072\000\246\074\062\145\271\254\015\051\056\111\065\142"
	"\144\102\317\065\353\053\177\241\120\262\352\034\263\366\123\217"
	"\067\057\144\142\166\004\045\133\136\304\024\155\255\161\070\003"
	"\302\176\234\312\031\175\203\023\117\062\221\111\161\326\331\256"
	"\210\257\361\237\254\115\015\003\031\344\346\130\171\126\343\132"
	"\336\214\252\062\323\106\114\252\261\350\247\314\370\111\340\041"
	"\122\022\104\270\047\151\236\307\261\206\127\230\266\355\375\274"
	"\217\175\014\321\353\313\257\145\137\154\214\200\233\341\040\331"
	"\221\071\346\146\376\140\332\053\136\160\120\272\312\172\273\307"
	"\371\317\126\164\333\131\253\100\162\245\176\240\147\025\226\232"
	"\207\042\045\323\057\011\243\255\160\246\232\245\252\150\343\173"
	"\274\253\114\350\174\120\045\215\015\214\054\351\133\212\127\060"
	"\117\116\166\031\002\125\236\251\315\117\256\204\225\020\036\327"
	"\062\224\120\014\210\074\260\213\103\172\067\242\273\306\306\012"
	"\044\033\307\047\231\021\361\175\166\072\244\305\353\156\234\121"
	"\365\321\343\221\063\262\355\222\011\146\146\334\072\037\254\032"
	"\247\337\106\310\052\222\064\144\263\157\006\152\037\312\272\156"
	"\135\171\153\343\064\130\104\354\036\353\106\334\167\010\337\057"
	"\043\316\353\307\120\366\067\004\002\341\347\171\104\233\227\100"
	"\354\211\143\335\347\124\270\054\125\023\352\175\315\162\372\307"
	"\015\373\176\307\213\331\317\166\111\152\226\242\133\203\103\275"
	"\177\022\256\232\064\125\150\151\202\064\047\160\106\226\131\006"
	"\051\314\243\327\176\330\310\161\041\204\260\053\175\354\143\362"
	"\247\062\307\353\204\246\056\336\220\162\315\363\210\026\334\051"
	"\107\162\246\357\360\003\064\371\301\344\302\021\174\134\133\201"
	"\232\143\371\214\023\072\267\330\242\045\374\240\327\000\011\161"
	"\014\120\032\210\021\177\115\130\366\150\323\244\357\350\246\141"
	"\050\324\302\276\214\137\267\226\330\221\206\350\071\021\263\111"
	"\073\045\040\056\054\343\133\037\130\366\152\017\313\337\106\065"
	"\211\047\234\272\201\254\341\115\231\116\243\167\262\153\272\162"
	"\056\316\257\027\307\001\220\246\276\124\161\070\120\117\262\027"
	"\237\077\223\214\131\013\062\042\154\204\306\253\062\356\010\004"
	"\044\161\037\201\153\245\156\357\311\303\115\341\374\270\241\237"
	"\224\122\121\374\352\247\070\223\043\166\244\122\121\113\165\024"
	"\100\063\262\056\345\172\331\111\050\242\073\026\313\205\010\136"
	"\171\302\322\240\335\274\247\154\266\334\127\103\214\007\061\273"
	"\067\062\113\033\354\171\223\077\307\224\305\057\016\052\351\074"
	"\060\121\002\144\157\277\242\111\017\303\117\037\107\042\305\016"
	"\057\253\205\350\201\272\167\361\251\164\242\012\124\135\241\010"
	"\372\270\134\034\315\371\042\330\076\255\350\024\122\135\062\267"
	"\346\057\171\005\352\115\102\022\113\115\077\366\264\247\301\016"
	"\275\117\062\363\124\370\351\363\060\344\241\012\171\126\157\055"
	"\250\334\265\365\322\216\255\011\231\131\222\124\204\360\013\125"
	"\345\257\005\236\027\224\173\042\304\141\340\273\022\363\113\104"
	"\030\264\055\141\215\371\030\047\057\262\235\173\246\360\301\137"
	"\212\216\203\263\156\270\373\132\005\115\354\015\255\276\343\340"
	"\252\233\226\373\274\260\346\344\324\006\142\354\337\211\021\354"
	"\041\025\226\045\026\227\215\076\204\346\076\306\124\031\155\260"
	"\003\177\112\230\055\245\051\254\110\050\164\265\231\221\047\033"
	"\313\374\022\111\135\301\365\043\025\201\353\141\337\261\003\113"
	"\065\007\056\137\225\311\341\023\327\266\105\027\300\223\026\371"
	"\003\076\212\361\161\134\332\327\111\270\353\107\150\112\205\231"
	"\203\026\070\314\173\345\303\174\045\263\232\017\303\143\073\061"
	"\306\110\010\022\040\072\075\267\135\250\355\064\177\063\224\122"
	"\156\377\046\167\357\131\353\115\044\271\333\164\002\172\226\173"
	"\302\156\347\025\015\312\226\117\122\172\324\007\365\373\052\150"
	"\371\176\343\344\022\117\161\011\016\370\354\377\104\314\112\042"
	"\145\222\054\251\244\364\021\204\116\037\043\215\072\376\064\121"
	"\373\073\221\337\010\065\132\264\167\351\373\111\060\136\165\157"
	"\213\333\207\300\057\065\337\256\004\042\001\261\151\311\253\141"
	"\241\216\242\036\277\257\123\130\077\135\016\307\176\200\110\154"
	"\227\252\260\121\312\331\372\127\014\171\022\301\352\124\154\237"
	"\025\140\363\042\371\012\237\301\272\350\312\076\070\177\363\140"
	"\321\112\123\053\033\330\200\275\077\351\177\025\171\317\144\253"
	"\334\206\065\353\063\265\305\157\375\006\260\276\033\105\042\175"
	"\064\343\057\054\104\312\367\356\210\371\266\216\167\231\055\226"
	"\171\200\372\352\131\101\265\232\216\114\177\335\037\115\246\303"
	"\360\072\015\053\357\133\154\137\256\102\032\116\361\014\036\315"
	"\135\341\061\123\057\015\111\334\053\351\156\041\156\013\374\311"
	"\124\214\003\350\134\142\010\170\243\010\134\205\130\322\052\345"
	"\346\052\365\135\055\002\303\270\126\214\174\355\310\332\134\107"
	"\024\161\110\302\070\231\300\266\140\141\301\203\305\327\100\077"
	"\202\124\024\042\030\217\056\330\300\031\335\047\006\231\335\147"
	"\030\071\226\371\323\210\364\154\047\322\167\045\321\117\051\325"
	"\122\256\332\222\135\044\310\134\322\032\053\151\142\121\242\142"
	"\126\320\131\357\254\105\151\265\003\327\205\004\021\127\251\100"
	"\064\000\341\337\174\234\365\025\330\216\260\260\236\150\100\224"
	"\367\262\276\243\232\272\061\241\034\060\025\104\006\054\123\115"
	"\367\163\246\214\266\200\343\225\222\356\364\171\323\361\106\074"
	"\140\226\036\012\260\127\321\011\262\150\242\233\350\345\271\043"
	"\270\024\123\262\166\360\347\317\065\005\261\101\036\314\022\206"
	"\333\013\355\355\071\164\031\274\135\142\112\007\137\154\267\254"
	"\132\071\065\376\366\033\170\067\156\100\107\060\007\321\147\015"
	"\353\107\060\024\100\040\012\344\021\010\314\167\046\017\041\055"
	"\345\253\327\263\357\017\066\266\140\126\200\220\313\063\231\360"
	"\375\141\175\114\023\372\074\300\217\041\121\331\033\217\310\336"
	"\303\121\252\151\164\134\052\166\020\335\206\033\365\000\036\067"
	"\026\057\240\220\357\232\375\105\276\151\263\117\142\203\337\002"
	"\256\021\321\204\075\321\070\136\063\327\232\031\376\010\361\237"
	"\010\134\337\354\236\043\356\216\231\314\254\177\172\346\365\164"
	"\365\100\126\206\017\256\332\235\124\105\066\213\304\123\366\172"
	"\115\222\313\344\150\045\177\311\147\172\250\333\260\107\132\320"
	"\021\372\171\316\130\127\017\343\105\016\151\100\271\056\142\246"
	"\076\146\066\163\133\326\165\036\003\276\363\261\212\124\372\152"
	"\266\327\340\217\027\000\246\235\315\055\336\050\113\101\011\001"
	"\123\347\370\100\013\173\171\021\042\227\306\327\262\202\203\165"
	"\132\160\002\056\232\006\016\134\317\022\076\023\007\313\102\061"
	"\206\161\352\230\111\141\356\273\000\221\307\247\227\066\304\355"
	"\343\274\060\355\074\207\270\353\340\252\211\303\300\260\103\271"
	"\103\043\207\000\277\105\012\044\104\056\027\067\153\027\075\057"
	"\106\312\123\115\300\247\173\312\274\322\156\116\174\147\302\315"
	"\113\344\177\332\161\330\137\231\210\134\127\266\261\353\104\235"
	"\054\114\117\245\342\132\073\126\204\271\373\232\250\053\225\047"
	"\321\313\111\372\361\305\030\122\203\371\335\074\347\015\012\057"
	"\366\244\317\165\141\354\370\306\371\117\060\006\314\360\044\135"
	"\062\233\277\003\101\174\127\134\375\355\300\346\041\166\232\361"
	"\302\131\227\245\033\372\146\134\267\111\152\177\244\030\275\076"
	"\206\274\075\165\116\312\321\233\336\055\353\147\207\022\262\260"
	"\141\145\032\335\124\327\260\250\301\116\316\301\364\117\341\133"
	"\242\005\335\146\371\320\277\153\244\242\330\324\071\027\141\062"
	"\264\236\026\334\301\221\333\015\242\376\210\216\351\175\116\232"
	"\013\043\203\350\276\353\371\376\201\250\124\235\141\104\143\251"
	"\322\103\060\272\262\054\060\311\076\056\023\166\272\173\065\247"
	"\304\061\152\253\332\343\153\152\107\003\220\153\323\055\110\203"
	"\361\057\117\040\155\014\332\320\335\166\076\340\376\156\177\154"
	"\027\274\146\162\054\165\050\332\171\233\234\236\146\332\154\274"
	"\055\307\341\372\027\056\175\222\255\101\367\010\144\036\205\210"
	"\017\335\011\144\130\175\117\054\370\356\307\242\120\137\317\220"
	"\002\110\053\363\145\356\052\237\042\004\110\161\347\161\025\364"
	"\301\077\117\062\360\243\060\251\127\162\353\307\126\156\141\140"
	"\362\003\350\336\231\132\066\010\222\015\357\150\020\160\255\111"
	"\155\145\122\213\044\174\115\360\135\277\212\270\303\206\061\134"
	"\363\272\230\334\236\326\033\074\176\000\266\330\314\331\113\015"
	"\072\015\171\061\053\042\311\320\127\156\057\237\133\223\325\315"
	"\131\244\226\214\142\006\177\110\027\167\130\354\377\373\165\175"
	"\213\357\044\266\152\100\050\330\346\235\362\313\364\044\367\361"
	"\377\037\042\152\243\066\167\327\214\004\155\350\325\214\234\226"
	"\301\270\256\071\026\032\015\171\223\231\045\024\356\266\033\314"
	"\346\131\364\351\134\121\070\101\225\377\373\002\171\245\327\233"
	"\152\122\165\161\141\277\105\304\065\326\372\022\376\261\000\132"
	"\200\265\271\212\120\362\007\267\313\321\115\332\174\017\227\307"
	"\346\215\047\057\137\346\256\071\335\007\160\205\263\042\032\335"
	"\253\034\252\175\360\340\066\312\205\233\015\315\173\263\140\324"
	"\066\262\205\012\111\320\304\230\277\052\155\370\176\203\064\110"
	"\052\124\155\151\020\362\153\245\073\016\222\240\143\055\217\202"
	"\100\104\215\204\311\226\215\215\152\322\056\340\016\054\255\261"
	"\231\230\257\335\167\152\054\101\332\337\171\202\275\256\172\366"
	"\076\350\010\365\000\255\167\105\225\305\213\141\242\247\236\263"
	"\206\330\212\317\330\120\245\133\102\060\170\064\265\374\216\222"
	"\102\170\214\156\113\123\067\311\324\224\050\135\101\057\250\041"
	"\202\162\037\015\241\324\354\074\227\317\120\043\315\121\055\107"
	"\327\066\267\007\232\216\163\327\112\330\201\174\343\166\075\271"
	"\273\042\232\207\316\345\021\240\144\354\320\156\031\204\335\251"
	"\165\021\051\165\111\274\171\275\175\055\312\371\362\124\344\133"
	"\266\213\132\047\121\333\101\037\131\225\326\020\236\006\375\164"
	"\062\025\166\277\063\327\146\041\202\000\317\105\172\375\155\266"
	"\013\362\015\057\112\126\300\371\306\167\111\254\103\036\222\300"
	"\007\337\010\205\360\117\151\141\022\256\201\013\272\334\165\257"
	"\304\055\130\260\306\170\073\254\104\325\007\102\226\063\242\356"
	"\122\167\014\237\326\333\334\223\005\250\323\312\303\002\173\155"
	"\330\150\155\210\204\352\003\173\067\107\371\216\136\370\234\244"
	"\311\307\004\366\300\360\061\216\210\044\100\135\357\357\071\332"
	"\054\052\021\111\226\021\301\310\002\364\202\330\331\370\042\020"
	"\256\036\170\205\266\337\165\151\231\007\004\353\127\164\320\270"
	"\051\310\233\301\317\366\137\340\117\121\276\202\173\225\247\173"
	"\136\117\151\275\350\171\257\354\276\264\355\035\025\222\156\065"
	"\326\122\062\123\126\140\030\106\336\337\347\152\062\010\333\363"
	"\134\360\171\044\013\265\321\127\372\336\146\355\230\017\331\152"
	"\232\356\165\254\245\025\002\026\277\130\120\240\353\221\360\273"
	"\030\033\170\132\074\111\011\061\252\034\237\326\263\275\340\271"
	"\312\237\340\132\216\366\021\276\271\104\120\045\116\041\014\164"
	"\024\104\333\211\154\256\261\216\311\232\120\061\053\047\243\350"
	"\364\227\366\135\347\140\120\342\174\167\117\230\300\337\034\261"
	"\320\160\352\011\330\341\034\277\154\064\263\163\372\116\244\315"
	"\015\025\101\360\106\313\070\030\105\070\017\221\373\274\162\166"
	"\303\062\000\336\017\102\114\225\352\101\024\014\042\011\031\003"
	"\302\176\071\252\110\062\160\074\332\221\225\272\235\062\327\301"
	"\377\367\317\051\216\036\052\062\054\341\156\200\201\226\311\050"
	"\042\144\132\056\340\364\314\070\367\117\044\073\212\332\350\044"
	"\134\230\235\310\340\117\300\051\237\301\374\325\247\133\075\030"
	"\132\251\036\046\233\206\024\024\244\245\335\237\243\127\062\065"
	"\305\025\271\200\013\363\166\377\271\021\361\241\074\053\212\021"
	"\206\057\277\062\042\074\030\010\044\374\134\130\367\143\110\230"
	"\325\363\102\377\007\047\031\143\166\320\311\303\112\046\372\343"
	"\304\305\011\043\135\055\275\150\022\356\012\162\337\252\335\206"
	"\247\110\360\333\274\077\020\017\004\241\256\363\323\303\276\152"
	"\273\246\171\215\137\125\151\304\110\070\071\377\033\337\231\043"
	"\005\105\070\101\273\054\314\171\322\254\205\333\032\176\344\053"
	"\372\252\177\222\053\106\122\312\223\210\323\052\204\002\316\117"
	"\210\314\046\023\337\301\366\132\250\241\362\125\307\372\327\077"
	"\332\003\151\325\366\120\066\161\272\326\253\253\010\326\355\364"
	"\154\357\251\337\162\101\232\325\013\104\226\173\310\265\005\137"
	"\123\104\224\306\316\272\204\006\312\375\335\156\212\150\251\114"
	"\332\065\165\040\045\310\237\063\240\325\050\341\111\175\062\145"
	"\052\106\143\022\007\306\110\223\341\215\177\033\106\363\075\363"
	"\317\041\140\251\114\307\310\320\244\322\056\350\072\103\313\276"
	"\252\134\066\236\177\242\273\023\126\000\110\353\355\125\271\002"
	"\202\226\121\327\076\157\360\376\003\167\271\214\075\336\274\137"
	"\226\140\024\224\163\171\227\312\160\050\346\373\175\072\055\317"
	"\132\115\374\364\122\240\304\111\274\010\313\360\117\331\060\232"
	"\165\114\114\350\013\352\272\041\324\127\324\304\226\205\253\266"
	"\066\312\330\145\062\133\204\003\230\043\142\125\011\111\007\312"
	"\153\341\344\252\265\127\346\070\030\276\316\211\240\124\160\160"
	"\373\242\154\253\124\076\342\001\101\363\210\141\310\107\140\142"
	"\120\236\227\377\005\115\377\106\341\317\351\354\303\247\202\334"
	"\352\101\365\324\144\361\037\271\344\210\310\050\336\223\312\320"
	"\352\343\112\201\376\006\277\254\214\175\232\104\220\227\310\363"
	"\120\140\321\010\027\176\056\002\204\104\136\336\165\310\143\111"
	"\015\104\300\271\167\142\205\043\364\134\245\137\011\332\051\143"
	"\235\316\120\135\273\136\164\016\331\101\317\351\075\070\370\002"
	"\216\223\201\324\075\261\065\156\020\211\051\045\371\017\273\151"
	"\050\047\246\102\046\171\160\010\226\142\362\277\204\376\111\356"
	"\113\347\344\375\254\161\077\217\222\035\164\062\253\012\263\050"
	"\141\273\201\313\067\351\245\226\221\147\135\333\065\256\021\017"
	"\175\271\231\235\314\133\242\047\236\252\071\222\071\115\172\221"
	"\054\237\150\005\046\326\025\300\215\065\361\130\350\216\360\055"
	"\030\317\322\063\206\363\232\114\304\002\060\220\167\163\166\270"
	"\010\003\144\145\360\056\257\357\304\365\016\223\070\345\161\310"
	"\212\342\351\326\205\112\133\051\070\151\015\107\067\342\152\011"
	"\045\234\013\066\156\230\041\121\101\311\065\264\234\201\026\051"
	"\256\130\214\250\374\101\073\242\174\352\047\332\265\250\362\165"
	"\372\331\126\014\205\367\266\302\021\233\032\334\254\220\375\052"
	"\036\167\214\334\274\127\270\326\104\101\252\310\207\253\061\032"
	"\000\332\270\245\311\012\135\072\164\077\133\360\373\377\300\266"
	"\051\126\171\237\215\110\162\122\074\044\042\260\173\273\047\124"
	"\150\045\031\361\006\332\203\351\330\333\152\067\255\136\020\061"
	"\373\207\347\172\117\106\145\236\030\145\131\062\006\371\330\025"
	"\325\032\326\254\113\104\373\314\325\210\320\032\246\117\053\003"
	"\266\174\104\322\252\217\021\314\277\176\143\357\256\330\235\123"
	"\251\110\072\202\374\226\204\347\022\210\241\107\046\322\221\215"
	"\345\077\167\360\374\164\147\312\115\142\121\221\232\270\255\205"
	"\006\073\307\250\170\250\122\050\122\143\116\317\005\111\070\266"
	"\215\125\220\214\221\332\306\107\043\065\017\112\133\325\311\165"
	"\317\307\035\366\262\112\037\261\130\214\071\110\257\345\023\172"
	"\216\247\314\050\271\350\175\176\373\234\357\306\225\003\370\006"
	"\130\021\043\057\132\037\333\157\276\370\351\177\022\323\362\141"
	"\146\106\235\076\336\001\036\172\134\244\303\234\212\070\314\331"
	"\163\072\233\364\330\031\061\143\306\260\272\356\005\006\024\242"
	"\355\041\152\161\305\160\015\045\363\055\171\124\204\107\127\355"
	"\034\201\003\271\371\234\001\334\055\264\051\007\322\022\136\166"
	"\234\255\175\110\172\372\203\001\151\174\106\207\323\235\344\104"
	"\277\333\027\157\056\033\230\273\370\145\174\137\203\163\022\230"
	"\307\137\106\022\177\074\307\335\340\023\147\125\166\150\144\130"
	"\267\034\233\340\047\301\073\070\153\057\033\112\022\261\314\234"
	"\323\251\376\077\012\234\145\257\347\071\146\070\310\101\007\151"
	"\210\204\077\327\032\210\210\276\163\214\255\044\372\175\300\015"
	"\001\230\273\277\312\256\005\313\220\210\337\062\347\350\206\233"
	"\315\142\231\034\016\256\221\040\053\275\344\340\376\003\210\375"
	"\235\045\102\134\176\233\162\372\171\131\002\237\112\142\005\367"
	"\115\322\064\003\275\257\243\232\035\374\137\155\027\204\073\210"
	"\350\330\261\007\302\064\104\075\330\063\212\121\330\121\272\175"
	"\263\240\224\366\233\336\276\037\254\160\315\353\216\211\306\360"
	"\143\327\336\374\035\072\220\035\362\350\330\022\222\277\014\262"
	"\201\237\253\035\046\007\272\323\304\033\376\330\322\142\246\350"
	"\026\136\260\334\333\354\341\055\132\175\134\151\125\251\132\132"
	"\027\157\326\064\251\113\313\172\047\133\260\065\010\366\233\170"
	"\123\026\231\201\164\374\231\142\236\230\347\250\022\363\243\327"
	"\313\337\255\074\221\335\327\223\044\244\224\377\322\325\004\111"
	"\173\001\112\005\341\321\070\334\141\007\054\110\244\355\150\263"
	"\074\266\351\334\053\302\023\067\213\254\231\031\353\203\231\020"
	"\227\155\014\121\031\063\233\133\342\234\202\005\027\303\121\314"
	"\317\361\277\200\226\326\175\372\311\363\214\373\125\161\171\342"
	"\277\273\340\376\072\030\270\024\073\235\000\303\034\250\137\046"
	"\072\120\230\371\015\135\251\212\360\071\241\077\303\364\057\217"
	"\315\262\206\064\132\213\014\057\106\262\076\253\154\262\163\350"
	"\351\156\255\373\372\307\377\027\332\051\133\061\257\221\017\254"
	"\373\210\254\135\263\175\237\341\033\342\202\023\170\033\047\047"
	"\017\076\247\031\221\177\227\337\242\045\352\315\103\022\140\105"
	"\074\136\056\235\106\042\041\151\154\315\057\212\233\124\040\302"
	"\136\207\237\167\356\123\252\336\070\023\045\244\140\323\336\006"
	"\344\370\267\272\276\155\335\021\362\160\121\124\237\161\211\306"
	"\334\137\071\253\275\210\123\013\332\043\327\166\045\142\255\011"
	"\220\162\355\237\062\326\255\167\116\265\273\312\201\131\107\336"
	"\272\117\117\264\341\101\266\106\057\310\156\376\045\051\264\252"
	"\055\132\225\016\230\220\054\235\352\003\065\242\272\112\355\377"
	"\254\307\130\062\223\023\343\063\210\223\317\000\224\345\036\070"
	"\303\130\164\211\061\334\053\054\232\263\222\353\032\003\065\014"
	"\320\343\311\003\307\135\066\230\264\136\340\014\014\246\164\121"
	"\011\302\126\044\021\310\145\134\253\055\042\360\372\042\077\157"
	"\170\045\145\155\272\050\150\142\027\020\053\050\334\165\013\166"
	"\344\116\053\265\040\055\164\233\100\335\040\336\165\013\023\217"
	"\232\134\205\113\211\365\120\052\063\372\270\310\336\240\315\015"
	"\101\101\132\074\371\074\300\173\231\301\265\166\144\375\122\341"
	"\207\364\347\131\000\056\341\222\330\055\175\217\361\317\062\322"
	"\026\332\211\376\262\305\236\375\045\134\333\325\161\141\366\346"
	"\007\106\330\073\023\340\170\134\074\364\307\345\345\017\044\363"
	"\304\375\275\264\327\210\277\067\156\215\301\207\347\351\104\134"
	"\172\244\031\240\231\151\155\050\255\364\303\122\055\240\077\151"
	"\046\220\021\046\356\260\136\306\016\206\223\273\321\351\132\311"
	"\005\234\342\270\017\333\223\327\167\314\122\214\266\316\022\175"
	"\270\123\246\363\003\005\272\022\213\115\316\134\067\050\046\075"
	"\305\010\365\324\343\211\253\133\125\375\350\014\314\373\211\205"
	"\116\060\171\122\065\064\144\300\202\063\035\271\134\103\367\041"
	"\113\354\365\057\166\241\213\313\237\163\330\154\156\141\362\275"
	"\221\154\017\306\240\164\207\042\247\244\334\003\350\323\045\064"
	"\300\033\143\066\275\357\002\134\143\333\311\322\074\274\217\316"
	"\050\236\225\311\023\035\353\272\301\310\276\251\234\343\335\135"
	"\377\101\224\274\061\226\031\224\161\342\146\256\236\366\175\307"
	"\225\022\220\250\057\174\142\361\104\041\233\341\005\171\076\004"
	"\272\322\300\354\151\331\200\333\274\347\212\133\336\007\042\163"
	"\032\262\033\112\056\176\073\163\240\327\124\245\120\223\251\013"
	"\146\151\367\317\103\167\253\377\137\065\132\075\075\174\260\127"
	"\057\314\242\136\113\336\321\353\265\046\220\005\272\071\020\040"
	"\243\007\360\346\177\233\346\336\321\101\034\016\275\315\145\355"
	"\231\007\113\345\345\035\320\233\104\141\240\376\233\261\036\076"
	"\271\017\045\070\252\014\027\173\115\064\211\013\001\357\370\233"
	"\367\104\201\335\141\121\170\245\263\031\243\116\312\302\215\204"
	"\321\263\275\174\277\325\367\015\011\201\030\013\161\020\246\150"
	"\124\047\106\266\171\276\133\055\330\377\173\243\302\011\047\223"
	"\274\344\020\174\271\010\211\303\211\241\316\372\262\165\143\007"
	"\235\251\275\027\150\031\104\100\031\300\343\333\311\012\157\206"
	"\357\177\002\250\207\214\154\021\055\072\013\340\260\157\350\115"
	"\030\246\145\200\277\251\301\331\151\244\264\063\257\043\271\236"
	"\243\273\107\052\107\263\074\165\356\107\126\236\266\076\354\317"
	"\345\121\120\245\373\021\176\144\265\062\227\145\126\121\003\371"
	"\014\113\044\124\377\140\312\355\250\040\214\137\137\170\056\104"
	"\312\177\351\305\220\147\052\106\232\302\253\360\023\257\352\037"
	"\372\017\164\371\160\076\346\030\137\163\170\276\353\247\003\266"
	"\046\355\173\266\125\245\374\357\147\247\340\172\126\313\232\121"
	"\332\017\112\112\116\061\142\255\244\333\154\220\202\157\106\250"
	"\135\301\136\262\147\132\241\317\002\202\112\131\115\344\252\047"
	"\364\364\162\102\046\324\357\312\260\134\132\062\313\240\332\050"
	"\142\070\333\311\223\174\230\226\377\342\357\114\307\232\164\274"
	"\217\346\376\265\273\356\200\153\112\332\235\026\173\167\077\336"
	"\260\032\250\104\227\101\332\226\044\312\343\354\145\127\250\364"
	"\075\247\252\370\225\052\144\340\005\001\367\201\171\066\137\052"
	"\121\010\156\350\111\111\176\155\024\141\131\171\271\001\156\366"
	"\251\030\357\077\103\123\037\111\125\026\312\316\115\052\370\236"
	"\062\147\206\173\261\005\350\305\147\102\077\040\104\255\026\355"
	"\306\006\054\012\131\113\123\257\142\035\175\260\110\166\116\172"
	"\336\325\366\217\333\336\124\102\041\223\143\145\101\172\122\010"
	"\200\176\022\332\312\145\211\055\203\007\335\313\175\054\106\133"
	"\002\074\352\335\033\077\040\074\323\203\242\024\375\364\034\175"
	"\163\057\130\075\225\341\153\030\350\110\344\146\165\053\302\167"
	"\147\255\125\203\354\165\300\300\371\142\324\366\127\361\164\312"
	"\041\315\010\266\256\163\317\227\273\264\376\061\337\300\250\107"
	"\155\375\312\132\163\213\032\155\355\357\143\104\341\330\017\002"
	"\245\027\271\124\212\210\354\106\074\352\167\033\252\037\143\030"
	"\035\056\162\221\271\215\376\247\175\142\354\136\073\373\141\340"
	"\022\032\065\234\243\041\342\337\013\131\373\266\171\136\316\227"
	"\214\101\050\106\317\047\355\114\211\331\253\304\324\015\245\347"
	"\047\332\204\313\374\147\253\010\300\246\276\072\005\215\321\222"
	"\317\372\330\236\041\306\353\252\237\226\157\164\243\024\134\313"
	"\357\340\227\353\107\102\363\010\350\262\102\356\100\024\200\017"
	"\016\131\256\060\037\231\333\277\060\112\063\324\136\217\240\116"
	"\160\067\071\267\171\055\277\142\340\002\121\040\026\322\060\045"
	"\053\336\126\112\170\061\011\251\173\075\176\332\315\037\050\075"
	"\126\141\364\320\217\264\063\157\267\204\217\316\127\277\363\202"
	"\236\111\315\027\172\327\300\366\024\076\320\342\135\370\037\264"
	"\132\024\205\351\311\271\130\200\076\350\116\225\250\102\027\107"
	"\213\344\136\006\273\036\375\320\135\315\262\273\305\322\160\037"
	"\346\365\011\260\256\142\060\355\112\176\202\363\301\231\072\115"
	"\176\231\124\072\270\121\012\025\036\275\321\344\217\101\004\166"
	"\067\015\046\346\157\127\323\272\326\125\256\227\357\351\344\155"
	"\202\070\250\072\211\263\120\250\160\041\214\000\143\220\166\232"
	"\235\235\200\015\364\123\310\312\250\166\142\230\137\106\006\341"
	"\177\256\034\010\141\154\260\321\216\075\322\361\315\110\213\153"
	"\346\014\171\332\137"
#define      shll_z	10
#define      shll	((&data[7234]))
	"\267\226\165\154\041\156\056\254\171\073\074"
#define      pswd_z	256
#define      pswd	((&data[7284]))
	"\116\247\370\315\125\024\326\266\201\207\210\017\304\133\000\222"
	"\243\214\376\212\230\170\144\370\271\012\001\161\022\242\210\140"
	"\112\200\056\237\225\005\126\027\101\242\024\234\122\170\001\000"
	"\113\256\107\301\355\141\301\360\071\006\272\357\246\064\330\017"
	"\312\115\005\351\303\116\353\004\360\377\241\102\167\243\103\303"
	"\122\212\205\077\354\106\060\045\114\352\025\363\037\355\003\352"
	"\073\010\323\376\127\276\003\107\276\245\211\066\111\314\372\233"
	"\127\177\333\103\305\013\151\022\366\176\006\026\154\012\000\250"
	"\023\323\246\152\222\252\261\120\120\072\207\231\007\201\065\137"
	"\000\021\242\306\035\014\331\024\213\340\052\367\352\052\237\375"
	"\376\106\147\220\361\030\341\101\123\150\332\133\351\017\272\352"
	"\041\135\261\076\152\212\122\365\152\174\355\125\247\215\122\245"
	"\323\272\066\305\323\027\006\047\177\340\202\151\360\075\123\022"
	"\233\004\120\006\217\242\373\372\037\350\117\306\165\241\154\111"
	"\134\242\016\057\272\025\126\071\366\331\243\347\027\367\371\262"
	"\373\111\270\213\354\264\205\013\235\324\322\023\166\076\134\323"
	"\341\153\002\233\200\131\325\166\062\170\135\111\157\126\374\153"
	"\240\265\366\214\152\174\230\007\120\152\032\307\251\167\232\212"
	"\343\235\046\144\366\373\332\050\214\337\046\121\072"
#define      date_z	1
#define      date	((&data[7545]))
	"\067"
#define      rlax_z	1
#define      rlax	((&data[7546]))
	"\000"
#define      xecc_z	15
#define      xecc	((&data[7548]))
	"\105\044\033\061\223\076\043\245\134\303\172\021\252\012\302\161"
	"\024\327\107"
#define      tst1_z	22
#define      tst1	((&data[7571]))
	"\016\113\064\217\172\034\156\122\060\210\246\162\143\164\365\312"
	"\153\323\023\364\054\331\330\244\025\340\026\323\045\177\052\074"
#define      msg1_z	65
#define      msg1	((&data[7598]))
	"\161\171\140\042\215\377\256\067\107\100\173\034\302\050\016\341"
	"\121\073\374\237\364\140\053\307\104\017\146\063\314\162\212\376"
	"\132\022\231\004\351\342\126\126\365\300\277\272\011\130\210\335"
	"\317\205\270\007\302\133\073\106\252\355\377\031\210\335\302\267"
	"\135\135\104\212\102\042\076"
#define      chk1_z	22
#define      chk1	((&data[7672]))
	"\200\130\321\120\062\224\273\343\040\172\264\104\111\251\275\273"
	"\130\224\042\341\225\025\074\077\227\225\057\031"
#define      msg2_z	19
#define      msg2	((&data[7697]))
	"\033\225\056\023\217\026\261\066\167\302\310\115\362\066\213\270"
	"\060\156\075"
#define      chk2_z	19
#define      chk2	((&data[7717]))
	"\271\044\226\136\111\201\046\343\156\207\224\007\136\135\061\111"
	"\343\162\135\271\337"/* End of data[] */;
#define      hide_z	4096
#define SETUID 0	/* Define as 1 to call setuid(0) at start of script */
#define DEBUGEXEC	0	/* Define as 1 to debug execvp calls */
#define TRACEABLE	0	/* Define as 1 to enable ptrace the executable */
#define HARDENING	0	/* Define as 1 to disable ptrace/dump the executable */
#define BUSYBOXON	0	/* Define as 1 to enable work with busybox */

#if HARDENING
static const char * shc_x[] = {
"/*",
" * Copyright 2019 - Intika <intika@librefox.org>",
" * Replace ******** with secret read from fd 21",
" * Also change arguments location of sub commands (sh script commands)",
" * gcc -Wall -fpic -shared -o shc_secret.so shc_secret.c -ldl",
" */",
"",
"#define _GNU_SOURCE /* needed to get RTLD_NEXT defined in dlfcn.h */",
"#define PLACEHOLDER \"********\"",
"#include <dlfcn.h>",
"#include <stdlib.h>",
"#include <string.h>",
"#include <unistd.h>",
"#include <stdio.h>",
"#include <signal.h>",
"",
"static char secret[128000]; //max size",
"typedef int (*pfi)(int, char **, char **);",
"static pfi real_main;",
"",
"// copy argv to new location",
"char **copyargs(int argc, char** argv){",
"    char **newargv = malloc((argc+1)*sizeof(*argv));",
"    char *from,*to;",
"    int i,len;",
"",
"    for(i = 0; i<argc; i++){",
"        from = argv[i];",
"        len = strlen(from)+1;",
"        to = malloc(len);",
"        memcpy(to,from,len);",
"        // zap old argv space",
"        memset(from,'\\0',len);",
"        newargv[i] = to;",
"        argv[i] = 0;",
"    }",
"    newargv[argc] = 0;",
"    return newargv;",
"}",
"",
"static int mymain(int argc, char** argv, char** env) {",
"    //fprintf(stderr, \"Inject main argc = %d\\n\", argc);",
"    return real_main(argc, copyargs(argc,argv), env);",
"}",
"",
"int __libc_start_main(int (*main) (int, char**, char**),",
"                      int argc,",
"                      char **argv,",
"                      void (*init) (void),",
"                      void (*fini)(void),",
"                      void (*rtld_fini)(void),",
"                      void (*stack_end)){",
"    static int (*real___libc_start_main)() = NULL;",
"    int n;",
"",
"    if (!real___libc_start_main) {",
"        real___libc_start_main = dlsym(RTLD_NEXT, \"__libc_start_main\");",
"        if (!real___libc_start_main) abort();",
"    }",
"",
"    n = read(21, secret, sizeof(secret));",
"    if (n > 0) {",
"      int i;",
"",
"    if (secret[n - 1] == '\\n') secret[--n] = '\\0';",
"    for (i = 1; i < argc; i++)",
"        if (strcmp(argv[i], PLACEHOLDER) == 0)",
"          argv[i] = secret;",
"    }",
"",
"    real_main = main;",
"",
"    return real___libc_start_main(mymain, argc, argv, init, fini, rtld_fini, stack_end);",
"}",
"",
0};
#endif /* HARDENING */

/* rtc.c */

#include <sys/stat.h>
#include <sys/types.h>

#include <errno.h>
#include <stdio.h>
#include <stdlib.h>
#include <string.h>
#include <time.h>
#include <unistd.h>

/* 'Alleged RC4' */

static unsigned char stte[256], indx, jndx, kndx;

/*
 * Reset arc4 stte. 
 */
void stte_0(void)
{
	indx = jndx = kndx = 0;
	do {
		stte[indx] = indx;
	} while (++indx);
}

/*
 * Set key. Can be used more than once. 
 */
void key(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		do {
			tmp = stte[indx];
			kndx += tmp;
			kndx += ptr[(int)indx % len];
			stte[indx] = stte[kndx];
			stte[kndx] = tmp;
		} while (++indx);
		ptr += 256;
		len -= 256;
	}
}

/*
 * Crypt data. 
 */
void arc4(void * str, int len)
{
	unsigned char tmp, * ptr = (unsigned char *)str;
	while (len > 0) {
		indx++;
		tmp = stte[indx];
		jndx += tmp;
		stte[indx] = stte[jndx];
		stte[jndx] = tmp;
		tmp += stte[indx];
		*ptr ^= stte[tmp];
		ptr++;
		len--;
	}
}

/* End of ARC4 */

#if HARDENING

#include <sys/ptrace.h>
#include <sys/wait.h>
#include <signal.h>
#include <sys/prctl.h>
#define PR_SET_PTRACER 0x59616d61

/* Seccomp Sandboxing Init */
#include <stdlib.h>
#include <stdio.h>
#include <stddef.h>
#include <string.h>
#include <unistd.h>
#include <errno.h>

#include <sys/types.h>
#include <sys/prctl.h>
#include <sys/syscall.h>
#include <sys/socket.h>

#include <linux/filter.h>
#include <linux/seccomp.h>
#include <linux/audit.h>

#define ArchField offsetof(struct seccomp_data, arch)

#define Allow(syscall) \
    BPF_JUMP(BPF_JMP+BPF_JEQ+BPF_K, SYS_##syscall, 0, 1), \
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_ALLOW)

struct sock_filter filter[] = {
    /* validate arch */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, ArchField),
    BPF_JUMP( BPF_JMP+BPF_JEQ+BPF_K, AUDIT_ARCH_X86_64, 1, 0),
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),

    /* load syscall */
    BPF_STMT(BPF_LD+BPF_W+BPF_ABS, offsetof(struct seccomp_data, nr)),

    /* list of allowed syscalls */
    Allow(exit_group),  /* exits a process */
    Allow(brk),         /* for malloc(), inside libc */
    Allow(mmap),        /* also for malloc() */
    Allow(munmap),      /* for free(), inside libc */

    /* and if we don't match above, die */
    BPF_STMT(BPF_RET+BPF_K, SECCOMP_RET_KILL),
};
struct sock_fprog filterprog = {
    .len = sizeof(filter)/sizeof(filter[0]),
    .filter = filter
};

/* Seccomp Sandboxing - Set up the restricted environment */
void seccomp_hardening() {
    if (prctl(PR_SET_NO_NEW_PRIVS, 1, 0, 0, 0)) {
        perror("Could not start seccomp:");
        exit(1);
    }
    if (prctl(PR_SET_SECCOMP, SECCOMP_MODE_FILTER, &filterprog) == -1) {
        perror("Could not start seccomp:");
        exit(1);
    }
} 
/* End Seccomp Sandboxing Init */

void shc_x_file() {
    FILE *fp;
    int line = 0;

    if ((fp = fopen("/tmp/shc_x.c", "w")) == NULL ) {exit(1); exit(1);}
    for (line = 0; shc_x[line]; line++)	fprintf(fp, "%s\n", shc_x[line]);
    fflush(fp);fclose(fp);
}

int make() {
	char * cc, * cflags, * ldflags;
    char cmd[4096];

	cc = getenv("CC");
	if (!cc) cc = "cc";

	sprintf(cmd, "%s %s -o %s %s", cc, "-Wall -fpic -shared", "/tmp/shc_x.so", "/tmp/shc_x.c -ldl");
	if (system(cmd)) {remove("/tmp/shc_x.c"); return -1;}
	remove("/tmp/shc_x.c"); return 0;
}

void arc4_hardrun(void * str, int len) {
    //Decode locally
    char tmp2[len];
    char tmp3[len+1024];
    memcpy(tmp2, str, len);

	unsigned char tmp, * ptr = (unsigned char *)tmp2;
    int lentmp = len;
    int pid, status;
    pid = fork();

    shc_x_file();
    if (make()) {exit(1);}

    setenv("LD_PRELOAD","/tmp/shc_x.so",1);

    if(pid==0) {

        //Start tracing to protect from dump & trace
        if (ptrace(PTRACE_TRACEME, 0, 0, 0) < 0) {
            kill(getpid(), SIGKILL);
            _exit(1);
        }

        //Decode Bash
        while (len > 0) {
            indx++;
            tmp = stte[indx];
            jndx += tmp;
            stte[indx] = stte[jndx];
            stte[jndx] = tmp;
            tmp += stte[indx];
            *ptr ^= stte[tmp];
            ptr++;
            len--;
        }

        //Do the magic
        sprintf(tmp3, "%s %s", "'********' 21<<<", tmp2);

        //Exec bash script //fork execl with 'sh -c'
        system(tmp2);

        //Empty script variable
        memcpy(tmp2, str, lentmp);

        //Clean temp
        remove("/tmp/shc_x.so");

        //Sinal to detach ptrace
        ptrace(PTRACE_DETACH, 0, 0, 0);
        exit(0);
    }
    else {wait(&status);}

    /* Seccomp Sandboxing - Start */
    seccomp_hardening();

    exit(0);
}
#endif /* HARDENING */

/*
 * Key with file invariants. 
 */
int key_with_file(char * file)
{
	struct stat statf[1];
	struct stat control[1];

	if (stat(file, statf) < 0)
		return -1;

	/* Turn on stable fields */
	memset(control, 0, sizeof(control));
	control->st_ino = statf->st_ino;
	control->st_dev = statf->st_dev;
	control->st_rdev = statf->st_rdev;
	control->st_uid = statf->st_uid;
	control->st_gid = statf->st_gid;
	control->st_size = statf->st_size;
	control->st_mtime = statf->st_mtime;
	control->st_ctime = statf->st_ctime;
	key(control, sizeof(control));
	return 0;
}

#if DEBUGEXEC
void debugexec(char * sh11, int argc, char ** argv)
{
	int i;
	fprintf(stderr, "shll=%s\n", sh11 ? sh11 : "<null>");
	fprintf(stderr, "argc=%d\n", argc);
	if (!argv) {
		fprintf(stderr, "argv=<null>\n");
	} else { 
		for (i = 0; i <= argc ; i++)
			fprintf(stderr, "argv[%d]=%.60s\n", i, argv[i] ? argv[i] : "<null>");
	}
}
#endif /* DEBUGEXEC */

void rmarg(char ** argv, char * arg)
{
	for (; argv && *argv && *argv != arg; argv++);
	for (; argv && *argv; argv++)
		*argv = argv[1];
}

void chkenv_end(void);

int chkenv(int argc)
{
	char buff[512];
	unsigned long mask, m;
	int l, a, c;
	char * string;
	extern char ** environ;

	mask = (unsigned long)getpid();
	stte_0();
	 key(&chkenv, (void*)&chkenv_end - (void*)&chkenv);
	 key(&data, sizeof(data));
	 key(&mask, sizeof(mask));
	arc4(&mask, sizeof(mask));
	sprintf(buff, "x%lx", mask);
	string = getenv(buff);
#if DEBUGEXEC
	fprintf(stderr, "getenv(%s)=%s\n", buff, string ? string : "<null>");
#endif
	l = strlen(buff);
	if (!string) {
		/* 1st */
		sprintf(&buff[l], "=%lu %d", mask, argc);
		putenv(strdup(buff));
		return 0;
	}
	c = sscanf(string, "%lu %d%c", &m, &a, buff);
	if (c == 2 && m == mask) {
		/* 3rd */
		rmarg(environ, &string[-l - 1]);
		return 1 + (argc - a);
	}
	return -1;
}

void chkenv_end(void){}

#if HARDENING

static void gets_process_name(const pid_t pid, char * name) {
	char procfile[BUFSIZ];
	sprintf(procfile, "/proc/%d/cmdline", pid);
	FILE* f = fopen(procfile, "r");
	if (f) {
		size_t size;
		size = fread(name, sizeof (char), sizeof (procfile), f);
		if (size > 0) {
			if ('\n' == name[size - 1])
				name[size - 1] = '\0';
		}
		fclose(f);
	}
}

void hardening() {
    prctl(PR_SET_DUMPABLE, 0);
    prctl(PR_SET_PTRACER, -1);

    int pid = getppid();
    char name[256] = {0};
    gets_process_name(pid, name);

    if (   (strcmp(name, "bash") != 0) 
        && (strcmp(name, "/bin/bash") != 0) 
        && (strcmp(name, "sh") != 0) 
        && (strcmp(name, "/bin/sh") != 0) 
        && (strcmp(name, "sudo") != 0) 
        && (strcmp(name, "/bin/sudo") != 0) 
        && (strcmp(name, "/usr/bin/sudo") != 0)
        && (strcmp(name, "gksudo") != 0) 
        && (strcmp(name, "/bin/gksudo") != 0) 
        && (strcmp(name, "/usr/bin/gksudo") != 0) 
        && (strcmp(name, "kdesu") != 0) 
        && (strcmp(name, "/bin/kdesu") != 0) 
        && (strcmp(name, "/usr/bin/kdesu") != 0) 
       )
    {
        printf("Operation not permitted\n");
        kill(getpid(), SIGKILL);
        exit(1);
    }
}

#endif /* HARDENING */

#if !TRACEABLE

#define _LINUX_SOURCE_COMPAT
#include <sys/ptrace.h>
#include <sys/types.h>
#include <sys/wait.h>
#include <fcntl.h>
#include <signal.h>
#include <stdio.h>
#include <unistd.h>

#if !defined(PT_ATTACHEXC) /* New replacement for PT_ATTACH */
   #if !defined(PTRACE_ATTACH) && defined(PT_ATTACH)
       #define PT_ATTACHEXC	PT_ATTACH
   #elif defined(PTRACE_ATTACH)
       #define PT_ATTACHEXC PTRACE_ATTACH
   #endif
#endif

void untraceable(char * argv0)
{
	char proc[80];
	int pid, mine;

	switch(pid = fork()) {
	case  0:
		pid = getppid();
		/* For problematic SunOS ptrace */
#if defined(__FreeBSD__)
		sprintf(proc, "/proc/%d/mem", (int)pid);
#else
		sprintf(proc, "/proc/%d/as",  (int)pid);
#endif
		close(0);
		mine = !open(proc, O_RDWR|O_EXCL);
		if (!mine && errno != EBUSY)
			mine = !ptrace(PT_ATTACHEXC, pid, 0, 0);
		if (mine) {
			kill(pid, SIGCONT);
		} else {
			perror(argv0);
			kill(pid, SIGKILL);
		}
		_exit(mine);
	case -1:
		break;
	default:
		if (pid == waitpid(pid, 0, 0))
			return;
	}
	perror(argv0);
	_exit(1);
}
#endif /* !TRACEABLE */

char * xsh(int argc, char ** argv)
{
	char * scrpt;
	int ret, i, j;
	char ** varg;
	char * me = argv[0];
	if (me == NULL) { me = getenv("_"); }
	if (me == 0) { fprintf(stderr, "E: neither argv[0] nor $_ works."); exit(1); }

	ret = chkenv(argc);
	stte_0();
	 key(pswd, pswd_z);
	arc4(msg1, msg1_z);
	arc4(date, date_z);
	if (date[0] && (atoll(date)<time(NULL)))
		return msg1;
	arc4(shll, shll_z);
	arc4(inlo, inlo_z);
	arc4(xecc, xecc_z);
	arc4(lsto, lsto_z);
	arc4(tst1, tst1_z);
	 key(tst1, tst1_z);
	arc4(chk1, chk1_z);
	if ((chk1_z != tst1_z) || memcmp(tst1, chk1, tst1_z))
		return tst1;
	arc4(msg2, msg2_z);
	if (ret < 0)
		return msg2;
	varg = (char **)calloc(argc + 10, sizeof(char *));
	if (!varg)
		return 0;
	if (ret) {
		arc4(rlax, rlax_z);
		if (!rlax[0] && key_with_file(shll))
			return shll;
		arc4(opts, opts_z);
#if HARDENING
	    arc4_hardrun(text, text_z);
	    exit(0);
       /* Seccomp Sandboxing - Start */
       seccomp_hardening();
#endif
		arc4(text, text_z);
		arc4(tst2, tst2_z);
		 key(tst2, tst2_z);
		arc4(chk2, chk2_z);
		if ((chk2_z != tst2_z) || memcmp(tst2, chk2, tst2_z))
			return tst2;
		/* Prepend hide_z spaces to script text to hide it. */
		scrpt = malloc(hide_z + text_z);
		if (!scrpt)
			return 0;
		memset(scrpt, (int) ' ', hide_z);
		memcpy(&scrpt[hide_z], text, text_z);
	} else {			/* Reexecute */
		if (*xecc) {
			scrpt = malloc(512);
			if (!scrpt)
				return 0;
			sprintf(scrpt, xecc, me);
		} else {
			scrpt = me;
		}
	}
	j = 0;
#if BUSYBOXON
	varg[j++] = "busybox";
	varg[j++] = "sh";
#else
	varg[j++] = argv[0];		/* My own name at execution */
#endif
	if (ret && *opts)
		varg[j++] = opts;	/* Options on 1st line of code */
	if (*inlo)
		varg[j++] = inlo;	/* Option introducing inline code */
	varg[j++] = scrpt;		/* The script itself */
	if (*lsto)
		varg[j++] = lsto;	/* Option meaning last option */
	i = (ret > 1) ? ret : 0;	/* Args numbering correction */
	while (i < argc)
		varg[j++] = argv[i++];	/* Main run-time arguments */
	varg[j] = 0;			/* NULL terminated array */
#if DEBUGEXEC
	debugexec(shll, j, varg);
#endif
	execvp(shll, varg);
	return shll;
}

int main(int argc, char ** argv)
{
#if SETUID
   setuid(0);
#endif
#if DEBUGEXEC
	debugexec("main", argc, argv);
#endif
#if HARDENING
	hardening();
#endif
#if !TRACEABLE
	untraceable(argv[0]);
#endif
	argv[1] = xsh(argc, argv);
	fprintf(stderr, "%s%s%s: %s\n", argv[0],
		errno ? ": " : "",
		errno ? strerror(errno) : "",
		argv[1] ? argv[1] : "<null>"
	);
	return 1;
}
